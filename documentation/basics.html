<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The basics | biome.text</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="shortcut icon" href="/biome-text/favicon.ico">
    <meta name="description" content="biome.text practical NLP open source library.">
    <meta property="og:image" content="https://www.recogn.ai/images/biome_og.png">
    <link rel="preload" href="/biome-text/assets/css/0.styles.b086c8eb.css" as="style"><link rel="preload" href="/biome-text/assets/js/app.84a524b7.js" as="script"><link rel="preload" href="/biome-text/assets/js/4.ef88e1af.js" as="script"><link rel="preload" href="/biome-text/assets/js/3.dadd8730.js" as="script"><link rel="preload" href="/biome-text/assets/js/60.bb439ad1.js" as="script"><link rel="prefetch" href="/biome-text/assets/js/10.3c0beacd.js"><link rel="prefetch" href="/biome-text/assets/js/11.aec61f9c.js"><link rel="prefetch" href="/biome-text/assets/js/12.d46745fb.js"><link rel="prefetch" href="/biome-text/assets/js/13.3b31d8e5.js"><link rel="prefetch" href="/biome-text/assets/js/14.76a56327.js"><link rel="prefetch" href="/biome-text/assets/js/15.c171650a.js"><link rel="prefetch" href="/biome-text/assets/js/16.a1793804.js"><link rel="prefetch" href="/biome-text/assets/js/17.ead50b81.js"><link rel="prefetch" href="/biome-text/assets/js/18.a3ee9b09.js"><link rel="prefetch" href="/biome-text/assets/js/19.4ccf9402.js"><link rel="prefetch" href="/biome-text/assets/js/20.474cc32d.js"><link rel="prefetch" href="/biome-text/assets/js/21.1909a767.js"><link rel="prefetch" href="/biome-text/assets/js/22.744439c0.js"><link rel="prefetch" href="/biome-text/assets/js/23.53724930.js"><link rel="prefetch" href="/biome-text/assets/js/24.c727a7cd.js"><link rel="prefetch" href="/biome-text/assets/js/25.7ccf97e8.js"><link rel="prefetch" href="/biome-text/assets/js/26.e6a22e58.js"><link rel="prefetch" href="/biome-text/assets/js/27.190e18f4.js"><link rel="prefetch" href="/biome-text/assets/js/28.3ef75703.js"><link rel="prefetch" href="/biome-text/assets/js/29.5cb18cdf.js"><link rel="prefetch" href="/biome-text/assets/js/30.309a0e99.js"><link rel="prefetch" href="/biome-text/assets/js/31.87958b1e.js"><link rel="prefetch" href="/biome-text/assets/js/32.2b7a24ff.js"><link rel="prefetch" href="/biome-text/assets/js/33.6ccaec85.js"><link rel="prefetch" href="/biome-text/assets/js/34.1c67f578.js"><link rel="prefetch" href="/biome-text/assets/js/35.cb8e5b66.js"><link rel="prefetch" href="/biome-text/assets/js/36.c25e2327.js"><link rel="prefetch" href="/biome-text/assets/js/37.f272f99e.js"><link rel="prefetch" href="/biome-text/assets/js/38.3f02ebbe.js"><link rel="prefetch" href="/biome-text/assets/js/39.e779a3c4.js"><link rel="prefetch" href="/biome-text/assets/js/40.360b61fe.js"><link rel="prefetch" href="/biome-text/assets/js/41.5161a565.js"><link rel="prefetch" href="/biome-text/assets/js/42.654e44bb.js"><link rel="prefetch" href="/biome-text/assets/js/43.7ac73930.js"><link rel="prefetch" href="/biome-text/assets/js/44.b2af4b0c.js"><link rel="prefetch" href="/biome-text/assets/js/45.83977507.js"><link rel="prefetch" href="/biome-text/assets/js/46.2c829944.js"><link rel="prefetch" href="/biome-text/assets/js/47.1c2dd836.js"><link rel="prefetch" href="/biome-text/assets/js/48.2276c4c5.js"><link rel="prefetch" href="/biome-text/assets/js/49.25197b24.js"><link rel="prefetch" href="/biome-text/assets/js/5.9ac6100a.js"><link rel="prefetch" href="/biome-text/assets/js/50.dec52bd3.js"><link rel="prefetch" href="/biome-text/assets/js/51.7bbe7a27.js"><link rel="prefetch" href="/biome-text/assets/js/52.1610667d.js"><link rel="prefetch" href="/biome-text/assets/js/53.8ba82d12.js"><link rel="prefetch" href="/biome-text/assets/js/54.cee13cef.js"><link rel="prefetch" href="/biome-text/assets/js/55.c14e5091.js"><link rel="prefetch" href="/biome-text/assets/js/56.b7342a68.js"><link rel="prefetch" href="/biome-text/assets/js/57.c7f55d7a.js"><link rel="prefetch" href="/biome-text/assets/js/58.ea56e4d1.js"><link rel="prefetch" href="/biome-text/assets/js/59.6082c468.js"><link rel="prefetch" href="/biome-text/assets/js/6.3c7b9d82.js"><link rel="prefetch" href="/biome-text/assets/js/61.56df3d8c.js"><link rel="prefetch" href="/biome-text/assets/js/62.11b7fc2c.js"><link rel="prefetch" href="/biome-text/assets/js/63.93e7dbc3.js"><link rel="prefetch" href="/biome-text/assets/js/64.46fe1f84.js"><link rel="prefetch" href="/biome-text/assets/js/65.8f58c124.js"><link rel="prefetch" href="/biome-text/assets/js/66.37e7a157.js"><link rel="prefetch" href="/biome-text/assets/js/7.7f363027.js"><link rel="prefetch" href="/biome-text/assets/js/8.0f98ec1c.js"><link rel="prefetch" href="/biome-text/assets/js/9.c600d5f3.js"><link rel="prefetch" href="/biome-text/assets/js/vendors~docsearch.8f04fa7f.js">
    <link rel="stylesheet" href="/biome-text/assets/css/0.styles.b086c8eb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-44f1b6a5><header class="navbar" data-v-44f1b6a5><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/biome-text/" class="home-link router-link-active"><!----> <span class="site-name">biome<span>.text</span></span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/biome-text/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/biome-text/documentation/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="https://github.com/recognai/biome-text" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div><div class="nav-item"><a href="https://recogn.ai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Recognai
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-44f1b6a5></div> <aside class="sidebar" data-v-44f1b6a5><div class="sidebar__link"><a href="/biome-text/"><img src="/biome-text/assets/img/biome.svg" class="sidebar__img"></a></div> <nav class="nav-links"><div class="nav-item"><a href="/biome-text/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/biome-text/documentation/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="https://github.com/recognai/biome-text" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div><div class="nav-item"><a href="https://recogn.ai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Recognai
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Get started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/documentation/" aria-current="page" class="sidebar-link">Installation</a></li><li><a href="/biome-text/documentation/basics.html" aria-current="page" class="active sidebar-link">The basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/biome-text/documentation/basics.html#pipeline" class="sidebar-link">Pipeline</a></li><li class="sidebar-sub-header"><a href="/biome-text/documentation/basics.html#datasource" class="sidebar-link">Datasource</a></li><li class="sidebar-sub-header"><a href="/biome-text/documentation/basics.html#vocabulary" class="sidebar-link">Vocabulary</a></li><li class="sidebar-sub-header"><a href="/biome-text/documentation/basics.html#train" class="sidebar-link">Train</a></li><li class="sidebar-sub-header"><a href="/biome-text/documentation/basics.html#using-pre-trained-pipelines" class="sidebar-link">Using pre-trained pipelines</a></li><li class="sidebar-sub-header"><a href="/biome-text/documentation/basics.html#next-steps" class="sidebar-link">Next steps</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/documentation/tutorials/1-Training_a_text_classifier.html" class="sidebar-link">Training a short text classifier of German business names</a></li><li><a href="/biome-text/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html" class="sidebar-link">Training a sequence tagger for Slot Filling</a></li><li><a href="/biome-text/documentation/tutorials/3-Hyperparameter_optimization_with_Ray_Tune.html" class="sidebar-link">Hyperparameter optimization with Ray Tune</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>User Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/documentation/user-guides/1-nlp-tasks.html" class="sidebar-link">NLP Tasks</a></li><li><a href="/biome-text/documentation/user-guides/2-configuration.html" class="sidebar-link">Configuration</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Community</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/documentation/community/contributing.html" class="sidebar-link">Contributing</a></li><li><a href="/biome-text/documentation/community/get_help.html" class="sidebar-link">Getting help</a></li></ul></section></li></ul> </aside> <main class="page" data-v-44f1b6a5> <div class="theme-default-content content__default"><h1 id="the-basics"><a href="#the-basics" class="header-anchor">#</a> The basics</h1> <p>The library is built around a few simple concepts. This section explains everything you need to know to get started (feel free to jump into the sections you are more interested in):</p> <p></p><div class="table-of-contents"><ul><li><a href="#pipeline">Pipeline</a><ul><li><a href="#tokenizer">Tokenizer</a></li><li><a href="#features">Features</a></li><li><a href="#encoder">Encoder</a></li><li><a href="#head">Head</a></li></ul></li><li><a href="#datasource">Datasource</a></li><li><a href="#vocabulary">Vocabulary</a></li><li><a href="#train">Train</a></li><li><a href="#using-pre-trained-pipelines">Using pre-trained pipelines</a><ul><li><a href="#predict">Predict</a></li><li><a href="#explain">Explain</a></li><li><a href="#serve">Serve</a></li><li><a href="#explore">Explore</a></li><li><a href="#training-and-transfer-learning">Training and transfer learning</a></li></ul></li><li><a href="#next-steps">Next steps</a></li></ul></div><p></p> <p>Before going into details, let's see a simple example:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text <span class="token keyword">import</span> Pipeline<span class="token punctuation">,</span> VocabularyConfiguration
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataSource

pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;my-first-classifier&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;head&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TextClassification&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;positive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;negative&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">)</span>
pipeline<span class="token punctuation">.</span>create_vocabulary<span class="token punctuation">(</span>VocabularyConfiguration<span class="token punctuation">(</span>sources<span class="token operator">=</span><span class="token punctuation">[</span>train_ds<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_store_training_run_output&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>train_ds
<span class="token punctuation">)</span>
</code></pre></div><p>The above example trains a text classifier from scratch by configuring a <code>Pipeline</code>, making a <code>Datasource</code> from a csv file, and creating a <code>Vocabulary</code> with this data. Let's dive into the details.</p> <h2 id="pipeline"><a href="#pipeline" class="header-anchor">#</a> Pipeline</h2> <p>Pipelines are the main entry point to the library. A <code>Pipeline</code> bundles components and actions needed to train, evaluate and use custom NLP models.</p> <p>Pipelines encompass tokenization, feature processing, model configuration and actions such as training, serving or inference.</p> <p>Let's continue with our example:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br></div><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text <span class="token keyword">import</span> Pipeline<span class="token punctuation">,</span> VocabularyConfiguration
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataSource

pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;my-first-classifier&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;head&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TextClassification&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;positive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;negative&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">)</span>
pipeline<span class="token punctuation">.</span>create_vocabulary<span class="token punctuation">(</span>VocabularyConfiguration<span class="token punctuation">(</span>sources<span class="token operator">=</span><span class="token punctuation">[</span>train_ds<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_store_training_run_output&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>train_ds
<span class="token punctuation">)</span>
</code></pre></div><p>Here we configure a <code>Pipeline</code> from scratch using a dictionary. A pipeline can be created in two ways:</p> <ol><li><p>Using the <code>Pipeline.from_config()</code> method, which accepts a dict or a <a href="/biome-text/api/biome/text/configuration.html#pipelineconfiguration">PipelineConfiguration</a></p></li> <li><p>Using YAML configuration files with the <code>Pipeline.from_yaml()</code>. The YAML config file in our example would be following:</p></li></ol> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>first<span class="token punctuation">-</span>classifier
<span class="token key atrule">head</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> TextClassification
    <span class="token key atrule">labels</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;positive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;negative&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>In this example, we only define the <code>name</code> and the task we want to train our model on, using the <code>head</code> parameter, the rest is configured from defaults. In biome.text we try to provide sensible defaults so you don't have to configure everything just to start experimenting, but there are many things you can tune and configure.</p> <p>In particular, a <code>Pipeline</code> has the following configurable components:</p> <h3 id="tokenizer"><a href="#tokenizer" class="header-anchor">#</a> Tokenizer</h3> <p>The tokenizer defines how we want to process the text of our input features. Tokenizers are based on <a href="https://spacy.io/api/tokenizer" target="_blank" rel="noopener noreferrer">spaCy tokenizers<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and have the following main configuration options:</p> <ol><li><code>lang</code>: the main language of the text to be tokenized (default is English). Here you can use available <a href="https://spacy.io/usage/models/" target="_blank" rel="noopener noreferrer">spaCy model codes<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li><code>segment_sentences</code>: enable sentence splitting for text within your input features, which is especially relevant for long text classification problems.</li> <li><code>text_cleaning</code>: simple python functions to pre-process text before tokenization. You can define your own but biome.texts provides pre-defined functions for things like cleaning up html tags or remove extra blank spaces.</li></ol> <h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <p>Features are a central concept of the library. Building on the flexibility of AllenNLP, biome.text gives you the ability of combining <a href="/biome-text/api/biome/text/features.html#wordfeatures">Word</a> and <a href="/biome-text/api/biome/text/features.html#charfeatures">Character</a> features easily. There are many things which can be configured here: the size of the embeddings, encoder type (e.g., CNNs or RNNs) for character encoding, pre-trained word vectors, and other things.</p> <p>To learn more about how to configure and use Features, see the <a href="/biome-text/api/biome/text/configuration.html#featuresconfiguration">FeaturesConfiguration API docs</a>.</p> <h3 id="encoder"><a href="#encoder" class="header-anchor">#</a> Encoder</h3> <p>To support transfer learning, models are structured into a model &quot;backbone&quot; for processing and encoding features and a &quot;task&quot; head for a certain NLP task.</p> <p>The <code>Encoder</code> is a central piece of the backbone. It's basically a sequence to sequence or seq2seq encoder, which &quot;contextualizes&quot; textual features in the context of a task (supervised or unsupervised). In this way, the encoder can be pre-trained and fine-tuned for different downstream tasks by just changing the head, as we will see later. You can check the encoders provided by <a href="https://github.com/allenai/allennlp/tree/master/allennlp/modules/seq2seq_encoders" target="_blank" rel="noopener noreferrer">AllenNLP<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or even write your own by implementing the <a href="https://github.com/allenai/allennlp/blob/master/allennlp/modules/seq2seq_encoders/seq2seq_encoder.py" target="_blank" rel="noopener noreferrer">Seq2SeqEncoder interface<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>For defining encoders, biome.text builds on top of the <code>Seq2SeqEncoder</code> abstraction from AllenNLP, which brings many configuration possibilities, that go from RNNs to the official PyTorch Transformer implementation.</p> <h3 id="head"><a href="#head" class="header-anchor">#</a> Head</h3> <p>Task heads are the other key component to support flexible transfer learning. A head defines the NLP task (e.g., text classification, token-level classification, language modelling) and specific features related to the task, for example the labels of a text classifier (<code>positive</code> and <code>negative</code> in our example).</p> <p>You can check available heads in the <a href="/biome-text/api/biome/text/modules/heads/">API documentation</a>.</p> <h2 id="datasource"><a href="#datasource" class="header-anchor">#</a> Datasource</h2> <p>Data sources provide an easy way to load data for training, evaluation and inference coming from different sources: <a href="/biome-text/api/biome/text/data/readers.html#biome-text-data-readers">csv, parquet, json, or Excel spreadsheets among others</a>.</p> <p>Data sources map data into a lazy <a href="https://docs.dask.org/en/latest/dataframe.html" target="_blank" rel="noopener noreferrer">Dask DataFrame<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, so you can easily inspect them and manipulate them using familiar Pandas DataFrame operations.</p> <p>Coming back to our example:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text <span class="token keyword">import</span> Pipeline<span class="token punctuation">,</span> VocabularyConfiguration
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataSource

pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;my-first-classifier&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;head&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TextClassification&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;positive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;negative&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">)</span>
pipeline<span class="token punctuation">.</span>create_vocabulary<span class="token punctuation">(</span>VocabularyConfiguration<span class="token punctuation">(</span>sources<span class="token operator">=</span><span class="token punctuation">[</span>train_ds<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_store_training_run_output&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>train_ds
<span class="token punctuation">)</span>
</code></pre></div><p>Here we instantiate a <code>DataSource</code> from a csv file that looks like this:</p> <table><thead><tr><th>text</th> <th style="text-align:center;">label</th></tr></thead> <tbody><tr><td>I thought this was a wonderful way to spend time on a too hot summer weekend, sitting in the air con...</td> <td style="text-align:center;">positive</td></tr> <tr><td>Phil the Alien is one of those quirky films where the humour is based around the oddness of ...</td> <td style="text-align:center;">negative</td></tr> <tr><td>...</td> <td style="text-align:center;">positive</td></tr></tbody></table> <p>Data sources can also be created from <a href="/biome-text/api/biome/text/data/datasource.html#from-yaml">YAML configuration files</a>, which might be handy for automating training and evaluation pipelines.</p> <p>Columns in data sources are intimately related to what the pipeline expects as input and output features. In our example, we are defining a text classification model which expects a <code>text</code> and a <code>label</code> column. In cases where users don't have the option to align the columns of the data with the features of the model, the <code>DataSource</code> class provides a <code>mapping</code> parameter. Imagine our data set looked like this:</p> <table><thead><tr><th>title</th> <th>review</th> <th style="text-align:center;">label</th></tr></thead> <tbody><tr><td>Cool summer movie!</td> <td>I thought this was a wonderful way to spend time on a too hot summer weekend, sitting in the air con...</td> <td style="text-align:center;">positive</td></tr> <tr><td>Horrible horror movie</td> <td>Phil the Alien is one of those quirky films where the humour is based around the oddness of ...</td> <td style="text-align:center;">negative</td></tr> <tr><td></td> <td>...</td> <td style="text-align:center;">positive</td></tr></tbody></table> <p>Using the <code>mapping</code> functionality we could not only work with this data set schema by setting a mapping:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br></div><pre class="language-python"><code>train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>
    source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">,</span>
    mapping<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'text'</span><span class="token punctuation">:</span> <span class="token string">'review'</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><p>but we could also combine both <em>title</em> and <em>review</em> to feed them as input features:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br></div><pre class="language-python"><code>train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>
    source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">,</span>
    mapping<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'text'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><p>biome.text was created with semi-structured data problems in mind, so it provides specialized models for learning from structured records such as the <a href="/biome-text/api/biome/text/modules/heads/classification/record_classification.html#recordclassification">RecordClassification</a> head, which lets you define mappings to arbitrary input fields and combine their vector representations in a hierarchical way (e.g., combining encoders at field and record level)</p> <p>You can find more info about data sources and mappings in the <a href="/biome-text/api/biome/text/datasource.html#datasource">API documents</a>.</p> <h2 id="vocabulary"><a href="#vocabulary" class="header-anchor">#</a> Vocabulary</h2> <p>For doing NLP with neural networks, your NLP pipeline needs to turn words, subwords and/or characters into numbers. A typical process consists of tokenizing the text, and mapping word (or sub-word) tokens and maybe characters into integers or indexes. This process is often referred to as &quot;indexing&quot;.</p> <p>In order to support this you need a <code>Vocabulary</code>, which holds a mapping from tokens and characters to numerical ids (if you are interested, this post provides a good <a href="https://blog.floydhub.com/tokenization-nlp/" target="_blank" rel="noopener noreferrer">overview<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>). This mapping can be learned and built during pre-training phases as is the case for word piece models and generally sub-word models like those provided by <a href="https://github.com/huggingface/tokenizers" target="_blank" rel="noopener noreferrer">Huggingface tokenizers<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>).</p> <p>A more classical approach is to build or extend an existing vocabulary from training and validation data sets. For certain use cases, in highly specialized domains, this is sometimes the best way to proceed.</p> <p>Coming back to our example:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text <span class="token keyword">import</span> Pipeline<span class="token punctuation">,</span> VocabularyConfiguration
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataSource

pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;my-first-classifier&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;head&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TextClassification&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;positive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;negative&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">)</span>
pipeline<span class="token punctuation">.</span>create_vocabulary<span class="token punctuation">(</span>VocabularyConfiguration<span class="token punctuation">(</span>sources<span class="token operator">=</span><span class="token punctuation">[</span>train_ds<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_store_training_run_output&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>train_ds
<span class="token punctuation">)</span>
</code></pre></div><p>Here we create our vocabulary from scratch using the training data source. AllenNLP provides neat abstractions for dealing with multi-feature vocabularies (e.g., chars, words, etc.) and biome.text builds on top of those abstractions to make it easy to create, reuse and extend vocabularies.</p> <p>To learn more about how to configure and use the <code>Vocabulary</code>, see the <a href="/biome-text/api/biome/text/configuration.html#vocabularyconfiguration">VocabularyConfiguration API docs</a></p> <h2 id="train"><a href="#train" class="header-anchor">#</a> Train</h2> <p>Once we have everything ready, we can use the Pipeline to train our model using the <a href="/biome-text/api/biome/text/pipeline.html#pipeline">Pipeline.train()</a> method. Going back to our example:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text <span class="token keyword">import</span> Pipeline<span class="token punctuation">,</span> VocabularyConfiguration
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataSource

pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;my-first-classifier&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;head&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;TextClassification&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;positive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;negative&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

train_ds <span class="token operator">=</span> DataSource<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'training_data.csv'</span><span class="token punctuation">)</span>
pipeline<span class="token punctuation">.</span>create_vocabulary<span class="token punctuation">(</span>VocabularyConfiguration<span class="token punctuation">(</span>sources<span class="token operator">=</span><span class="token punctuation">[</span>train_ds<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_store_training_run_output&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>train_ds
<span class="token punctuation">)</span>
</code></pre></div><p>Here the training output will be saved in a folder. It will contain the trained model weights and the metrics, as well as the vocabulary and a log folder for visualizing the training metrics with <a href="https://www.tensorflow.org/tensorboard/" target="_blank" rel="noopener noreferrer">tensorboard<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The most relevant file in this folder will be the <code>model.tar.gz</code> file, which bundles everything we need to explore, serve or fine-tune the trained model.</p> <p>In the example, we only provide a <code>training_ds</code> which is of course not recommended for most use cases, where you need at least a validation set and desirably a test set. We also do not set anything related to the training process, such as optimizer, learning rate, epochs and so on. The library provides basic defaults for this just to get started. When further experimenting, you will probably need to use a trainer, configured with a <a href="/biome-text/api/biome/text/configuration.html#trainerconfiguration">TrainerConfiguration</a> object.</p> <h2 id="using-pre-trained-pipelines"><a href="#using-pre-trained-pipelines" class="header-anchor">#</a> Using pre-trained pipelines</h2> <p>As mentioned above, <code>model.tar.gz</code> files resulting from a training run contain everything you need to start using your trained pipeline.</p> <p>Let's see how:</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span><span class="token string">'path_to_store_training_run_output/model.tar.gz'</span><span class="token punctuation">)</span>
</code></pre></div><p>After loading the pipeline, you can use it for predictions:</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'Good movie indeed!'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="predict"><a href="#predict" class="header-anchor">#</a> Predict</h3> <p>The arguments for the <a href="/biome-text/api/biome/text/pipeline.html#predict">Pipeline.predict()</a> method will be aligned to match our model input features (<code>text</code> in this case). Models such as the <code>RecordClassifier</code> can be used to define more fine-grained input features, such as, for example, an email classifier with two fields <code>subject</code> and <code>body</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>subject<span class="token operator">=</span><span class="token string">'Hi!'</span><span class="token punctuation">,</span> body<span class="token operator">=</span><span class="token string">'Hi, hope you are well..'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="explain"><a href="#explain" class="header-anchor">#</a> Explain</h3> <p>Another thing we can do with a trained pipeline is to use the <a href="/biome-text/api/biome/text/pipeline.html#explain">Pipeline.explain()</a> method to get the attribution of each token by means of <a href="https://arxiv.org/abs/1703.01365" target="_blank" rel="noopener noreferrer">integrated gradients<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for those heads that support it:</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline<span class="token punctuation">.</span>explain<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'Good movie indeed!'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="serve"><a href="#serve" class="header-anchor">#</a> Serve</h3> <p>Pipeline uses the awesome <a href="https://fastapi.tiangolo.com/" target="_blank" rel="noopener noreferrer">FastAPI<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library to give you a simple REST endpoint with the <a href="/biome-text/api/biome/text/pipeline.html#serve">Pipeline.serve()</a> method, which provides methods aligned with your input features (e.g., a method accepting <code>subject</code> and <code>body</code> parameters):</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline<span class="token punctuation">.</span>serve<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">9090</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="explore"><a href="#explore" class="header-anchor">#</a> Explore</h3> <p>In order to support users with fine-grained error analysis and empower them to improve their models with informed decisions, the <a href="/biome-text/api/biome/text/pipeline.html#explore">Pipeline.explore()</a> method launches an UI (inside your notebook if you are using Jupyter).</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>
    train_ds<span class="token punctuation">,</span>
    explain<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>
</code></pre></div><p>This search-based UI can help:</p> <ul><li>to quickly identify difficult examples in the training, validation, test or any other data set.</li> <li>to inform users about corner cases and which labels need more examples.</li> <li>to find the values for confidence thresholds to use the model in production.</li> <li>to help domain experts understand the strengths and limitations of the model.</li> <li>in summary, get a sense of how the model interacts with your data.</li></ul> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>For the UI to work you need a running <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/install-elasticsearch.html" target="_blank" rel="noopener noreferrer">Elasticsearch<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> instance. We recommend installing <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/docker.html#docker-cli-run-dev-mode" target="_blank" rel="noopener noreferrer">Elasticsearch with docker<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <h3 id="training-and-transfer-learning"><a href="#training-and-transfer-learning" class="header-anchor">#</a> Training and transfer learning</h3> <p>After loading a pipeline, you can continue the training for the same task with new data:</p> <div class="language-python extra-class"><pre class="language-python"><code>training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_store_further_training&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>new_training_ds
<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>For further training, you can use the <a href="/biome-text/api/biome/text/pipeline.html#pipeline">extend_vocab</a> parameter to extend the vocabulary with the new data sets.</p></div> <p>Another thing you can do is to use this pre-trained pipeline for related task, for example another classifier with different labels but a similar domain:</p> <div class="language-python extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>heads <span class="token keyword">import</span> TextClassification

pipeline<span class="token punctuation">.</span>set_head<span class="token punctuation">(</span>
    TextClassification<span class="token punctuation">,</span>
    labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;horror_movie&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;comedy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;drama&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;social&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>

training_results <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>train<span class="token punctuation">(</span>
    output<span class="token operator">=</span><span class="token string">&quot;path_to_fine_tuned&quot;</span><span class="token punctuation">,</span>
    training<span class="token operator">=</span>categories_training_ds
<span class="token punctuation">)</span>
</code></pre></div><p>Here we just use the <a href="/biome-text/api/biome/text/pipeline.html#set-head">Pipeline.set_head()</a> method to set a new task head which classifies film categories instead of review sentiment.</p> <p>The more common &quot;pre-training a language model + fine-tuning on downstream tasks&quot; is also supported by using a <a href="/biome-text/api/biome/text/modules/heads/language_modelling.html#languagemodelling">LanguageModelling</a> head for pre-training.</p> <h2 id="next-steps"><a href="#next-steps" class="header-anchor">#</a> Next steps</h2> <p>The best place to start is the tutorials section.</p> <p>You can also find detailed <a href="/biome-text/api/">API docs</a> and use the search bar on top to find out more about specific concepts and features.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="page-nav__button prev"><a href="/biome-text/documentation/" class="prev router-link-active"><span class="page-nav__button__icon"><vp-icon color="#4A4A4A" name="chev-left" size="18px"></vp-icon></span> <span class="page-nav__button__text">
          Installation
        </span></a></span> <span class="page-nav__button next"><a href="/biome-text/documentation/tutorials/1-Training_a_text_classifier.html"><span class="page-nav__button__text">
          Training a short text classifier of German business names
        </span> <span class="page-nav__button__icon"><vp-icon color="#4A4A4A" name="chev-right" size="18px"></vp-icon></span></a></span></p></div> <footer class="footer" data-v-44f1b6a5><div data-v-44f1b6a5>
          Maintained by
          <a href="https://www.recogn.ai/" target="_blank" data-v-44f1b6a5><img width="70px" src="/biome-text/assets/img/recognai.png" class="footer__img" data-v-44f1b6a5></a></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/biome-text/assets/js/app.84a524b7.js" defer></script><script src="/biome-text/assets/js/4.ef88e1af.js" defer></script><script src="/biome-text/assets/js/3.dadd8730.js" defer></script><script src="/biome-text/assets/js/60.bb439ad1.js" defer></script>
  </body>
</html>
