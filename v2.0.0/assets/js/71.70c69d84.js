(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{477:function(n,e,a){"use strict";a.r(e);var r=a(26),t=Object(r.a)({},(function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"hyperparameter-optimization-with-ray-tune"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hyperparameter-optimization-with-ray-tune"}},[n._v("#")]),n._v(" Hyperparameter optimization with Ray Tune")]),n._v(" "),a("p",[a("a",{attrs:{target:"_blank",href:"https://www.recogn.ai/biome-text/documentation/tutorials/Hyperparameter_optimization_with_Ray_Tune.html"}},[a("img",{staticClass:"icon",attrs:{src:"https://www.recogn.ai/biome-text/assets/img/biome-isotype.svg",width:"24"}})]),n._v(" "),a("a",{attrs:{href:"https://www.recogn.ai/biome-text/documentation/tutorials/Hyperparameter_optimization_with_Ray_Tune.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("View on recogn.ai"),a("OutboundLink")],1)]),n._v(" "),a("p",[a("a",{attrs:{target:"_blank",href:"https://colab.research.google.com/github/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Hyperparameter_optimization_with_Ray_Tune.ipynb"}},[a("img",{staticClass:"icon",attrs:{src:"https://www.tensorflow.org/images/colab_logo_32px.png",width:"24"}})]),n._v(" "),a("a",{attrs:{href:"https://colab.research.google.com/github/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Hyperparameter_optimization_with_Ray_Tune.ipynb",target:"_blank",rel:"noopener noreferrer"}},[n._v("Run in Google Colab"),a("OutboundLink")],1)]),n._v(" "),a("p",[a("a",{attrs:{target:"_blank",href:"https://github.com/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Hyperparameter_optimization_with_Ray_Tune.ipynb"}},[a("img",{staticClass:"icon",attrs:{src:"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",width:"24"}})]),n._v(" "),a("a",{attrs:{href:"https://github.com/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Hyperparameter_optimization_with_Ray_Tune.ipynb",target:"_blank",rel:"noopener noreferrer"}},[n._v("View source on GitHub"),a("OutboundLink")],1)]),n._v(" "),a("p",[n._v("In this tutorial we will optimize the hyperparameters of the short-text classifier from "),a("RouterLink",{attrs:{to:"/documentation/tutorials/Training_a_text_classifier.html"}},[n._v("this tutorial")]),n._v(".\nWe recommend to have a look at it first before going through the following tutorial.\nFor the Hyper-Parameter Optimization (HPO) we rely on the awesome "),a("a",{attrs:{href:"https://docs.ray.io/en/latest/tune.html#tune-index",target:"_blank",rel:"noopener noreferrer"}},[n._v("Ray Tune library"),a("OutboundLink")],1),n._v(" that is "),a("strong",[n._v("not")]),n._v(" a dependency of "),a("em",[n._v("biome.text")]),n._v(" and has to be installed additionally.")],1),n._v(" "),a("p",[n._v("For a short introduction to HPO with Ray Tune you can have a look at this nice "),a("a",{attrs:{href:"https://www.youtube.com/watch?v=VX7HvEoMrsA",target:"_blank",rel:"noopener noreferrer"}},[n._v("talk"),a("OutboundLink")],1),n._v(" by Richard Liaw.\nWe will follow his terminology and use the term "),a("em",[n._v("trial")]),n._v(" to refer to a training run of one set of hyperparameters.")]),n._v(" "),a("p",[n._v("When running this tutorial in Google Colab, make sure to install "),a("em",[n._v("biome.text")]),n._v(" and "),a("em",[n._v("ray tune")]),n._v(" first:")]),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#!pip install -U git+https://github.com/recognai/biome-text.git ray[tune]")]),n._v("\n")])])]),a("p",[n._v("Ignore warnings and don't forget to restart your runtime afterwards ("),a("em",[n._v("Runtime -> Restart runtime")]),n._v(").")]),n._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[n._v("Note")]),n._v(" "),a("p",[n._v("In this tutorial we will use a GPU by default.\nSo when running this tutorial in Google Colab, make sure that you request one ("),a("em",[n._v("Edit -> Notebook settings")]),n._v(").")])]),n._v(" "),a("h2",{attrs:{id:"download-the-data-and-create-the-vocabulary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#download-the-data-and-create-the-vocabulary"}},[n._v("#")]),n._v(" Download the data and create the vocabulary")]),n._v(" "),a("p",[n._v("As a first step we will download the training and validation data to our local machine.\nThis will save us some time in the long run, since we will perform the hyperparameter search on our local machine and access the data frequently.")]),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("!curl "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("O https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("//")]),n._v("biome"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("tutorials"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("s3"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("eu"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("west"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("1.")]),n._v("amazonaws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("/")]),n._v("text_classifier"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("/")]),n._v("business"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("cat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("train"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("csv\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("!curl "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("O https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("//")]),n._v("biome"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("tutorials"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("s3"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("eu"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),n._v("west"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("1.")]),n._v("amazonaws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("/")]),n._v("text_classifier"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("/")]),n._v("business"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("cat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("valid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("csv\n")])])]),a("p",[n._v("We will store the absolute path of the data to use them later on when creating our "),a("code",[n._v("DataSource")]),n._v("s.")]),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" os\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("from")]),n._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" DataSource\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("train_path "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("abspath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"business.cat.train.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\nvalid_path "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("abspath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"business.cat.valid.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("train_ds "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("train_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\nvalid_ds "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("valid_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("h3",{attrs:{id:"reuse-the-vocabulary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reuse-the-vocabulary"}},[n._v("#")]),n._v(" Reuse the vocabulary")]),n._v(" "),a("p",[n._v("In order to be more efficient and speed things up, we will create the vocabulary beforehand and reuse it in every trial.\nFor this we have to create a "),a("code",[n._v("Pipeline")]),n._v(" first, create the vocabulary from our "),a("code",[n._v("DataSource")]),n._v(" and save it to a folder.")]),n._v(" "),a("p",[n._v("Let's start with defining the configuration of our pipeline (for details see the "),a("RouterLink",{attrs:{to:"/documentation/tutorials/Training_a_text_classifier.html"}},[n._v("base tutorial")]),n._v("):")],1),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("from")]),n._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" DataSource\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("labels "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("train_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("to_dataframe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("label"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("compute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("pipeline_dict "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"german_business_names"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"tokenizer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"text_cleaning"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"rules"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"strip_spaces"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"features"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"word"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"embedding_dim"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"lowercase_tokens"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"char"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"embedding_dim"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"lowercase_characters"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"encoder"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"gru"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"num_layers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"hidden_size"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"bidirectional"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"dropout"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"head"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"TextClassification"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"labels"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[n._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("labels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("value_counts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"pooler"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"gru"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"num_layers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"hidden_size"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"bidirectional"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"feedforward"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"num_layers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"hidden_dims"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"activations"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"relu"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"dropout"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("0.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("       \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n")])])]),a("p",[n._v("We will use this configuration dictionary to create our pipeline:")]),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("from")]),n._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" Pipeline\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("pl "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" Pipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("from_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("pipeline_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("p",[n._v("Next, we have to define the vocabulary configuration and create our vocabulary.")]),n._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[n._v("Note")]),n._v(" "),a("p",[n._v("If you want to optimize the vocabulary configuration in the hyperparameter search (for example, the "),a("code",[n._v("min_count")]),n._v(" argument), you have to move the vocabulary creation to the "),a("code",[n._v("trainable")]),n._v(" function below. That is, in each trial the vocabulary will be created anew.")])]),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("from")]),n._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("configuration "),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" VocabularyConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" WordFeatures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" TrainerConfiguration\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("vocab_config "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" VocabularyConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("sources"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("train_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" min_count"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("WordFeatures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("namespace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("create_vocabulary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("vocab_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))\n")])])]),a("p",[n._v("To be able to reuse the vocabulary in each trial, we have to save it to a folder and store its absolute path:")]),n._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("vocab_absolute_path "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("abspath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"./vocabulary"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("save_vocabulary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("vocab_absolute_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("WARNING:root:vocabulary serialization directory /home/david/recognai/biome/biome-text/docs/docs/documentation/tutorials/vocabulary is not empty\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("trainer_config "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" TrainerConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("**")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"optimizer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"adam"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"lr"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("0.001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"num_epochs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"cuda_device"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("from")]),n._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("loggers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" WandBLogger\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("import")]),n._v(" wandb\nwandb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("True\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("wandb_logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" WandBLogger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("project_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" run_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"test1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" tags"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"tag1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"tag2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("train"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    output"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[n._v('"output"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    training"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("train_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    validation"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("valid_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    trainer"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("trainer_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    loggers"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("wandb_logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("2020-08-27 20:14:36,795 - allennlp.common.params - INFO - config = <biome.text.configuration.PipelineConfiguration object at 0x7f6612810350>\n2020-08-27 20:14:37,206 - allennlp.common.params - INFO - type = default\n2020-08-27 20:14:37,207 - allennlp.common.params - INFO - rules = ['strip_spaces']\n2020-08-27 20:14:37,207 - allennlp.common.params - INFO - type = single_id\n2020-08-27 20:14:37,208 - allennlp.common.params - INFO - namespace = word\n2020-08-27 20:14:37,208 - allennlp.common.params - INFO - lowercase_tokens = True\n2020-08-27 20:14:37,209 - allennlp.common.params - INFO - start_tokens = None\n2020-08-27 20:14:37,209 - allennlp.common.params - INFO - end_tokens = None\n2020-08-27 20:14:37,210 - allennlp.common.params - INFO - feature_name = text\n2020-08-27 20:14:37,211 - allennlp.common.params - INFO - default_value = THIS IS A REALLY UNLIKELY VALUE THAT HAS TO BE A STRING\n2020-08-27 20:14:37,211 - allennlp.common.params - INFO - token_min_padding_length = 0\n2020-08-27 20:14:37,212 - allennlp.common.params - INFO - type = characters\n2020-08-27 20:14:37,212 - allennlp.common.params - INFO - namespace = char\n2020-08-27 20:14:37,213 - allennlp.common.params - INFO - character_tokenizer.byte_encoding = None\n2020-08-27 20:14:37,213 - allennlp.common.params - INFO - character_tokenizer.lowercase_characters = True\n2020-08-27 20:14:37,213 - allennlp.common.params - INFO - character_tokenizer.start_tokens = None\n2020-08-27 20:14:37,214 - allennlp.common.params - INFO - character_tokenizer.end_tokens = None\n2020-08-27 20:14:37,214 - allennlp.common.params - INFO - start_tokens = None\n2020-08-27 20:14:37,215 - allennlp.common.params - INFO - end_tokens = None\n2020-08-27 20:14:37,216 - allennlp.common.params - INFO - min_padding_length = 0\n2020-08-27 20:14:37,216 - allennlp.common.params - INFO - token_min_padding_length = 0\n2020-08-27 20:14:37,216 - allennlp.common.params - INFO - type = basic\n2020-08-27 20:14:37,217 - allennlp.common.params - INFO - token_embedders.word.type = embedding\n2020-08-27 20:14:37,217 - allennlp.common.params - INFO - token_embedders.word.embedding_dim = 64\n2020-08-27 20:14:37,218 - allennlp.common.params - INFO - token_embedders.word.num_embeddings = None\n2020-08-27 20:14:37,218 - allennlp.common.params - INFO - token_embedders.word.projection_dim = None\n2020-08-27 20:14:37,219 - allennlp.common.params - INFO - token_embedders.word.weight = None\n2020-08-27 20:14:37,219 - allennlp.common.params - INFO - token_embedders.word.padding_index = None\n2020-08-27 20:14:37,219 - allennlp.common.params - INFO - token_embedders.word.trainable = True\n2020-08-27 20:14:37,220 - allennlp.common.params - INFO - token_embedders.word.max_norm = None\n2020-08-27 20:14:37,220 - allennlp.common.params - INFO - token_embedders.word.norm_type = 2.0\n2020-08-27 20:14:37,220 - allennlp.common.params - INFO - token_embedders.word.scale_grad_by_freq = False\n2020-08-27 20:14:37,221 - allennlp.common.params - INFO - token_embedders.word.sparse = False\n2020-08-27 20:14:37,221 - allennlp.common.params - INFO - token_embedders.word.vocab_namespace = word\n2020-08-27 20:14:37,221 - allennlp.common.params - INFO - token_embedders.word.pretrained_file = None\n2020-08-27 20:14:37,223 - allennlp.common.params - INFO - token_embedders.char.type = character_encoding\n2020-08-27 20:14:37,224 - allennlp.common.params - INFO - token_embedders.char.embedding.embedding_dim = 32\n2020-08-27 20:14:37,224 - allennlp.common.params - INFO - token_embedders.char.embedding.num_embeddings = None\n2020-08-27 20:14:37,225 - allennlp.common.params - INFO - token_embedders.char.embedding.projection_dim = None\n2020-08-27 20:14:37,225 - allennlp.common.params - INFO - token_embedders.char.embedding.weight = None\n2020-08-27 20:14:37,226 - allennlp.common.params - INFO - token_embedders.char.embedding.padding_index = None\n2020-08-27 20:14:37,226 - allennlp.common.params - INFO - token_embedders.char.embedding.trainable = True\n2020-08-27 20:14:37,227 - allennlp.common.params - INFO - token_embedders.char.embedding.max_norm = None\n2020-08-27 20:14:37,227 - allennlp.common.params - INFO - token_embedders.char.embedding.norm_type = 2.0\n2020-08-27 20:14:37,227 - allennlp.common.params - INFO - token_embedders.char.embedding.scale_grad_by_freq = False\n2020-08-27 20:14:37,228 - allennlp.common.params - INFO - token_embedders.char.embedding.sparse = False\n2020-08-27 20:14:37,228 - allennlp.common.params - INFO - token_embedders.char.embedding.vocab_namespace = char\n2020-08-27 20:14:37,228 - allennlp.common.params - INFO - token_embedders.char.embedding.pretrained_file = None\n2020-08-27 20:14:37,229 - allennlp.common.params - INFO - token_embedders.char.encoder.type = allennlp.modules.seq2vec_encoders.pytorch_seq2vec_wrapper.GruSeq2VecEncoder\n2020-08-27 20:14:37,229 - allennlp.common.params - INFO - token_embedders.char.encoder.input_size = 32\n2020-08-27 20:14:37,230 - allennlp.common.params - INFO - token_embedders.char.encoder.hidden_size = 32\n2020-08-27 20:14:37,230 - allennlp.common.params - INFO - token_embedders.char.encoder.num_layers = 1\n2020-08-27 20:14:37,231 - allennlp.common.params - INFO - token_embedders.char.encoder.bias = True\n2020-08-27 20:14:37,232 - allennlp.common.params - INFO - token_embedders.char.encoder.dropout = 0.0\n2020-08-27 20:14:37,234 - allennlp.common.params - INFO - token_embedders.char.encoder.bidirectional = True\n2020-08-27 20:14:37,235 - allennlp.common.params - INFO - token_embedders.char.dropout = 0.1\n2020-08-27 20:14:37,236 - allennlp.common.params - INFO - labels = ['Unternehmensberatungen', 'Friseure', 'Tiefbau', 'Dienstleistungen', 'Gebrauchtwagen', 'Elektriker', 'Restaurants', 'Architekturbüros', 'Vereine', 'Versicherungsvermittler', 'Maler', 'Sanitärinstallationen', 'Edv', 'Werbeagenturen', 'Apotheken', 'Physiotherapie', 'Vermittlungen', 'Hotels', 'Autowerkstätten', 'Elektrotechnik', 'Allgemeinärzte', 'Handelsvermittler Und -vertreter']\n2020-08-27 20:14:37,237 - allennlp.common.params - INFO - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.\n2020-08-27 20:14:37,237 - allennlp.common.params - INFO - CURRENTLY DEFINED PARAMETERS: \n2020-08-27 20:14:37,237 - allennlp.common.params - INFO - pooler.type = gru\n2020-08-27 20:14:37,237 - allennlp.common.params - INFO - pooler.num_layers = 1\n2020-08-27 20:14:37,238 - allennlp.common.params - INFO - pooler.hidden_size = 32\n2020-08-27 20:14:37,238 - allennlp.common.params - INFO - pooler.bidirectional = True\n2020-08-27 20:14:37,239 - allennlp.common.params - INFO - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.\n2020-08-27 20:14:37,239 - allennlp.common.params - INFO - CURRENTLY DEFINED PARAMETERS: \n2020-08-27 20:14:37,239 - allennlp.common.params - INFO - feedforward.num_layers = 1\n2020-08-27 20:14:37,240 - allennlp.common.params - INFO - feedforward.hidden_dims = [32]\n2020-08-27 20:14:37,241 - allennlp.common.params - INFO - feedforward.activations = ['relu']\n2020-08-27 20:14:37,241 - allennlp.common.params - INFO - feedforward.dropout = [0.0]\n2020-08-27 20:14:37,241 - allennlp.common.params - INFO - multilabel = False\n2020-08-27 20:14:37,242 - allennlp.common.params - INFO - input_size = 128\n2020-08-27 20:14:37,243 - allennlp.common.params - INFO - hidden_size = 32\n2020-08-27 20:14:37,243 - allennlp.common.params - INFO - num_layers = 1\n2020-08-27 20:14:37,243 - allennlp.common.params - INFO - bias = True\n2020-08-27 20:14:37,244 - allennlp.common.params - INFO - dropout = 0.0\n2020-08-27 20:14:37,244 - allennlp.common.params - INFO - bidirectional = True\n2020-08-27 20:14:37,247 - allennlp.common.params - INFO - input_dim = 64\n2020-08-27 20:14:37,247 - allennlp.common.params - INFO - num_layers = 1\n2020-08-27 20:14:37,248 - allennlp.common.params - INFO - hidden_dims = [32]\n2020-08-27 20:14:37,248 - allennlp.common.params - INFO - activations = ['relu']\n2020-08-27 20:14:37,249 - allennlp.common.params - INFO - type = relu\n2020-08-27 20:14:37,249 - allennlp.common.params - INFO - dropout = [0.0]\n2020-08-27 20:15:21,393 - allennlp.common.params - INFO - random_seed = 13370\n2020-08-27 20:15:21,394 - allennlp.common.params - INFO - numpy_seed = 1337\n2020-08-27 20:15:21,394 - allennlp.common.params - INFO - pytorch_seed = 133\n2020-08-27 20:15:21,424 - allennlp.common.checks - INFO - Pytorch version: 1.5.1\n2020-08-27 20:15:21,429 - allennlp.common.params - INFO - type = gradient_descent\n2020-08-27 20:15:21,430 - allennlp.common.params - INFO - local_rank = 0\n2020-08-27 20:15:21,431 - allennlp.common.params - INFO - patience = 2\n2020-08-27 20:15:21,431 - allennlp.common.params - INFO - validation_metric = -loss\n2020-08-27 20:15:21,432 - allennlp.common.params - INFO - num_epochs = 3\n2020-08-27 20:15:21,432 - allennlp.common.params - INFO - cuda_device = 0\n2020-08-27 20:15:21,433 - allennlp.common.params - INFO - grad_norm = None\n2020-08-27 20:15:21,433 - allennlp.common.params - INFO - grad_clipping = None\n2020-08-27 20:15:21,433 - allennlp.common.params - INFO - distributed = None\n2020-08-27 20:15:21,434 - allennlp.common.params - INFO - world_size = 1\n2020-08-27 20:15:21,434 - allennlp.common.params - INFO - num_gradient_accumulation_steps = 1\n2020-08-27 20:15:21,434 - allennlp.common.params - INFO - opt_level = None\n2020-08-27 20:15:21,435 - allennlp.common.params - INFO - no_grad = None\n2020-08-27 20:15:21,435 - allennlp.common.params - INFO - learning_rate_scheduler = None\n2020-08-27 20:15:21,436 - allennlp.common.params - INFO - momentum_scheduler = None\n2020-08-27 20:15:21,436 - allennlp.common.params - INFO - moving_average = None\n2020-08-27 20:15:21,437 - allennlp.common.params - INFO - batch_callbacks = None\n2020-08-27 20:15:23,990 - allennlp.common.util - INFO - The following parameters are Frozen (without gradient):\n2020-08-27 20:15:23,990 - allennlp.common.util - INFO - The following parameters are Tunable (with gradient):\n2020-08-27 20:15:23,991 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_word.weight\n2020-08-27 20:15:23,991 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._embedding._module.weight\n2020-08-27 20:15:23,992 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_ih_l0\n2020-08-27 20:15:23,992 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_hh_l0\n2020-08-27 20:15:23,992 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_ih_l0\n2020-08-27 20:15:23,993 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_hh_l0\n2020-08-27 20:15:23,993 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_ih_l0_reverse\n2020-08-27 20:15:23,993 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_hh_l0_reverse\n2020-08-27 20:15:23,994 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_ih_l0_reverse\n2020-08-27 20:15:23,994 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_hh_l0_reverse\n2020-08-27 20:15:23,995 - allennlp.common.util - INFO - _head.pooler._module.weight_ih_l0\n2020-08-27 20:15:23,995 - allennlp.common.util - INFO - _head.pooler._module.weight_hh_l0\n2020-08-27 20:15:23,995 - allennlp.common.util - INFO - _head.pooler._module.bias_ih_l0\n2020-08-27 20:15:23,996 - allennlp.common.util - INFO - _head.pooler._module.bias_hh_l0\n2020-08-27 20:15:23,996 - allennlp.common.util - INFO - _head.pooler._module.weight_ih_l0_reverse\n2020-08-27 20:15:23,996 - allennlp.common.util - INFO - _head.pooler._module.weight_hh_l0_reverse\n2020-08-27 20:15:23,997 - allennlp.common.util - INFO - _head.pooler._module.bias_ih_l0_reverse\n2020-08-27 20:15:23,997 - allennlp.common.util - INFO - _head.pooler._module.bias_hh_l0_reverse\n2020-08-27 20:15:23,998 - allennlp.common.util - INFO - _head.feedforward._linear_layers.0.weight\n2020-08-27 20:15:23,999 - allennlp.common.util - INFO - _head.feedforward._linear_layers.0.bias\n2020-08-27 20:15:23,999 - allennlp.common.util - INFO - _head._classification_layer.weight\n2020-08-27 20:15:23,999 - allennlp.common.util - INFO - _head._classification_layer.bias\n2020-08-27 20:15:24,000 - allennlp.common.params - INFO - optimizer.type = adam\n2020-08-27 20:15:24,001 - allennlp.common.params - INFO - optimizer.parameter_groups = None\n2020-08-27 20:15:24,001 - allennlp.common.params - INFO - optimizer.lr = 0.001\n2020-08-27 20:15:24,001 - allennlp.common.params - INFO - optimizer.betas = (0.9, 0.999)\n2020-08-27 20:15:24,002 - allennlp.common.params - INFO - optimizer.eps = 1e-08\n2020-08-27 20:15:24,002 - allennlp.common.params - INFO - optimizer.weight_decay = 0.0\n2020-08-27 20:15:24,003 - allennlp.common.params - INFO - optimizer.amsgrad = False\n2020-08-27 20:15:24,003 - allennlp.training.optimizers - INFO - Number of trainable parameters: 60566\n2020-08-27 20:15:24,004 - allennlp.common.params - INFO - checkpointer.type = default\n2020-08-27 20:15:24,004 - allennlp.common.params - INFO - checkpointer.keep_serialized_model_every_num_seconds = None\n2020-08-27 20:15:24,005 - allennlp.common.params - INFO - checkpointer.num_serialized_models_to_keep = 1\n2020-08-27 20:15:24,005 - allennlp.common.params - INFO - checkpointer.model_save_interval = None\n2020-08-27 20:15:24,005 - allennlp.common.params - INFO - tensorboard_writer.summary_interval = 100\n2020-08-27 20:15:24,006 - allennlp.common.params - INFO - tensorboard_writer.histogram_interval = None\n2020-08-27 20:15:24,007 - allennlp.common.params - INFO - tensorboard_writer.batch_size_interval = None\n2020-08-27 20:15:24,007 - allennlp.common.params - INFO - tensorboard_writer.should_log_parameter_statistics = True\n2020-08-27 20:15:24,008 - allennlp.common.params - INFO - tensorboard_writer.should_log_learning_rate = True\n2020-08-27 20:15:24,008 - allennlp.common.params - INFO - tensorboard_writer.get_batch_num_total = None\n")])])]),a("p",[n._v("Logging results to "),a("a",{attrs:{href:"https://wandb.com",target:"_blank"}},[n._v("Weights & Biases")]),n._v(" "),a("a",{attrs:{href:"https://docs.wandb.com/integrations/jupyter.html",target:"_blank"}},[n._v("(Documentation)")]),n._v("."),a("br"),n._v("\nProject page: "),a("a",{attrs:{href:"https://app.wandb.ai/dcfidalgo/test",target:"_blank"}},[n._v("https://app.wandb.ai/dcfidalgo/test")]),a("br"),n._v("\nRun page: "),a("a",{attrs:{href:"https://app.wandb.ai/dcfidalgo/test/runs/3euslhy7",target:"_blank"}},[n._v("https://app.wandb.ai/dcfidalgo/test/runs/3euslhy7")]),a("br")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("2020-08-27 20:15:25,954 - allennlp.training.trainer - INFO - Beginning training.\n2020-08-27 20:15:25,955 - allennlp.training.trainer - INFO - Epoch 0/2\n2020-08-27 20:15:25,956 - allennlp.training.trainer - INFO - Worker 0 memory usage MB: 4375.932\n2020-08-27 20:15:26,066 - allennlp.training.trainer - INFO - GPU 0 memory usage MB: 701\n2020-08-27 20:15:26,068 - allennlp.training.trainer - INFO - Training\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=500.0), HTML(value='')))\n\n\n2020-08-27 20:15:26,139 - allennlp.training.util - WARNING - Metrics with names beginning with \"_\" will not be logged to the tqdm progress bar.\n2020-08-27 20:15:35,279 - allennlp.training.trainer - INFO - Validating\n\n\n\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=125.0), HTML(value='')))\n\n\n2020-08-27 20:15:36,789 - allennlp.training.tensorboard_writer - INFO -                                                 Training |  Validation\n2020-08-27 20:15:36,790 - allennlp.training.tensorboard_writer - INFO - _fscore/Allgemeinärzte                      |     0.633  |     0.955\n2020-08-27 20:15:36,791 - allennlp.training.tensorboard_writer - INFO - _fscore/Apotheken                           |     0.560  |     0.839\n2020-08-27 20:15:36,792 - allennlp.training.tensorboard_writer - INFO - _fscore/Architekturbüros                    |     0.684  |     0.952\n2020-08-27 20:15:36,792 - allennlp.training.tensorboard_writer - INFO - _fscore/Autowerkstätten                     |     0.432  |     0.715\n2020-08-27 20:15:36,793 - allennlp.training.tensorboard_writer - INFO - _fscore/Dienstleistungen                    |     0.302  |     0.676\n2020-08-27 20:15:36,794 - allennlp.training.tensorboard_writer - INFO - _fscore/Edv                                 |     0.260  |     0.519\n2020-08-27 20:15:36,795 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektriker                          |     0.519  |     0.820\n2020-08-27 20:15:36,795 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektrotechnik                      |     0.400  |     0.901\n2020-08-27 20:15:36,796 - allennlp.training.tensorboard_writer - INFO - _fscore/Friseure                            |     0.459  |     0.815\n2020-08-27 20:15:36,797 - allennlp.training.tensorboard_writer - INFO - _fscore/Gebrauchtwagen                      |     0.612  |     0.902\n2020-08-27 20:15:36,797 - allennlp.training.tensorboard_writer - INFO - _fscore/Handelsvermittler_Und_-vertreter    |     0.102  |     0.403\n2020-08-27 20:15:36,798 - allennlp.training.tensorboard_writer - INFO - _fscore/Hotels                              |     0.421  |     0.781\n2020-08-27 20:15:36,799 - allennlp.training.tensorboard_writer - INFO - _fscore/Maler                               |     0.581  |     0.918\n2020-08-27 20:15:36,799 - allennlp.training.tensorboard_writer - INFO - _fscore/Physiotherapie                      |     0.506  |     0.861\n2020-08-27 20:15:36,800 - allennlp.training.tensorboard_writer - INFO - _fscore/Restaurants                         |     0.339  |     0.646\n2020-08-27 20:15:36,801 - allennlp.training.tensorboard_writer - INFO - _fscore/Sanitärinstallationen               |     0.424  |     0.843\n2020-08-27 20:15:36,801 - allennlp.training.tensorboard_writer - INFO - _fscore/Tiefbau                             |     0.462  |     0.939\n2020-08-27 20:15:36,802 - allennlp.training.tensorboard_writer - INFO - _fscore/Unternehmensberatungen              |     0.502  |     0.834\n2020-08-27 20:15:36,803 - allennlp.training.tensorboard_writer - INFO - _fscore/Vereine                             |     0.701  |     0.929\n2020-08-27 20:15:36,804 - allennlp.training.tensorboard_writer - INFO - _fscore/Vermittlungen                       |     0.629  |     0.948\n2020-08-27 20:15:36,805 - allennlp.training.tensorboard_writer - INFO - _fscore/Versicherungsvermittler             |     0.553  |     0.905\n2020-08-27 20:15:36,806 - allennlp.training.tensorboard_writer - INFO - _fscore/Werbeagenturen                      |     0.382  |     0.627\n2020-08-27 20:15:36,809 - allennlp.training.tensorboard_writer - INFO - _precision/Allgemeinärzte                   |     0.877  |     1.000\n2020-08-27 20:15:36,809 - allennlp.training.tensorboard_writer - INFO - _precision/Apotheken                        |     0.907  |     0.855\n2020-08-27 20:15:36,810 - allennlp.training.tensorboard_writer - INFO - _precision/Architekturbüros                 |     0.919  |     0.971\n2020-08-27 20:15:36,811 - allennlp.training.tensorboard_writer - INFO - _precision/Autowerkstätten                  |     0.667  |     0.815\n2020-08-27 20:15:36,812 - allennlp.training.tensorboard_writer - INFO - _precision/Dienstleistungen                 |     0.213  |     0.568\n2020-08-27 20:15:36,813 - allennlp.training.tensorboard_writer - INFO - _precision/Edv                              |     0.557  |     0.944\n2020-08-27 20:15:36,813 - allennlp.training.tensorboard_writer - INFO - _precision/Elektriker                       |     0.629  |     0.846\n2020-08-27 20:15:36,814 - allennlp.training.tensorboard_writer - INFO - _precision/Elektrotechnik                   |     0.755  |     0.937\n2020-08-27 20:15:36,815 - allennlp.training.tensorboard_writer - INFO - _precision/Friseure                         |     0.335  |     0.730\n2020-08-27 20:15:36,816 - allennlp.training.tensorboard_writer - INFO - _precision/Gebrauchtwagen                   |     0.886  |     0.953\n2020-08-27 20:15:36,817 - allennlp.training.tensorboard_writer - INFO - _precision/Handelsvermittler_Und_-vertreter |     0.142  |     0.377\n2020-08-27 20:15:36,818 - allennlp.training.tensorboard_writer - INFO - _precision/Hotels                           |     0.837  |     0.847\n2020-08-27 20:15:36,818 - allennlp.training.tensorboard_writer - INFO - _precision/Maler                            |     0.788  |     0.897\n2020-08-27 20:15:36,819 - allennlp.training.tensorboard_writer - INFO - _precision/Physiotherapie                   |     0.851  |     0.915\n2020-08-27 20:15:36,820 - allennlp.training.tensorboard_writer - INFO - _precision/Restaurants                      |     0.269  |     0.605\n2020-08-27 20:15:36,821 - allennlp.training.tensorboard_writer - INFO - _precision/Sanitärinstallationen            |     0.646  |     0.848\n2020-08-27 20:15:36,822 - allennlp.training.tensorboard_writer - INFO - _precision/Tiefbau                          |     0.345  |     0.982\n2020-08-27 20:15:36,823 - allennlp.training.tensorboard_writer - INFO - _precision/Unternehmensberatungen           |     0.412  |     0.766\n2020-08-27 20:15:36,824 - allennlp.training.tensorboard_writer - INFO - _precision/Vereine                          |     0.791  |     0.989\n2020-08-27 20:15:36,825 - allennlp.training.tensorboard_writer - INFO - _precision/Vermittlungen                    |     0.825  |     0.955\n2020-08-27 20:15:36,827 - allennlp.training.tensorboard_writer - INFO - _precision/Versicherungsvermittler          |     0.803  |     0.947\n2020-08-27 20:15:36,828 - allennlp.training.tensorboard_writer - INFO - _precision/Werbeagenturen                   |     0.623  |     0.573\n2020-08-27 20:15:36,829 - allennlp.training.tensorboard_writer - INFO - _recall/Allgemeinärzte                      |     0.495  |     0.914\n2020-08-27 20:15:36,830 - allennlp.training.tensorboard_writer - INFO - _recall/Apotheken                           |     0.405  |     0.825\n2020-08-27 20:15:36,831 - allennlp.training.tensorboard_writer - INFO - _recall/Architekturbüros                    |     0.544  |     0.934\n2020-08-27 20:15:36,832 - allennlp.training.tensorboard_writer - INFO - _recall/Autowerkstätten                     |     0.319  |     0.638\n2020-08-27 20:15:36,833 - allennlp.training.tensorboard_writer - INFO - _recall/Dienstleistungen                    |     0.515  |     0.836\n2020-08-27 20:15:36,834 - allennlp.training.tensorboard_writer - INFO - _recall/Edv                                 |     0.170  |     0.358\n2020-08-27 20:15:36,835 - allennlp.training.tensorboard_writer - INFO - _recall/Elektriker                          |     0.442  |     0.795\n2020-08-27 20:15:36,836 - allennlp.training.tensorboard_writer - INFO - _recall/Elektrotechnik                      |     0.272  |     0.868\n2020-08-27 20:15:36,837 - allennlp.training.tensorboard_writer - INFO - _recall/Friseure                            |     0.725  |     0.922\n2020-08-27 20:15:36,838 - allennlp.training.tensorboard_writer - INFO - _recall/Gebrauchtwagen                      |     0.468  |     0.856\n2020-08-27 20:15:36,840 - allennlp.training.tensorboard_writer - INFO - _recall/Handelsvermittler_Und_-vertreter    |     0.079  |     0.433\n2020-08-27 20:15:36,841 - allennlp.training.tensorboard_writer - INFO - _recall/Hotels                              |     0.281  |     0.725\n2020-08-27 20:15:36,842 - allennlp.training.tensorboard_writer - INFO - _recall/Maler                               |     0.461  |     0.940\n2020-08-27 20:15:36,843 - allennlp.training.tensorboard_writer - INFO - _recall/Physiotherapie                      |     0.360  |     0.812\n2020-08-27 20:15:36,845 - allennlp.training.tensorboard_writer - INFO - _recall/Restaurants                         |     0.460  |     0.692\n2020-08-27 20:15:36,846 - allennlp.training.tensorboard_writer - INFO - _recall/Sanitärinstallationen               |     0.316  |     0.839\n2020-08-27 20:15:36,847 - allennlp.training.tensorboard_writer - INFO - _recall/Tiefbau                             |     0.701  |     0.899\n2020-08-27 20:15:36,848 - allennlp.training.tensorboard_writer - INFO - _recall/Unternehmensberatungen              |     0.642  |     0.916\n2020-08-27 20:15:36,849 - allennlp.training.tensorboard_writer - INFO - _recall/Vereine                             |     0.630  |     0.875\n2020-08-27 20:15:36,850 - allennlp.training.tensorboard_writer - INFO - _recall/Vermittlungen                       |     0.509  |     0.941\n2020-08-27 20:15:36,851 - allennlp.training.tensorboard_writer - INFO - _recall/Versicherungsvermittler             |     0.422  |     0.865\n2020-08-27 20:15:36,852 - allennlp.training.tensorboard_writer - INFO - _recall/Werbeagenturen                      |     0.276  |     0.691\n2020-08-27 20:15:36,853 - allennlp.training.tensorboard_writer - INFO - accuracy                                    |     0.469  |     0.812\n2020-08-27 20:15:36,854 - allennlp.training.tensorboard_writer - INFO - gpu_0_memory_MB                             |   701.000  |       N/A\n2020-08-27 20:15:36,854 - allennlp.training.tensorboard_writer - INFO - loss                                        |     1.850  |     0.734\n2020-08-27 20:15:36,855 - allennlp.training.tensorboard_writer - INFO - macro/fscore                                |     0.476  |     0.806\n2020-08-27 20:15:36,856 - allennlp.training.tensorboard_writer - INFO - macro/precision                             |     0.640  |     0.833\n2020-08-27 20:15:36,857 - allennlp.training.tensorboard_writer - INFO - macro/recall                                |     0.431  |     0.799\n2020-08-27 20:15:36,858 - allennlp.training.tensorboard_writer - INFO - micro/fscore                                |     0.469  |     0.812\n2020-08-27 20:15:36,859 - allennlp.training.tensorboard_writer - INFO - micro/precision                             |     0.469  |     0.812\n2020-08-27 20:15:36,860 - allennlp.training.tensorboard_writer - INFO - micro/recall                                |     0.469  |     0.812\n2020-08-27 20:15:36,861 - allennlp.training.tensorboard_writer - INFO - reg_loss                                    |     0.000  |     0.000\n2020-08-27 20:15:36,863 - allennlp.training.tensorboard_writer - INFO - worker_0_memory_MB                          |  4375.932  |       N/A\n2020-08-27 20:15:36,871 - allennlp.training.checkpointer - INFO - Best validation performance so far. Copying weights to 'output/best.th'.\n2020-08-27 20:15:36,880 - allennlp.training.trainer - INFO - Epoch duration: 0:00:10.925002\n2020-08-27 20:15:36,881 - allennlp.training.trainer - INFO - Estimated training time remaining: 0:00:21\n2020-08-27 20:15:36,882 - allennlp.training.trainer - INFO - Epoch 1/2\n2020-08-27 20:15:36,882 - allennlp.training.trainer - INFO - Worker 0 memory usage MB: 4415.612\n\n\n\n\n\n2020-08-27 20:15:37,013 - allennlp.training.trainer - INFO - GPU 0 memory usage MB: 751\n2020-08-27 20:15:37,014 - allennlp.training.trainer - INFO - Training\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=500.0), HTML(value='')))\n\n\n2020-08-27 20:15:45,490 - allennlp.training.trainer - INFO - Validating\n\n\n\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=125.0), HTML(value='')))\n\n\n2020-08-27 20:15:46,913 - allennlp.training.tensorboard_writer - INFO -                                                 Training |  Validation\n2020-08-27 20:15:46,914 - allennlp.training.tensorboard_writer - INFO - _fscore/Allgemeinärzte                      |     0.965  |     0.955\n2020-08-27 20:15:46,914 - allennlp.training.tensorboard_writer - INFO - _fscore/Apotheken                           |     0.864  |     0.832\n2020-08-27 20:15:46,915 - allennlp.training.tensorboard_writer - INFO - _fscore/Architekturbüros                    |     0.964  |     0.981\n2020-08-27 20:15:46,916 - allennlp.training.tensorboard_writer - INFO - _fscore/Autowerkstätten                     |     0.807  |     0.797\n2020-08-27 20:15:46,916 - allennlp.training.tensorboard_writer - INFO - _fscore/Dienstleistungen                    |     0.845  |     0.845\n2020-08-27 20:15:46,917 - allennlp.training.tensorboard_writer - INFO - _fscore/Edv                                 |     0.816  |     0.764\n2020-08-27 20:15:46,918 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektriker                          |     0.916  |     0.908\n2020-08-27 20:15:46,918 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektrotechnik                      |     0.903  |     0.940\n2020-08-27 20:15:46,919 - allennlp.training.tensorboard_writer - INFO - _fscore/Friseure                            |     0.911  |     0.932\n2020-08-27 20:15:46,920 - allennlp.training.tensorboard_writer - INFO - _fscore/Gebrauchtwagen                      |     0.876  |     0.882\n2020-08-27 20:15:46,920 - allennlp.training.tensorboard_writer - INFO - _fscore/Handelsvermittler_Und_-vertreter    |     0.624  |     0.619\n2020-08-27 20:15:46,921 - allennlp.training.tensorboard_writer - INFO - _fscore/Hotels                              |     0.779  |     0.816\n2020-08-27 20:15:46,921 - allennlp.training.tensorboard_writer - INFO - _fscore/Maler                               |     0.913  |     0.959\n2020-08-27 20:15:46,925 - allennlp.training.tensorboard_writer - INFO - _fscore/Physiotherapie                      |     0.902  |     0.943\n2020-08-27 20:15:46,926 - allennlp.training.tensorboard_writer - INFO - _fscore/Restaurants                         |     0.680  |     0.758\n2020-08-27 20:15:46,927 - allennlp.training.tensorboard_writer - INFO - _fscore/Sanitärinstallationen               |     0.861  |     0.921\n2020-08-27 20:15:46,928 - allennlp.training.tensorboard_writer - INFO - _fscore/Tiefbau                             |     0.955  |     0.949\n2020-08-27 20:15:46,930 - allennlp.training.tensorboard_writer - INFO - _fscore/Unternehmensberatungen              |     0.886  |     0.836\n2020-08-27 20:15:46,930 - allennlp.training.tensorboard_writer - INFO - _fscore/Vereine                             |     0.967  |     0.965\n2020-08-27 20:15:46,931 - allennlp.training.tensorboard_writer - INFO - _fscore/Vermittlungen                       |     0.950  |     0.978\n2020-08-27 20:15:46,932 - allennlp.training.tensorboard_writer - INFO - _fscore/Versicherungsvermittler             |     0.945  |     0.957\n2020-08-27 20:15:46,933 - allennlp.training.tensorboard_writer - INFO - _fscore/Werbeagenturen                      |     0.833  |     0.791\n2020-08-27 20:15:46,934 - allennlp.training.tensorboard_writer - INFO - _precision/Allgemeinärzte                   |     0.976  |     1.000\n2020-08-27 20:15:46,935 - allennlp.training.tensorboard_writer - INFO - _precision/Apotheken                        |     0.922  |     0.839\n2020-08-27 20:15:46,936 - allennlp.training.tensorboard_writer - INFO - _precision/Architekturbüros                 |     0.978  |     1.000\n2020-08-27 20:15:46,937 - allennlp.training.tensorboard_writer - INFO - _precision/Autowerkstätten                  |     0.837  |     0.907\n2020-08-27 20:15:46,937 - allennlp.training.tensorboard_writer - INFO - _precision/Dienstleistungen                 |     0.828  |     0.783\n2020-08-27 20:15:46,938 - allennlp.training.tensorboard_writer - INFO - _precision/Edv                              |     0.889  |     0.968\n2020-08-27 20:15:46,939 - allennlp.training.tensorboard_writer - INFO - _precision/Elektriker                       |     0.908  |     0.925\n2020-08-27 20:15:46,940 - allennlp.training.tensorboard_writer - INFO - _precision/Elektrotechnik                   |     0.931  |     0.955\n2020-08-27 20:15:46,941 - allennlp.training.tensorboard_writer - INFO - _precision/Friseure                         |     0.886  |     0.936\n2020-08-27 20:15:46,942 - allennlp.training.tensorboard_writer - INFO - _precision/Gebrauchtwagen                   |     0.897  |     0.875\n2020-08-27 20:15:46,942 - allennlp.training.tensorboard_writer - INFO - _precision/Handelsvermittler_Und_-vertreter |     0.624  |     0.505\n2020-08-27 20:15:46,943 - allennlp.training.tensorboard_writer - INFO - _precision/Hotels                           |     0.849  |     0.911\n2020-08-27 20:15:46,944 - allennlp.training.tensorboard_writer - INFO - _precision/Maler                            |     0.877  |     0.942\n2020-08-27 20:15:46,945 - allennlp.training.tensorboard_writer - INFO - _precision/Physiotherapie                   |     0.917  |     0.949\n2020-08-27 20:15:46,946 - allennlp.training.tensorboard_writer - INFO - _precision/Restaurants                      |     0.577  |     0.748\n2020-08-27 20:15:46,947 - allennlp.training.tensorboard_writer - INFO - _precision/Sanitärinstallationen            |     0.858  |     0.965\n2020-08-27 20:15:46,947 - allennlp.training.tensorboard_writer - INFO - _precision/Tiefbau                          |     0.985  |     0.965\n2020-08-27 20:15:46,948 - allennlp.training.tensorboard_writer - INFO - _precision/Unternehmensberatungen           |     0.868  |     0.750\n2020-08-27 20:15:46,949 - allennlp.training.tensorboard_writer - INFO - _precision/Vereine                          |     0.981  |     1.000\n2020-08-27 20:15:46,949 - allennlp.training.tensorboard_writer - INFO - _precision/Vermittlungen                    |     0.970  |     0.971\n2020-08-27 20:15:46,950 - allennlp.training.tensorboard_writer - INFO - _precision/Versicherungsvermittler          |     0.957  |     0.961\n2020-08-27 20:15:46,951 - allennlp.training.tensorboard_writer - INFO - _precision/Werbeagenturen                   |     0.891  |     0.803\n2020-08-27 20:15:46,952 - allennlp.training.tensorboard_writer - INFO - _recall/Allgemeinärzte                      |     0.954  |     0.914\n2020-08-27 20:15:46,952 - allennlp.training.tensorboard_writer - INFO - _recall/Apotheken                           |     0.813  |     0.825\n2020-08-27 20:15:46,953 - allennlp.training.tensorboard_writer - INFO - _recall/Architekturbüros                    |     0.950  |     0.962\n2020-08-27 20:15:46,954 - allennlp.training.tensorboard_writer - INFO - _recall/Autowerkstätten                     |     0.779  |     0.710\n2020-08-27 20:15:46,954 - allennlp.training.tensorboard_writer - INFO - _recall/Dienstleistungen                    |     0.863  |     0.918\n2020-08-27 20:15:46,955 - allennlp.training.tensorboard_writer - INFO - _recall/Edv                                 |     0.755  |     0.632\n2020-08-27 20:15:46,956 - allennlp.training.tensorboard_writer - INFO - _recall/Elektriker                          |     0.923  |     0.892\n2020-08-27 20:15:46,956 - allennlp.training.tensorboard_writer - INFO - _recall/Elektrotechnik                      |     0.877  |     0.926\n2020-08-27 20:15:46,957 - allennlp.training.tensorboard_writer - INFO - _recall/Friseure                            |     0.938  |     0.929\n2020-08-27 20:15:46,960 - allennlp.training.tensorboard_writer - INFO - _recall/Gebrauchtwagen                      |     0.855  |     0.890\n2020-08-27 20:15:46,960 - allennlp.training.tensorboard_writer - INFO - _recall/Handelsvermittler_Und_-vertreter    |     0.624  |     0.800\n2020-08-27 20:15:46,961 - allennlp.training.tensorboard_writer - INFO - _recall/Hotels                              |     0.719  |     0.739\n2020-08-27 20:15:46,962 - allennlp.training.tensorboard_writer - INFO - _recall/Maler                               |     0.952  |     0.976\n2020-08-27 20:15:46,963 - allennlp.training.tensorboard_writer - INFO - _recall/Physiotherapie                      |     0.888  |     0.938\n2020-08-27 20:15:46,963 - allennlp.training.tensorboard_writer - INFO - _recall/Restaurants                         |     0.827  |     0.769\n2020-08-27 20:15:46,964 - allennlp.training.tensorboard_writer - INFO - _recall/Sanitärinstallationen               |     0.864  |     0.882\n2020-08-27 20:15:46,966 - allennlp.training.tensorboard_writer - INFO - _recall/Tiefbau                             |     0.927  |     0.933\n2020-08-27 20:15:46,966 - allennlp.training.tensorboard_writer - INFO - _recall/Unternehmensberatungen              |     0.905  |     0.944\n2020-08-27 20:15:46,967 - allennlp.training.tensorboard_writer - INFO - _recall/Vereine                             |     0.953  |     0.933\n2020-08-27 20:15:46,968 - allennlp.training.tensorboard_writer - INFO - _recall/Vermittlungen                       |     0.931  |     0.985\n2020-08-27 20:15:46,968 - allennlp.training.tensorboard_writer - INFO - _recall/Versicherungsvermittler             |     0.933  |     0.952\n2020-08-27 20:15:46,969 - allennlp.training.tensorboard_writer - INFO - _recall/Werbeagenturen                      |     0.782  |     0.779\n2020-08-27 20:15:46,970 - allennlp.training.tensorboard_writer - INFO - accuracy                                    |     0.876  |     0.882\n2020-08-27 20:15:46,970 - allennlp.training.tensorboard_writer - INFO - gpu_0_memory_MB                             |   751.000  |       N/A\n2020-08-27 20:15:46,971 - allennlp.training.tensorboard_writer - INFO - loss                                        |     0.502  |     0.475\n2020-08-27 20:15:46,973 - allennlp.training.tensorboard_writer - INFO - macro/fscore                                |     0.871  |     0.879\n2020-08-27 20:15:46,973 - allennlp.training.tensorboard_writer - INFO - macro/precision                             |     0.882  |     0.894\n2020-08-27 20:15:46,974 - allennlp.training.tensorboard_writer - INFO - macro/recall                                |     0.864  |     0.874\n2020-08-27 20:15:46,975 - allennlp.training.tensorboard_writer - INFO - micro/fscore                                |     0.876  |     0.882\n2020-08-27 20:15:46,976 - allennlp.training.tensorboard_writer - INFO - micro/precision                             |     0.876  |     0.882\n2020-08-27 20:15:46,978 - allennlp.training.tensorboard_writer - INFO - micro/recall                                |     0.876  |     0.882\n2020-08-27 20:15:46,979 - allennlp.training.tensorboard_writer - INFO - reg_loss                                    |     0.000  |     0.000\n2020-08-27 20:15:46,980 - allennlp.training.tensorboard_writer - INFO - worker_0_memory_MB                          |  4415.612  |       N/A\n2020-08-27 20:15:46,985 - allennlp.training.checkpointer - INFO - Best validation performance so far. Copying weights to 'output/best.th'.\n2020-08-27 20:15:46,996 - allennlp.training.trainer - INFO - Epoch duration: 0:00:10.113945\n2020-08-27 20:15:46,996 - allennlp.training.trainer - INFO - Estimated training time remaining: 0:00:10\n2020-08-27 20:15:46,997 - allennlp.training.trainer - INFO - Epoch 2/2\n2020-08-27 20:15:46,997 - allennlp.training.trainer - INFO - Worker 0 memory usage MB: 4416.76\n\n\n\n\n\n2020-08-27 20:15:47,125 - allennlp.training.trainer - INFO - GPU 0 memory usage MB: 751\n2020-08-27 20:15:47,126 - allennlp.training.trainer - INFO - Training\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=500.0), HTML(value='')))\n\n\n2020-08-27 20:15:55,421 - allennlp.training.trainer - INFO - Validating\n\n\n\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=125.0), HTML(value='')))\n\n\n2020-08-27 20:15:56,743 - allennlp.training.tensorboard_writer - INFO -                                                 Training |  Validation\n2020-08-27 20:15:56,744 - allennlp.training.tensorboard_writer - INFO - _fscore/Allgemeinärzte                      |     0.965  |     0.955\n2020-08-27 20:15:56,745 - allennlp.training.tensorboard_writer - INFO - _fscore/Apotheken                           |     0.866  |     0.839\n2020-08-27 20:15:56,746 - allennlp.training.tensorboard_writer - INFO - _fscore/Architekturbüros                    |     0.971  |     0.986\n2020-08-27 20:15:56,747 - allennlp.training.tensorboard_writer - INFO - _fscore/Autowerkstätten                     |     0.843  |     0.810\n2020-08-27 20:15:56,748 - allennlp.training.tensorboard_writer - INFO - _fscore/Dienstleistungen                    |     0.892  |     0.869\n2020-08-27 20:15:56,750 - allennlp.training.tensorboard_writer - INFO - _fscore/Edv                                 |     0.877  |     0.777\n2020-08-27 20:15:56,751 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektriker                          |     0.947  |     0.957\n2020-08-27 20:15:56,752 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektrotechnik                      |     0.926  |     0.948\n2020-08-27 20:15:56,752 - allennlp.training.tensorboard_writer - INFO - _fscore/Friseure                            |     0.936  |     0.945\n2020-08-27 20:15:56,753 - allennlp.training.tensorboard_writer - INFO - _fscore/Gebrauchtwagen                      |     0.892  |     0.905\n2020-08-27 20:15:56,755 - allennlp.training.tensorboard_writer - INFO - _fscore/Handelsvermittler_Und_-vertreter    |     0.746  |     0.750\n2020-08-27 20:15:56,755 - allennlp.training.tensorboard_writer - INFO - _fscore/Hotels                              |     0.814  |     0.825\n2020-08-27 20:15:56,756 - allennlp.training.tensorboard_writer - INFO - _fscore/Maler                               |     0.957  |     0.970\n2020-08-27 20:15:56,757 - allennlp.training.tensorboard_writer - INFO - _fscore/Physiotherapie                      |     0.943  |     0.969\n2020-08-27 20:15:56,758 - allennlp.training.tensorboard_writer - INFO - _fscore/Restaurants                         |     0.735  |     0.771\n2020-08-27 20:15:56,759 - allennlp.training.tensorboard_writer - INFO - _fscore/Sanitärinstallationen               |     0.909  |     0.930\n2020-08-27 20:15:56,760 - allennlp.training.tensorboard_writer - INFO - _fscore/Tiefbau                             |     0.966  |     0.958\n2020-08-27 20:15:56,761 - allennlp.training.tensorboard_writer - INFO - _fscore/Unternehmensberatungen              |     0.924  |     0.895\n2020-08-27 20:15:56,762 - allennlp.training.tensorboard_writer - INFO - _fscore/Vereine                             |     0.974  |     0.970\n2020-08-27 20:15:56,763 - allennlp.training.tensorboard_writer - INFO - _fscore/Vermittlungen                       |     0.969  |     0.971\n2020-08-27 20:15:56,764 - allennlp.training.tensorboard_writer - INFO - _fscore/Versicherungsvermittler             |     0.959  |     0.966\n2020-08-27 20:15:56,765 - allennlp.training.tensorboard_writer - INFO - _fscore/Werbeagenturen                      |     0.902  |     0.840\n2020-08-27 20:15:56,766 - allennlp.training.tensorboard_writer - INFO - _precision/Allgemeinärzte                   |     0.976  |     1.000\n2020-08-27 20:15:56,768 - allennlp.training.tensorboard_writer - INFO - _precision/Apotheken                        |     0.925  |     0.855\n2020-08-27 20:15:56,769 - allennlp.training.tensorboard_writer - INFO - _precision/Architekturbüros                 |     0.980  |     1.000\n2020-08-27 20:15:56,770 - allennlp.training.tensorboard_writer - INFO - _precision/Autowerkstätten                  |     0.841  |     0.895\n2020-08-27 20:15:56,771 - allennlp.training.tensorboard_writer - INFO - _precision/Dienstleistungen                 |     0.888  |     0.811\n2020-08-27 20:15:56,771 - allennlp.training.tensorboard_writer - INFO - _precision/Edv                              |     0.927  |     0.984\n2020-08-27 20:15:56,772 - allennlp.training.tensorboard_writer - INFO - _precision/Elektriker                       |     0.934  |     0.975\n2020-08-27 20:15:56,773 - allennlp.training.tensorboard_writer - INFO - _precision/Elektrotechnik                   |     0.971  |     0.955\n2020-08-27 20:15:56,774 - allennlp.training.tensorboard_writer - INFO - _precision/Friseure                         |     0.924  |     0.919\n2020-08-27 20:15:56,775 - allennlp.training.tensorboard_writer - INFO - _precision/Gebrauchtwagen                   |     0.910  |     0.886\n2020-08-27 20:15:56,776 - allennlp.training.tensorboard_writer - INFO - _precision/Handelsvermittler_Und_-vertreter |     0.744  |     0.671\n2020-08-27 20:15:56,777 - allennlp.training.tensorboard_writer - INFO - _precision/Hotels                           |     0.888  |     0.912\n2020-08-27 20:15:56,778 - allennlp.training.tensorboard_writer - INFO - _precision/Maler                            |     0.944  |     0.964\n2020-08-27 20:15:56,779 - allennlp.training.tensorboard_writer - INFO - _precision/Physiotherapie                   |     0.932  |     0.952\n2020-08-27 20:15:56,780 - allennlp.training.tensorboard_writer - INFO - _precision/Restaurants                      |     0.637  |     0.737\n2020-08-27 20:15:56,780 - allennlp.training.tensorboard_writer - INFO - _precision/Sanitärinstallationen            |     0.921  |     0.926\n2020-08-27 20:15:56,781 - allennlp.training.tensorboard_writer - INFO - _precision/Tiefbau                          |     0.974  |     0.958\n2020-08-27 20:15:56,782 - allennlp.training.tensorboard_writer - INFO - _precision/Unternehmensberatungen           |     0.913  |     0.840\n2020-08-27 20:15:56,783 - allennlp.training.tensorboard_writer - INFO - _precision/Vereine                          |     0.984  |     1.000\n2020-08-27 20:15:56,784 - allennlp.training.tensorboard_writer - INFO - _precision/Vermittlungen                    |     0.981  |     0.957\n2020-08-27 20:15:56,785 - allennlp.training.tensorboard_writer - INFO - _precision/Versicherungsvermittler          |     0.961  |     0.971\n2020-08-27 20:15:56,786 - allennlp.training.tensorboard_writer - INFO - _precision/Werbeagenturen                   |     0.944  |     0.873\n2020-08-27 20:15:56,786 - allennlp.training.tensorboard_writer - INFO - _recall/Allgemeinärzte                      |     0.954  |     0.914\n2020-08-27 20:15:56,787 - allennlp.training.tensorboard_writer - INFO - _recall/Apotheken                           |     0.813  |     0.825\n2020-08-27 20:15:56,788 - allennlp.training.tensorboard_writer - INFO - _recall/Architekturbüros                    |     0.962  |     0.972\n2020-08-27 20:15:56,790 - allennlp.training.tensorboard_writer - INFO - _recall/Autowerkstätten                     |     0.844  |     0.739\n2020-08-27 20:15:56,791 - allennlp.training.tensorboard_writer - INFO - _recall/Dienstleistungen                    |     0.897  |     0.936\n2020-08-27 20:15:56,794 - allennlp.training.tensorboard_writer - INFO - _recall/Edv                                 |     0.833  |     0.642\n2020-08-27 20:15:56,796 - allennlp.training.tensorboard_writer - INFO - _recall/Elektriker                          |     0.960  |     0.940\n2020-08-27 20:15:56,796 - allennlp.training.tensorboard_writer - INFO - _recall/Elektrotechnik                      |     0.885  |     0.941\n2020-08-27 20:15:56,798 - allennlp.training.tensorboard_writer - INFO - _recall/Friseure                            |     0.949  |     0.972\n2020-08-27 20:15:56,798 - allennlp.training.tensorboard_writer - INFO - _recall/Gebrauchtwagen                      |     0.875  |     0.924\n2020-08-27 20:15:56,800 - allennlp.training.tensorboard_writer - INFO - _recall/Handelsvermittler_Und_-vertreter    |     0.748  |     0.850\n2020-08-27 20:15:56,801 - allennlp.training.tensorboard_writer - INFO - _recall/Hotels                              |     0.752  |     0.754\n2020-08-27 20:15:56,802 - allennlp.training.tensorboard_writer - INFO - _recall/Maler                               |     0.970  |     0.976\n2020-08-27 20:15:56,803 - allennlp.training.tensorboard_writer - INFO - _recall/Physiotherapie                      |     0.955  |     0.988\n2020-08-27 20:15:56,804 - allennlp.training.tensorboard_writer - INFO - _recall/Restaurants                         |     0.870  |     0.808\n2020-08-27 20:15:56,806 - allennlp.training.tensorboard_writer - INFO - _recall/Sanitärinstallationen               |     0.898  |     0.935\n2020-08-27 20:15:56,807 - allennlp.training.tensorboard_writer - INFO - _recall/Tiefbau                             |     0.959  |     0.958\n2020-08-27 20:15:56,808 - allennlp.training.tensorboard_writer - INFO - _recall/Unternehmensberatungen              |     0.935  |     0.958\n2020-08-27 20:15:56,810 - allennlp.training.tensorboard_writer - INFO - _recall/Vereine                             |     0.964  |     0.942\n2020-08-27 20:15:56,811 - allennlp.training.tensorboard_writer - INFO - _recall/Vermittlungen                       |     0.957  |     0.985\n2020-08-27 20:15:56,812 - allennlp.training.tensorboard_writer - INFO - _recall/Versicherungsvermittler             |     0.958  |     0.962\n2020-08-27 20:15:56,813 - allennlp.training.tensorboard_writer - INFO - _recall/Werbeagenturen                      |     0.864  |     0.809\n2020-08-27 20:15:56,814 - allennlp.training.tensorboard_writer - INFO - accuracy                                    |     0.909  |     0.905\n2020-08-27 20:15:56,815 - allennlp.training.tensorboard_writer - INFO - gpu_0_memory_MB                             |   751.000  |       N/A\n2020-08-27 20:15:56,816 - allennlp.training.tensorboard_writer - INFO - loss                                        |     0.343  |     0.392\n2020-08-27 20:15:56,817 - allennlp.training.tensorboard_writer - INFO - macro/fscore                                |     0.905  |     0.900\n2020-08-27 20:15:56,818 - allennlp.training.tensorboard_writer - INFO - macro/precision                             |     0.914  |     0.911\n2020-08-27 20:15:56,819 - allennlp.training.tensorboard_writer - INFO - macro/recall                                |     0.900  |     0.897\n2020-08-27 20:15:56,820 - allennlp.training.tensorboard_writer - INFO - micro/fscore                                |     0.909  |     0.905\n2020-08-27 20:15:56,821 - allennlp.training.tensorboard_writer - INFO - micro/precision                             |     0.909  |     0.905\n2020-08-27 20:15:56,822 - allennlp.training.tensorboard_writer - INFO - micro/recall                                |     0.909  |     0.905\n2020-08-27 20:15:56,823 - allennlp.training.tensorboard_writer - INFO - reg_loss                                    |     0.000  |     0.000\n2020-08-27 20:15:56,824 - allennlp.training.tensorboard_writer - INFO - worker_0_memory_MB                          |  4416.760  |       N/A\n2020-08-27 20:15:56,833 - allennlp.training.checkpointer - INFO - Best validation performance so far. Copying weights to 'output/best.th'.\n2020-08-27 20:15:56,842 - allennlp.training.trainer - INFO - Epoch duration: 0:00:09.845689\n2020-08-27 20:15:56,844 - allennlp.training.checkpointer - INFO - loading best weights\n2020-08-27 20:15:56,847 - allennlp.models.archival - INFO - archiving weights and vocabulary to output/model.tar.gz\n\n\n\n\n\n\n\n\nTrainingResults(model_path='output/model.tar.gz', metrics={'best_epoch': 2, 'peak_worker_0_memory_MB': 4416.76, 'peak_gpu_0_memory_MB': 751, 'training_duration': '0:00:30.869872', 'training_start_epoch': 0, 'training_epochs': 2, 'epoch': 2, 'training_accuracy': 0.908625, 'training_micro/precision': 0.9086250066757202, 'training_micro/recall': 0.9086250066757202, 'training_micro/fscore': 0.908625066280365, 'training_macro/precision': 0.9135987162590027, 'training_macro/recall': 0.8999578356742859, 'training_macro/fscore': 0.9051755666732788, 'training__precision/Unternehmensberatungen': 0.9134466648101807, 'training__precision/Friseure': 0.9240068793296814, 'training__precision/Tiefbau': 0.9739999771118164, 'training__precision/Dienstleistungen': 0.8877952694892883, 'training__precision/Gebrauchtwagen': 0.9097222089767456, 'training__precision/Elektriker': 0.9343891143798828, 'training__precision/Restaurants': 0.6371527910232544, 'training__precision/Architekturbüros': 0.980440080165863, 'training__precision/Vereine': 0.9840425252914429, 'training__precision/Versicherungsvermittler': 0.9607843160629272, 'training__precision/Maler': 0.9439527988433838, 'training__precision/Sanitärinstallationen': 0.920634925365448, 'training__precision/Edv': 0.9265734553337097, 'training__precision/Werbeagenturen': 0.9442379474639893, 'training__precision/Apotheken': 0.9251968264579773, 'training__precision/Physiotherapie': 0.9317406415939331, 'training__precision/Vermittlungen': 0.9814814925193787, 'training__precision/Hotels': 0.8879310488700867, 'training__precision/Autowerkstätten': 0.8409090638160706, 'training__precision/Elektrotechnik': 0.970588207244873, 'training__precision/Allgemeinärzte': 0.9763033390045166, 'training__precision/Handelsvermittler_Und_-vertreter': 0.743842363357544, 'training__recall/Unternehmensberatungen': 0.9351266026496887, 'training__recall/Friseure': 0.9485815763473511, 'training__recall/Tiefbau': 0.9586614370346069, 'training__recall/Dienstleistungen': 0.8966202735900879, 'training__recall/Gebrauchtwagen': 0.8752784132957458, 'training__recall/Elektriker': 0.960465133190155, 'training__recall/Restaurants': 0.8696682453155518, 'training__recall/Architekturbüros': 0.9616307020187378, 'training__recall/Vereine': 0.9635416865348816, 'training__recall/Versicherungsvermittler': 0.9581005573272705, 'training__recall/Maler': 0.9696969985961914, 'training__recall/Sanitärinstallationen': 0.8978328108787537, 'training__recall/Edv': 0.8333333134651184, 'training__recall/Werbeagenturen': 0.8639456033706665, 'training__recall/Apotheken': 0.8131487965583801, 'training__recall/Physiotherapie': 0.9545454382896423, 'training__recall/Vermittlungen': 0.9566786885261536, 'training__recall/Hotels': 0.7518247961997986, 'training__recall/Autowerkstätten': 0.8441064357757568, 'training__recall/Elektrotechnik': 0.8850574493408203, 'training__recall/Allgemeinärzte': 0.9537037014961243, 'training__recall/Handelsvermittler_Und_-vertreter': 0.7475247383117676, 'training__fscore/Unternehmensberatungen': 0.9241595268249512, 'training__fscore/Friseure': 0.9361330270767212, 'training__fscore/Tiefbau': 0.966269850730896, 'training__fscore/Dienstleistungen': 0.8921859860420227, 'training__fscore/Gebrauchtwagen': 0.8921680450439453, 'training__fscore/Elektriker': 0.9472476840019226, 'training__fscore/Restaurants': 0.7354709506034851, 'training__fscore/Architekturbüros': 0.970944344997406, 'training__fscore/Vereine': 0.9736842513084412, 'training__fscore/Versicherungsvermittler': 0.9594405889511108, 'training__fscore/Maler': 0.9566516876220703, 'training__fscore/Sanitärinstallationen': 0.9090908765792847, 'training__fscore/Edv': 0.8774834871292114, 'training__fscore/Werbeagenturen': 0.9023090600967407, 'training__fscore/Apotheken': 0.8655616641044617, 'training__fscore/Physiotherapie': 0.9430052638053894, 'training__fscore/Vermittlungen': 0.9689213633537292, 'training__fscore/Hotels': 0.8142292499542236, 'training__fscore/Autowerkstätten': 0.8425047397613525, 'training__fscore/Elektrotechnik': 0.9258516430854797, 'training__fscore/Allgemeinärzte': 0.9648712277412415, 'training__fscore/Handelsvermittler_Und_-vertreter': 0.7456790208816528, 'training_loss': 0.3431624993979931, 'training_reg_loss': 0.0, 'training_worker_0_memory_MB': 4416.76, 'training_gpu_0_memory_MB': 751, 'validation_accuracy': 0.9055, 'validation_micro/precision': 0.9054999947547913, 'validation_micro/recall': 0.9054999947547913, 'validation_micro/fscore': 0.9054999947547913, 'validation_macro/precision': 0.9109704494476318, 'validation_macro/recall': 0.8967336416244507, 'validation_macro/fscore': 0.9003081321716309, 'validation__precision/Unternehmensberatungen': 0.8404908180236816, 'validation__precision/Friseure': 0.9194630980491638, 'validation__precision/Tiefbau': 0.9579831957817078, 'validation__precision/Dienstleistungen': 0.8110235929489136, 'validation__precision/Gebrauchtwagen': 0.8861788511276245, 'validation__precision/Elektriker': 0.9750000238418579, 'validation__precision/Restaurants': 0.7368420958518982, 'validation__precision/Architekturbüros': 1.0, 'validation__precision/Vereine': 1.0, 'validation__precision/Versicherungsvermittler': 0.9708737730979919, 'validation__precision/Maler': 0.9642857313156128, 'validation__precision/Sanitärinstallationen': 0.9255319237709045, 'validation__precision/Edv': 0.9838709831237793, 'validation__precision/Werbeagenturen': 0.8730158805847168, 'validation__precision/Apotheken': 0.8545454740524292, 'validation__precision/Physiotherapie': 0.9518072009086609, 'validation__precision/Vermittlungen': 0.9571428298950195, 'validation__precision/Hotels': 0.9122806787490845, 'validation__precision/Autowerkstätten': 0.8947368264198303, 'validation__precision/Elektrotechnik': 0.9552238583564758, 'validation__precision/Allgemeinärzte': 1.0, 'validation__precision/Handelsvermittler_Und_-vertreter': 0.6710526347160339, 'validation__recall/Unternehmensberatungen': 0.9580419659614563, 'validation__recall/Friseure': 0.9716312289237976, 'validation__recall/Tiefbau': 0.9579831957817078, 'validation__recall/Dienstleistungen': 0.9363636374473572, 'validation__recall/Gebrauchtwagen': 0.9237288236618042, 'validation__recall/Elektriker': 0.9397590160369873, 'validation__recall/Restaurants': 0.807692289352417, 'validation__recall/Architekturbüros': 0.9716981053352356, 'validation__recall/Vereine': 0.942307710647583, 'validation__recall/Versicherungsvermittler': 0.9615384340286255, 'validation__recall/Maler': 0.9759036302566528, 'validation__recall/Sanitärinstallationen': 0.9354838728904724, 'validation__recall/Edv': 0.6421052813529968, 'validation__recall/Werbeagenturen': 0.8088235259056091, 'validation__recall/Apotheken': 0.8245614171028137, 'validation__recall/Physiotherapie': 0.987500011920929, 'validation__recall/Vermittlungen': 0.9852941036224365, 'validation__recall/Hotels': 0.7536231875419617, 'validation__recall/Autowerkstätten': 0.739130437374115, 'validation__recall/Elektrotechnik': 0.9411764740943909, 'validation__recall/Allgemeinärzte': 0.9137930870056152, 'validation__recall/Handelsvermittler_Und_-vertreter': 0.8500000238418579, 'validation__fscore/Unternehmensberatungen': 0.8954249024391174, 'validation__fscore/Friseure': 0.9448275566101074, 'validation__fscore/Tiefbau': 0.9579831957817078, 'validation__fscore/Dienstleistungen': 0.8691983222961426, 'validation__fscore/Gebrauchtwagen': 0.9045643210411072, 'validation__fscore/Elektriker': 0.9570552110671997, 'validation__fscore/Restaurants': 0.7706422209739685, 'validation__fscore/Architekturbüros': 0.9856459498405457, 'validation__fscore/Vereine': 0.9702970385551453, 'validation__fscore/Versicherungsvermittler': 0.966183602809906, 'validation__fscore/Maler': 0.970059871673584, 'validation__fscore/Sanitärinstallationen': 0.9304812550544739, 'validation__fscore/Edv': 0.7770700454711914, 'validation__fscore/Werbeagenturen': 0.839694619178772, 'validation__fscore/Apotheken': 0.8392857313156128, 'validation__fscore/Physiotherapie': 0.9693251848220825, 'validation__fscore/Vermittlungen': 0.9710144996643066, 'validation__fscore/Hotels': 0.8253968358039856, 'validation__fscore/Autowerkstätten': 0.8095238208770752, 'validation__fscore/Elektrotechnik': 0.9481481313705444, 'validation__fscore/Allgemeinärzte': 0.9549549221992493, 'validation__fscore/Handelsvermittler_Und_-vertreter': 0.7500000596046448, 'validation_loss': 0.39211804735660555, 'validation_reg_loss': 0.0, 'best_validation_accuracy': 0.9055, 'best_validation_micro/precision': 0.9054999947547913, 'best_validation_micro/recall': 0.9054999947547913, 'best_validation_micro/fscore': 0.9054999947547913, 'best_validation_macro/precision': 0.9109704494476318, 'best_validation_macro/recall': 0.8967336416244507, 'best_validation_macro/fscore': 0.9003081321716309, 'best_validation__precision/Unternehmensberatungen': 0.8404908180236816, 'best_validation__precision/Friseure': 0.9194630980491638, 'best_validation__precision/Tiefbau': 0.9579831957817078, 'best_validation__precision/Dienstleistungen': 0.8110235929489136, 'best_validation__precision/Gebrauchtwagen': 0.8861788511276245, 'best_validation__precision/Elektriker': 0.9750000238418579, 'best_validation__precision/Restaurants': 0.7368420958518982, 'best_validation__precision/Architekturbüros': 1.0, 'best_validation__precision/Vereine': 1.0, 'best_validation__precision/Versicherungsvermittler': 0.9708737730979919, 'best_validation__precision/Maler': 0.9642857313156128, 'best_validation__precision/Sanitärinstallationen': 0.9255319237709045, 'best_validation__precision/Edv': 0.9838709831237793, 'best_validation__precision/Werbeagenturen': 0.8730158805847168, 'best_validation__precision/Apotheken': 0.8545454740524292, 'best_validation__precision/Physiotherapie': 0.9518072009086609, 'best_validation__precision/Vermittlungen': 0.9571428298950195, 'best_validation__precision/Hotels': 0.9122806787490845, 'best_validation__precision/Autowerkstätten': 0.8947368264198303, 'best_validation__precision/Elektrotechnik': 0.9552238583564758, 'best_validation__precision/Allgemeinärzte': 1.0, 'best_validation__precision/Handelsvermittler_Und_-vertreter': 0.6710526347160339, 'best_validation__recall/Unternehmensberatungen': 0.9580419659614563, 'best_validation__recall/Friseure': 0.9716312289237976, 'best_validation__recall/Tiefbau': 0.9579831957817078, 'best_validation__recall/Dienstleistungen': 0.9363636374473572, 'best_validation__recall/Gebrauchtwagen': 0.9237288236618042, 'best_validation__recall/Elektriker': 0.9397590160369873, 'best_validation__recall/Restaurants': 0.807692289352417, 'best_validation__recall/Architekturbüros': 0.9716981053352356, 'best_validation__recall/Vereine': 0.942307710647583, 'best_validation__recall/Versicherungsvermittler': 0.9615384340286255, 'best_validation__recall/Maler': 0.9759036302566528, 'best_validation__recall/Sanitärinstallationen': 0.9354838728904724, 'best_validation__recall/Edv': 0.6421052813529968, 'best_validation__recall/Werbeagenturen': 0.8088235259056091, 'best_validation__recall/Apotheken': 0.8245614171028137, 'best_validation__recall/Physiotherapie': 0.987500011920929, 'best_validation__recall/Vermittlungen': 0.9852941036224365, 'best_validation__recall/Hotels': 0.7536231875419617, 'best_validation__recall/Autowerkstätten': 0.739130437374115, 'best_validation__recall/Elektrotechnik': 0.9411764740943909, 'best_validation__recall/Allgemeinärzte': 0.9137930870056152, 'best_validation__recall/Handelsvermittler_Und_-vertreter': 0.8500000238418579, 'best_validation__fscore/Unternehmensberatungen': 0.8954249024391174, 'best_validation__fscore/Friseure': 0.9448275566101074, 'best_validation__fscore/Tiefbau': 0.9579831957817078, 'best_validation__fscore/Dienstleistungen': 0.8691983222961426, 'best_validation__fscore/Gebrauchtwagen': 0.9045643210411072, 'best_validation__fscore/Elektriker': 0.9570552110671997, 'best_validation__fscore/Restaurants': 0.7706422209739685, 'best_validation__fscore/Architekturbüros': 0.9856459498405457, 'best_validation__fscore/Vereine': 0.9702970385551453, 'best_validation__fscore/Versicherungsvermittler': 0.966183602809906, 'best_validation__fscore/Maler': 0.970059871673584, 'best_validation__fscore/Sanitärinstallationen': 0.9304812550544739, 'best_validation__fscore/Edv': 0.7770700454711914, 'best_validation__fscore/Werbeagenturen': 0.839694619178772, 'best_validation__fscore/Apotheken': 0.8392857313156128, 'best_validation__fscore/Physiotherapie': 0.9693251848220825, 'best_validation__fscore/Vermittlungen': 0.9710144996643066, 'best_validation__fscore/Hotels': 0.8253968358039856, 'best_validation__fscore/Autowerkstätten': 0.8095238208770752, 'best_validation__fscore/Elektrotechnik': 0.9481481313705444, 'best_validation__fscore/Allgemeinärzte': 0.9549549221992493, 'best_validation__fscore/Handelsvermittler_Und_-vertreter': 0.7500000596046448, 'best_validation_loss': 0.39211804735660555, 'best_validation_reg_loss': 0.0})\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[n._v("\n")])])])])}),[],!1,null,null,null);e.default=t.exports}}]);
