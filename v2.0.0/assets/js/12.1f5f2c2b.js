(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{313:function(e,n,t){e.exports=t.p+"assets/img/text_classifier_explore_screenshot.b068fd60.png"},474:function(e,n,t){"use strict";t.r(n);var a=t(26),r=Object(a.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"training-a-short-text-classifier-of-german-business-names"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#training-a-short-text-classifier-of-german-business-names"}},[e._v("#")]),e._v(" Training a short text classifier of German business names")]),e._v(" "),a("p",[a("a",{attrs:{target:"_blank",href:"https://www.recogn.ai/biome-text/documentation/tutorials/Training_a_text_classifier.html"}},[a("img",{staticClass:"icon",attrs:{src:"https://www.recogn.ai/biome-text/assets/img/biome-isotype.svg",width:"24"}})]),e._v(" "),a("a",{attrs:{href:"https://www.recogn.ai/biome-text/documentation/tutorials/Training_a_text_classifier.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("View on recogn.ai"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{target:"_blank",href:"https://colab.research.google.com/github/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Training_a_text_classifier.ipynb"}},[a("img",{staticClass:"icon",attrs:{src:"https://www.tensorflow.org/images/colab_logo_32px.png",width:"24"}})]),e._v(" "),a("a",{attrs:{href:"https://colab.research.google.com/github/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Training_a_text_classifier.ipynb",target:"_blank",rel:"noopener noreferrer"}},[e._v("Run in Google Colab"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{target:"_blank",href:"https://github.com/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Training_a_text_classifier.ipynb"}},[a("img",{staticClass:"icon",attrs:{src:"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",width:"24"}})]),e._v(" "),a("a",{attrs:{href:"https://github.com/recognai/biome-text/blob/master/docs/docs/documentation/tutorials/Training_a_text_classifier.ipynb",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source on GitHub"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("In this tutorial we will train a basic short-text classifier for predicting the sector of a business based only on its business name.\nFor this we will use a training dataset with business names and business categories in German.")]),e._v(" "),a("p",[e._v("When running this tutorial in Google Colab, make sure to install "),a("em",[e._v("biome.text")]),e._v(" first:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("!pip install "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("U git"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+")]),e._v("https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("//")]),e._v("github"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("recognai"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("biome"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("git\n")])])]),a("p",[e._v("Ignore warnings and don't forget to restart your runtime afterwards ("),a("em",[e._v("Runtime -> Restart runtime")]),e._v(").")]),e._v(" "),a("h2",{attrs:{id:"explore-the-training-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#explore-the-training-data"}},[e._v("#")]),e._v(" Explore the training data")]),e._v(" "),a("p",[e._v("Let's take a look at the data we will use for training. For this we create a "),a("code",[e._v("DataSource")]),e._v(" instance providing a path to our data.")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" DataSource\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("train_ds "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://biome-tutorials-data.s3-eu-west-1.amazonaws.com/text_classifier/business.cat.train.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\ntrain_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",[a("style",{attrs:{scoped:""}},[e._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),e._v(" "),a("table",{staticClass:"dataframe",attrs:{border:"1"}},[a("thead",[a("tr",{staticStyle:{"text-align":"right"}},[a("th"),e._v(" "),a("th",[e._v("label")]),e._v(" "),a("th",[e._v("text")]),e._v(" "),a("th",[e._v("path")])])]),e._v(" "),a("tbody",[a("tr",[a("th",[e._v("0")]),e._v(" "),a("td",[e._v("Edv")]),e._v(" "),a("td",[e._v("Cse Gmbh Computer Edv-service Bürobedarf")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("1")]),e._v(" "),a("td",[e._v("Maler")]),e._v(" "),a("td",[e._v("Malerfachbetrieb U. Nee")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("2")]),e._v(" "),a("td",[e._v("Gebrauchtwagen")]),e._v(" "),a("td",[e._v("Sippl Automobilverkäufer Hausmann")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("3")]),e._v(" "),a("td",[e._v("Handelsvermittler Und -vertreter")]),e._v(" "),a("td",[e._v("Strenge Handelsagentur Werth")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("4")]),e._v(" "),a("td",[e._v("Gebrauchtwagen")]),e._v(" "),a("td",[e._v("Dzengel Autohaus Gordemitz Rusch")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("5")]),e._v(" "),a("td",[e._v("Apotheken")]),e._v(" "),a("td",[e._v("Schinkel-apotheke Bitzer")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("6")]),e._v(" "),a("td",[e._v("Tiefbau")]),e._v(" "),a("td",[e._v("Franz Möbius Mehrings-bau-hude Und Stigge")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("7")]),e._v(" "),a("td",[e._v("Handelsvermittler Und -vertreter")]),e._v(" "),a("td",[e._v("Kontze Hdl.vertr. Lau")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("8")]),e._v(" "),a("td",[e._v("Autowerkstätten")]),e._v(" "),a("td",[e._v("Keßler Kfz-handel")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])]),e._v(" "),a("tr",[a("th",[e._v("9")]),e._v(" "),a("td",[e._v("Gebrauchtwagen")]),e._v(" "),a("td",[e._v("Diko Lack Und Schrift Betriebsteil Der Autocen...")]),e._v(" "),a("td",[e._v("https://biome-tutorials-data.s3-eu-west-1.amaz...")])])])])]),e._v(" "),a("p",[e._v("As we can see we have two relevant columns "),a("em",[e._v("label")]),e._v(" and "),a("em",[e._v("text")]),e._v(". The "),a("em",[e._v("path")]),e._v(" column is added automatically by the "),a("code",[e._v("DataSource")]),e._v(" class to keep track of the source file.")]),e._v(" "),a("p",[e._v("Our classifier will be trained to predict the "),a("em",[e._v("label")]),e._v(" given a "),a("em",[e._v("text")]),e._v(".")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("DataSource")]),e._v(" class stores the data in an underlying "),a("a",{attrs:{href:"https://docs.dask.org/en/latest/dataframe.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dask DataFrame"),a("OutboundLink")],1),e._v(" that you can easily access.\nFor example, let's check the size of our training data:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("train_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("to_dataframe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("8000\n")])])]),a("p",[e._v("Or let's check the distribution of our labels:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("labels "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" train_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("to_dataframe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("label"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("compute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\nlabels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("value_counts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("Unternehmensberatungen              632\nFriseure                            564\nTiefbau                             508\nDienstleistungen                    503\nGebrauchtwagen                      449\nElektriker                          430\nRestaurants                         422\nArchitekturbüros                    417\nVereine                             384\nVersicherungsvermittler             358\nMaler                               330\nSanitärinstallationen               323\nEdv                                 318\nWerbeagenturen                      294\nApotheken                           289\nPhysiotherapie                      286\nVermittlungen                       277\nHotels                              274\nAutowerkstätten                     263\nElektrotechnik                      261\nAllgemeinärzte                      216\nHandelsvermittler Und -vertreter    202\nName: label, dtype: int64\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("Tip")]),e._v(" "),a("p",[e._v("The "),a("RouterLink",{attrs:{to:"/api/biome/text/modules/heads/task_head.html#taskhead"}},[e._v("TaskHead")]),e._v(" of our model will expect a "),a("em",[e._v("text")]),e._v(" and a "),a("em",[e._v("label")]),e._v(" column to be present in the dataframe.\nSince they are already present, there is no need for a "),a("RouterLink",{attrs:{to:"/api/biome/text/data/datasource.html#datasource"}},[e._v("mapping")]),e._v(" in the "),a("code",[e._v("DataSource")]),e._v(".")],1)]),e._v(" "),a("h2",{attrs:{id:"configure-your-biome-text-pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-biome-text-pipeline"}},[e._v("#")]),e._v(" Configure your "),a("em",[e._v("biome.text")]),e._v(" Pipeline")]),e._v(" "),a("p",[e._v("A typical "),a("RouterLink",{attrs:{to:"/api/biome/text/pipeline.html#pipeline"}},[e._v("Pipeline")]),e._v(" consists of tokenizing the input, extracting features, applying a language encoding (optionally) and executing a task-specific head in the end.")],1),e._v(" "),a("p",[e._v("After training a pipeline, you can use it to make predictions or explore the underlying model via the "),a("RouterLink",{attrs:{to:"/documentation/user-guides/02.explore.html"}},[e._v("explore UI")]),e._v(".")],1),e._v(" "),a("p",[e._v("As a first step we must define a configuration for our pipeline.\nIn this tutorial we will create a configuration dictionary and use the "),a("code",[e._v("Pipeline.from_config()")]),e._v(" method to create our pipeline, but there are "),a("RouterLink",{attrs:{to:"/api/biome/text/pipeline.html#pipeline"}},[e._v("other ways")]),e._v(".")],1),e._v(" "),a("p",[e._v("A "),a("em",[e._v("biome.text")]),e._v(" pipeline has the following main components:")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# a descriptive name of your pipeline")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("tokenizer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# how to tokenize the input")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("features")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# input features of the model")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("encoder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# the language encoder")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# your task configuration")]),e._v("\n\n")])])]),a("p",[e._v("See the "),a("RouterLink",{attrs:{to:"/documentation/user-guides/05.configuration.html"}},[e._v("Configuration section")]),e._v(" for a detailed description of how these main components can be configured.")],1),e._v(" "),a("p",[e._v("Our complete configuration for this tutorial will be following:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("pipeline_dict "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"german_business_names"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"tokenizer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"text_cleaning"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rules"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"strip_spaces"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"features"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"word"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"embedding_dim"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lowercase_tokens"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"char"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"embedding_dim"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lowercase_characters"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"encoder"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"gru"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"num_layers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hidden_size"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"bidirectional"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"dropout"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"head"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"TextClassification"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"labels"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("labels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("value_counts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"pooler"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"gru"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"num_layers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hidden_size"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"bidirectional"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"feedforward"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"num_layers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hidden_dims"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"activations"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"relu"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"dropout"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("       \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("With this dictionary we can now create a "),a("code",[e._v("Pipeline")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" Pipeline\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("pl "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Pipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("from_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("pipeline_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("h2",{attrs:{id:"create-a-vocabulary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-vocabulary"}},[e._v("#")]),e._v(" Create a vocabulary")]),e._v(" "),a("p",[e._v("Before we can start the training we need to create the vocabulary for our model.\nFor this we define a "),a("code",[e._v("VocabularyConfiguration")]),e._v(".")]),e._v(" "),a("p",[e._v('In our business name classifier we only want to include words with a general meaning to our word feature vocabulary (like "Computer" or "Autohaus", for example), and want to exclude specific names that will not help to generally classify the kind of business.\nThis can be achieved by including only the most frequent words in our training set via the '),a("code",[e._v("min_count")]),e._v(" argument. For a complete list of available arguments see the "),a("RouterLink",{attrs:{to:"/api/biome/text/configuration.html#vocabularyconfiguration"}},[e._v("VocabularyConfiguration API")]),e._v(".")],1),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("configuration "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" VocabularyConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" WordFeatures\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("vocab_config "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" VocabularyConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("sources"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("train_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" min_count"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("WordFeatures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("namespace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("We then pass this configuration to our "),a("code",[e._v("Pipeline")]),e._v(" to create the vocabulary:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("create_vocabulary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("vocab_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("HBox(children=(FloatProgress(value=1.0, bar_style='info', description='building vocab', max=1.0, style=Progres…\n")])])]),a("p",[e._v("After creating the vocabulary we can check the size of our entire model in terms of trainable parameters:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("num_trainable_parameters\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("60566\n")])])]),a("h2",{attrs:{id:"configure-the-trainer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-the-trainer"}},[e._v("#")]),e._v(" Configure the trainer")]),e._v(" "),a("p",[e._v("As a next step we have to configure the "),a("em",[e._v("trainer")]),e._v(".")]),e._v(" "),a("p",[e._v("The default trainer has sensible defaults and should work alright for most of your cases.\nIn this tutorial, however, we want to tune a bit the learning rate and limit the training time to three epochs only.\nFor a complete list of available arguments see the "),a("RouterLink",{attrs:{to:"/api/biome/text/configuration.html#trainerconfiguration"}},[e._v("TrainerConfiguration API")]),e._v(".")],1),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("Tip")]),e._v(" "),a("p",[e._v("In case you have a cuda device available, you also specify it here.")])]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("configuration "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" TrainerConfiguration\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("trainer_config "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" TrainerConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n    optimizer"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"adam"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lr"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    num_epochs"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    cuda_device"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("h2",{attrs:{id:"train-your-model"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#train-your-model"}},[e._v("#")]),e._v(" Train your model")]),e._v(" "),a("p",[e._v("Now we have everything ready to start the training of our model:")]),e._v(" "),a("ul",[a("li",[e._v("training data set")]),e._v(" "),a("li",[e._v("vocabulary")]),e._v(" "),a("li",[e._v("trainer")])]),e._v(" "),a("p",[e._v("Optionally we can provide a validation data set to estimate the generalization error.\nFor this we will create another "),a("code",[e._v("DataSource")]),e._v(" pointing to our validation data.")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" DataSource\nvalid_ds "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://biome-tutorials-data.s3-eu-west-1.amazonaws.com/text_classifier/business.cat.valid.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("The training output will be saved in a folder specified by the "),a("code",[e._v("output")]),e._v(" argument. It contains the trained model weights and the metrics, as well as the vocabulary and a "),a("em",[e._v("log")]),e._v(" folder for visualizing the training process with "),a("a",{attrs:{href:"https://www.tensorflow.org/tensorboard/",target:"_blank",rel:"noopener noreferrer"}},[e._v("tensorboard"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("train"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n    output"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"output"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    training"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("train_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    validation"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("valid_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    trainer"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("trainer_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("2020-10-02 19:10:36,802 - allennlp.common.params - INFO - config = <biome.text.configuration.PipelineConfiguration object at 0x7ff12f78bad0>\n2020-10-02 19:10:37,181 - allennlp.common.params - INFO - type = default\n2020-10-02 19:10:37,182 - allennlp.common.params - INFO - rules = ['strip_spaces']\n2020-10-02 19:10:37,182 - allennlp.common.params - INFO - type = single_id\n2020-10-02 19:10:37,183 - allennlp.common.params - INFO - namespace = word\n2020-10-02 19:10:37,184 - allennlp.common.params - INFO - lowercase_tokens = True\n2020-10-02 19:10:37,184 - allennlp.common.params - INFO - start_tokens = None\n2020-10-02 19:10:37,185 - allennlp.common.params - INFO - end_tokens = None\n2020-10-02 19:10:37,186 - allennlp.common.params - INFO - feature_name = text\n2020-10-02 19:10:37,186 - allennlp.common.params - INFO - default_value = THIS IS A REALLY UNLIKELY VALUE THAT HAS TO BE A STRING\n2020-10-02 19:10:37,187 - allennlp.common.params - INFO - token_min_padding_length = 0\n2020-10-02 19:10:37,188 - allennlp.common.params - INFO - type = characters\n2020-10-02 19:10:37,188 - allennlp.common.params - INFO - namespace = char\n2020-10-02 19:10:37,189 - allennlp.common.params - INFO - character_tokenizer.byte_encoding = None\n2020-10-02 19:10:37,190 - allennlp.common.params - INFO - character_tokenizer.lowercase_characters = True\n2020-10-02 19:10:37,191 - allennlp.common.params - INFO - character_tokenizer.start_tokens = None\n2020-10-02 19:10:37,191 - allennlp.common.params - INFO - character_tokenizer.end_tokens = None\n2020-10-02 19:10:37,192 - allennlp.common.params - INFO - start_tokens = None\n2020-10-02 19:10:37,192 - allennlp.common.params - INFO - end_tokens = None\n2020-10-02 19:10:37,193 - allennlp.common.params - INFO - min_padding_length = 0\n2020-10-02 19:10:37,194 - allennlp.common.params - INFO - token_min_padding_length = 0\n2020-10-02 19:10:37,195 - allennlp.common.params - INFO - type = basic\n2020-10-02 19:10:37,196 - allennlp.common.params - INFO - token_embedders.word.type = embedding\n2020-10-02 19:10:37,197 - allennlp.common.params - INFO - token_embedders.word.embedding_dim = 64\n2020-10-02 19:10:37,198 - allennlp.common.params - INFO - token_embedders.word.num_embeddings = None\n2020-10-02 19:10:37,198 - allennlp.common.params - INFO - token_embedders.word.projection_dim = None\n2020-10-02 19:10:37,200 - allennlp.common.params - INFO - token_embedders.word.weight = None\n2020-10-02 19:10:37,200 - allennlp.common.params - INFO - token_embedders.word.padding_index = None\n2020-10-02 19:10:37,201 - allennlp.common.params - INFO - token_embedders.word.trainable = True\n2020-10-02 19:10:37,202 - allennlp.common.params - INFO - token_embedders.word.max_norm = None\n2020-10-02 19:10:37,202 - allennlp.common.params - INFO - token_embedders.word.norm_type = 2.0\n2020-10-02 19:10:37,203 - allennlp.common.params - INFO - token_embedders.word.scale_grad_by_freq = False\n2020-10-02 19:10:37,204 - allennlp.common.params - INFO - token_embedders.word.sparse = False\n2020-10-02 19:10:37,205 - allennlp.common.params - INFO - token_embedders.word.vocab_namespace = word\n2020-10-02 19:10:37,205 - allennlp.common.params - INFO - token_embedders.word.pretrained_file = None\n2020-10-02 19:10:37,207 - allennlp.common.params - INFO - token_embedders.char.type = character_encoding\n2020-10-02 19:10:37,208 - allennlp.common.params - INFO - token_embedders.char.embedding.embedding_dim = 32\n2020-10-02 19:10:37,209 - allennlp.common.params - INFO - token_embedders.char.embedding.num_embeddings = None\n2020-10-02 19:10:37,209 - allennlp.common.params - INFO - token_embedders.char.embedding.projection_dim = None\n2020-10-02 19:10:37,210 - allennlp.common.params - INFO - token_embedders.char.embedding.weight = None\n2020-10-02 19:10:37,211 - allennlp.common.params - INFO - token_embedders.char.embedding.padding_index = None\n2020-10-02 19:10:37,211 - allennlp.common.params - INFO - token_embedders.char.embedding.trainable = True\n2020-10-02 19:10:37,212 - allennlp.common.params - INFO - token_embedders.char.embedding.max_norm = None\n2020-10-02 19:10:37,213 - allennlp.common.params - INFO - token_embedders.char.embedding.norm_type = 2.0\n2020-10-02 19:10:37,214 - allennlp.common.params - INFO - token_embedders.char.embedding.scale_grad_by_freq = False\n2020-10-02 19:10:37,214 - allennlp.common.params - INFO - token_embedders.char.embedding.sparse = False\n2020-10-02 19:10:37,215 - allennlp.common.params - INFO - token_embedders.char.embedding.vocab_namespace = char\n2020-10-02 19:10:37,216 - allennlp.common.params - INFO - token_embedders.char.embedding.pretrained_file = None\n2020-10-02 19:10:37,217 - allennlp.common.params - INFO - token_embedders.char.encoder.type = allennlp.modules.seq2vec_encoders.pytorch_seq2vec_wrapper.GruSeq2VecEncoder\n2020-10-02 19:10:37,218 - allennlp.common.params - INFO - token_embedders.char.encoder.input_size = 32\n2020-10-02 19:10:37,218 - allennlp.common.params - INFO - token_embedders.char.encoder.hidden_size = 32\n2020-10-02 19:10:37,219 - allennlp.common.params - INFO - token_embedders.char.encoder.num_layers = 1\n2020-10-02 19:10:37,220 - allennlp.common.params - INFO - token_embedders.char.encoder.bias = True\n2020-10-02 19:10:37,221 - allennlp.common.params - INFO - token_embedders.char.encoder.dropout = 0.0\n2020-10-02 19:10:37,221 - allennlp.common.params - INFO - token_embedders.char.encoder.bidirectional = True\n2020-10-02 19:10:37,223 - allennlp.common.params - INFO - token_embedders.char.dropout = 0.1\n2020-10-02 19:10:37,224 - allennlp.common.params - INFO - labels = ['Unternehmensberatungen', 'Friseure', 'Tiefbau', 'Dienstleistungen', 'Gebrauchtwagen', 'Elektriker', 'Restaurants', 'Architekturbüros', 'Vereine', 'Versicherungsvermittler', 'Maler', 'Sanitärinstallationen', 'Edv', 'Werbeagenturen', 'Apotheken', 'Physiotherapie', 'Vermittlungen', 'Hotels', 'Autowerkstätten', 'Elektrotechnik', 'Allgemeinärzte', 'Handelsvermittler Und -vertreter']\n2020-10-02 19:10:37,224 - allennlp.common.params - INFO - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.\n2020-10-02 19:10:37,225 - allennlp.common.params - INFO - CURRENTLY DEFINED PARAMETERS: \n2020-10-02 19:10:37,226 - allennlp.common.params - INFO - pooler.type = gru\n2020-10-02 19:10:37,227 - allennlp.common.params - INFO - pooler.num_layers = 1\n2020-10-02 19:10:37,227 - allennlp.common.params - INFO - pooler.hidden_size = 32\n2020-10-02 19:10:37,228 - allennlp.common.params - INFO - pooler.bidirectional = True\n2020-10-02 19:10:37,229 - allennlp.common.params - INFO - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.\n2020-10-02 19:10:37,230 - allennlp.common.params - INFO - CURRENTLY DEFINED PARAMETERS: \n2020-10-02 19:10:37,230 - allennlp.common.params - INFO - feedforward.num_layers = 1\n2020-10-02 19:10:37,231 - allennlp.common.params - INFO - feedforward.hidden_dims = [32]\n2020-10-02 19:10:37,232 - allennlp.common.params - INFO - feedforward.activations = ['relu']\n2020-10-02 19:10:37,233 - allennlp.common.params - INFO - feedforward.dropout = [0.0]\n2020-10-02 19:10:37,233 - allennlp.common.params - INFO - multilabel = False\n2020-10-02 19:10:37,234 - allennlp.common.params - INFO - input_size = 128\n2020-10-02 19:10:37,235 - allennlp.common.params - INFO - hidden_size = 32\n2020-10-02 19:10:37,236 - allennlp.common.params - INFO - num_layers = 1\n2020-10-02 19:10:37,237 - allennlp.common.params - INFO - bias = True\n2020-10-02 19:10:37,237 - allennlp.common.params - INFO - dropout = 0.0\n2020-10-02 19:10:37,238 - allennlp.common.params - INFO - bidirectional = True\n2020-10-02 19:10:37,240 - allennlp.common.params - INFO - input_dim = 64\n2020-10-02 19:10:37,240 - allennlp.common.params - INFO - num_layers = 1\n2020-10-02 19:10:37,241 - allennlp.common.params - INFO - hidden_dims = [32]\n2020-10-02 19:10:37,242 - allennlp.common.params - INFO - activations = ['relu']\n2020-10-02 19:10:37,243 - allennlp.common.params - INFO - type = relu\n2020-10-02 19:10:37,243 - allennlp.common.params - INFO - dropout = [0.0]\n2020-10-02 19:11:20,965 - allennlp.common.params - INFO - random_seed = 13370\n2020-10-02 19:11:20,966 - allennlp.common.params - INFO - numpy_seed = 1337\n2020-10-02 19:11:20,966 - allennlp.common.params - INFO - pytorch_seed = 133\n2020-10-02 19:11:21,001 - allennlp.common.checks - INFO - Pytorch version: 1.6.0\n2020-10-02 19:11:21,004 - allennlp.common.params - INFO - type = gradient_descent\n2020-10-02 19:11:21,004 - allennlp.common.params - INFO - local_rank = 0\n2020-10-02 19:11:21,005 - allennlp.common.params - INFO - patience = 2\n2020-10-02 19:11:21,005 - allennlp.common.params - INFO - validation_metric = -loss\n2020-10-02 19:11:21,006 - allennlp.common.params - INFO - num_epochs = 1\n2020-10-02 19:11:21,006 - allennlp.common.params - INFO - cuda_device = -1\n2020-10-02 19:11:21,006 - allennlp.common.params - INFO - grad_norm = None\n2020-10-02 19:11:21,007 - allennlp.common.params - INFO - grad_clipping = None\n2020-10-02 19:11:21,007 - allennlp.common.params - INFO - distributed = None\n2020-10-02 19:11:21,008 - allennlp.common.params - INFO - world_size = 1\n2020-10-02 19:11:21,009 - allennlp.common.params - INFO - num_gradient_accumulation_steps = 1\n2020-10-02 19:11:21,009 - allennlp.common.params - INFO - use_amp = False\n2020-10-02 19:11:21,009 - allennlp.common.params - INFO - no_grad = None\n2020-10-02 19:11:21,010 - allennlp.common.params - INFO - learning_rate_scheduler = None\n2020-10-02 19:11:21,010 - allennlp.common.params - INFO - momentum_scheduler = None\n2020-10-02 19:11:21,011 - allennlp.common.params - INFO - moving_average = None\n2020-10-02 19:11:21,012 - allennlp.common.params - INFO - batch_callbacks = None\n2020-10-02 19:11:21,012 - allennlp.common.params - INFO - optimizer.type = adam\n2020-10-02 19:11:21,013 - allennlp.common.params - INFO - optimizer.parameter_groups = None\n2020-10-02 19:11:21,013 - allennlp.common.params - INFO - optimizer.lr = 0.01\n2020-10-02 19:11:21,014 - allennlp.common.params - INFO - optimizer.betas = (0.9, 0.999)\n2020-10-02 19:11:21,014 - allennlp.common.params - INFO - optimizer.eps = 1e-08\n2020-10-02 19:11:21,015 - allennlp.common.params - INFO - optimizer.weight_decay = 0.0\n2020-10-02 19:11:21,015 - allennlp.common.params - INFO - optimizer.amsgrad = False\n2020-10-02 19:11:21,017 - allennlp.training.optimizers - INFO - Number of trainable parameters: 60566\n2020-10-02 19:11:21,018 - allennlp.common.util - INFO - The following parameters are Frozen (without gradient):\n2020-10-02 19:11:21,018 - allennlp.common.util - INFO - The following parameters are Tunable (with gradient):\n2020-10-02 19:11:21,019 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_word.weight\n2020-10-02 19:11:21,019 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._embedding._module.weight\n2020-10-02 19:11:21,020 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_ih_l0\n2020-10-02 19:11:21,020 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_hh_l0\n2020-10-02 19:11:21,020 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_ih_l0\n2020-10-02 19:11:21,022 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_hh_l0\n2020-10-02 19:11:21,022 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_ih_l0_reverse\n2020-10-02 19:11:21,023 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.weight_hh_l0_reverse\n2020-10-02 19:11:21,023 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_ih_l0_reverse\n2020-10-02 19:11:21,023 - allennlp.common.util - INFO - _head.backbone.embedder.token_embedder_char._encoder._module._module.bias_hh_l0_reverse\n2020-10-02 19:11:21,024 - allennlp.common.util - INFO - _head.pooler._module.weight_ih_l0\n2020-10-02 19:11:21,025 - allennlp.common.util - INFO - _head.pooler._module.weight_hh_l0\n2020-10-02 19:11:21,025 - allennlp.common.util - INFO - _head.pooler._module.bias_ih_l0\n2020-10-02 19:11:21,026 - allennlp.common.util - INFO - _head.pooler._module.bias_hh_l0\n2020-10-02 19:11:21,026 - allennlp.common.util - INFO - _head.pooler._module.weight_ih_l0_reverse\n2020-10-02 19:11:21,027 - allennlp.common.util - INFO - _head.pooler._module.weight_hh_l0_reverse\n2020-10-02 19:11:21,027 - allennlp.common.util - INFO - _head.pooler._module.bias_ih_l0_reverse\n2020-10-02 19:11:21,028 - allennlp.common.util - INFO - _head.pooler._module.bias_hh_l0_reverse\n2020-10-02 19:11:21,028 - allennlp.common.util - INFO - _head.feedforward._linear_layers.0.weight\n2020-10-02 19:11:21,029 - allennlp.common.util - INFO - _head.feedforward._linear_layers.0.bias\n2020-10-02 19:11:21,029 - allennlp.common.util - INFO - _head._classification_layer.weight\n2020-10-02 19:11:21,030 - allennlp.common.util - INFO - _head._classification_layer.bias\n2020-10-02 19:11:21,030 - allennlp.common.params - INFO - checkpointer.type = default\n2020-10-02 19:11:21,031 - allennlp.common.params - INFO - checkpointer.keep_serialized_model_every_num_seconds = None\n2020-10-02 19:11:21,032 - allennlp.common.params - INFO - checkpointer.num_serialized_models_to_keep = 1\n2020-10-02 19:11:21,032 - allennlp.common.params - INFO - checkpointer.model_save_interval = None\n2020-10-02 19:11:21,033 - allennlp.common.params - INFO - tensorboard_writer.summary_interval = 100\n2020-10-02 19:11:21,033 - allennlp.common.params - INFO - tensorboard_writer.histogram_interval = None\n2020-10-02 19:11:21,034 - allennlp.common.params - INFO - tensorboard_writer.batch_size_interval = None\n2020-10-02 19:11:21,034 - allennlp.common.params - INFO - tensorboard_writer.should_log_parameter_statistics = True\n2020-10-02 19:11:21,035 - allennlp.common.params - INFO - tensorboard_writer.should_log_learning_rate = True\n2020-10-02 19:11:21,035 - allennlp.common.params - INFO - tensorboard_writer.get_batch_num_total = None\n[34m[1mwandb[0m: Currently logged in as: [33mdcfidalgo[0m (use `wandb login --relogin` to force relogin)\n")])])]),a("p",[e._v("Tracking run with wandb version 0.10.4"),a("br"),e._v("\nSyncing run "),a("strong",{staticStyle:{color:"#cdcd00"}},[e._v("solar-donkey-177")]),e._v(" to "),a("a",{attrs:{href:"https://wandb.ai",target:"_blank"}},[e._v("Weights & Biases")]),e._v(" "),a("a",{attrs:{href:"https://docs.wandb.com/integrations/jupyter.html",target:"_blank"}},[e._v("(Documentation)")]),e._v("."),a("br"),e._v("\nProject page: "),a("a",{attrs:{href:"https://wandb.ai/dcfidalgo/biome",target:"_blank"}},[e._v("https://wandb.ai/dcfidalgo/biome")]),a("br"),e._v("\nRun page: "),a("a",{attrs:{href:"https://wandb.ai/dcfidalgo/biome/runs/1b6a78ko",target:"_blank"}},[e._v("https://wandb.ai/dcfidalgo/biome/runs/1b6a78ko")]),a("br"),e._v("\nRun data is saved locally in "),a("code",[e._v("wandb/run-20201002_191121-1b6a78ko")]),a("br"),a("br")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("2020-10-02 19:11:22,655 - allennlp.training.trainer - INFO - Beginning training.\n2020-10-02 19:11:22,655 - allennlp.training.trainer - INFO - Epoch 0/0\n2020-10-02 19:11:22,656 - allennlp.training.trainer - INFO - Worker 0 memory usage MB: 4177.364\n2020-10-02 19:11:22,730 - allennlp.training.trainer - INFO - GPU 0 memory usage MB: 10\n2020-10-02 19:11:22,733 - allennlp.training.trainer - INFO - Training\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=500.0), HTML(value='')))\n\n\n2020-10-02 19:11:22,838 - allennlp.training.util - WARNING - Metrics with names beginning with \"_\" will not be logged to the tqdm progress bar.\n\n2020-10-02 19:11:52,273 - allennlp.training.trainer - INFO - Validating\n\n\n\nHBox(children=(FloatProgress(value=0.0, max=125.0), HTML(value='')))\n\n\n\n2020-10-02 19:11:53,998 - allennlp.training.tensorboard_writer - INFO -                                                 Training |  Validation\n2020-10-02 19:11:53,999 - allennlp.training.tensorboard_writer - INFO - _fscore/Allgemeinärzte                      |     0.895  |     0.955\n2020-10-02 19:11:54,002 - allennlp.training.tensorboard_writer - INFO - _fscore/Apotheken                           |     0.799  |     0.893\n2020-10-02 19:11:54,004 - allennlp.training.tensorboard_writer - INFO - _fscore/Architekturbüros                    |     0.905  |     0.981\n2020-10-02 19:11:54,006 - allennlp.training.tensorboard_writer - INFO - _fscore/Autowerkstätten                     |     0.716  |     0.783\n2020-10-02 19:11:54,008 - allennlp.training.tensorboard_writer - INFO - _fscore/Dienstleistungen                    |     0.750  |     0.810\n2020-10-02 19:11:54,010 - allennlp.training.tensorboard_writer - INFO - _fscore/Edv                                 |     0.714  |     0.788\n2020-10-02 19:11:54,012 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektriker                          |     0.818  |     0.936\n2020-10-02 19:11:54,014 - allennlp.training.tensorboard_writer - INFO - _fscore/Elektrotechnik                      |     0.789  |     0.939\n2020-10-02 19:11:54,016 - allennlp.training.tensorboard_writer - INFO - _fscore/Friseure                            |     0.805  |     0.894\n2020-10-02 19:11:54,018 - allennlp.training.tensorboard_writer - INFO - _fscore/Gebrauchtwagen                      |     0.749  |     0.898\n2020-10-02 19:11:54,020 - allennlp.training.tensorboard_writer - INFO - _fscore/Handelsvermittler_Und_-vertreter    |     0.564  |     0.671\n2020-10-02 19:11:54,021 - allennlp.training.tensorboard_writer - INFO - _fscore/Hotels                              |     0.671  |     0.806\n2020-10-02 19:11:54,024 - allennlp.training.tensorboard_writer - INFO - _fscore/Maler                               |     0.790  |     0.965\n2020-10-02 19:11:54,025 - allennlp.training.tensorboard_writer - INFO - _fscore/Physiotherapie                      |     0.766  |     0.952\n2020-10-02 19:11:54,028 - allennlp.training.tensorboard_writer - INFO - _fscore/Restaurants                         |     0.588  |     0.723\n2020-10-02 19:11:54,029 - allennlp.training.tensorboard_writer - INFO - _fscore/Sanitärinstallationen               |     0.814  |     0.944\n2020-10-02 19:11:54,031 - allennlp.training.tensorboard_writer - INFO - _fscore/Tiefbau                             |     0.758  |     0.945\n2020-10-02 19:11:54,033 - allennlp.training.tensorboard_writer - INFO - _fscore/Unternehmensberatungen              |     0.795  |     0.890\n2020-10-02 19:11:54,035 - allennlp.training.tensorboard_writer - INFO - _fscore/Vereine                             |     0.908  |     0.965\n2020-10-02 19:11:54,037 - allennlp.training.tensorboard_writer - INFO - _fscore/Vermittlungen                       |     0.851  |     0.971\n2020-10-02 19:11:54,039 - allennlp.training.tensorboard_writer - INFO - _fscore/Versicherungsvermittler             |     0.847  |     0.960\n2020-10-02 19:11:54,041 - allennlp.training.tensorboard_writer - INFO - _fscore/Werbeagenturen                      |     0.811  |     0.855\n2020-10-02 19:11:54,043 - allennlp.training.tensorboard_writer - INFO - _precision/Allgemeinärzte                   |     0.926  |     1.000\n2020-10-02 19:11:54,046 - allennlp.training.tensorboard_writer - INFO - _precision/Apotheken                        |     0.927  |     1.000\n2020-10-02 19:11:54,047 - allennlp.training.tensorboard_writer - INFO - _precision/Architekturbüros                 |     0.923  |     0.981\n2020-10-02 19:11:54,049 - allennlp.training.tensorboard_writer - INFO - _precision/Autowerkstätten                  |     0.786  |     0.922\n2020-10-02 19:11:54,051 - allennlp.training.tensorboard_writer - INFO - _precision/Dienstleistungen                 |     0.738  |     0.770\n2020-10-02 19:11:54,053 - allennlp.training.tensorboard_writer - INFO - _precision/Edv                              |     0.809  |     0.929\n2020-10-02 19:11:54,055 - allennlp.training.tensorboard_writer - INFO - _precision/Elektriker                       |     0.820  |     0.900\n2020-10-02 19:11:54,057 - allennlp.training.tensorboard_writer - INFO - _precision/Elektrotechnik                   |     0.857  |     0.969\n2020-10-02 19:11:54,059 - allennlp.training.tensorboard_writer - INFO - _precision/Friseure                         |     0.763  |     0.818\n2020-10-02 19:11:54,061 - allennlp.training.tensorboard_writer - INFO - _precision/Gebrauchtwagen                   |     0.694  |     0.898\n2020-10-02 19:11:54,063 - allennlp.training.tensorboard_writer - INFO - _precision/Handelsvermittler_Und_-vertreter |     0.742  |     0.587\n2020-10-02 19:11:54,065 - allennlp.training.tensorboard_writer - INFO - _precision/Hotels                           |     0.746  |     0.909\n2020-10-02 19:11:54,067 - allennlp.training.tensorboard_writer - INFO - _precision/Maler                            |     0.753  |     0.943\n2020-10-02 19:11:54,070 - allennlp.training.tensorboard_writer - INFO - _precision/Physiotherapie                   |     0.784  |     0.919\n2020-10-02 19:11:54,072 - allennlp.training.tensorboard_writer - INFO - _precision/Restaurants                      |     0.522  |     0.649\n2020-10-02 19:11:54,074 - allennlp.training.tensorboard_writer - INFO - _precision/Sanitärinstallationen            |     0.854  |     0.988\n2020-10-02 19:11:54,077 - allennlp.training.tensorboard_writer - INFO - _precision/Tiefbau                          |     0.654  |     0.949\n2020-10-02 19:11:54,080 - allennlp.training.tensorboard_writer - INFO - _precision/Unternehmensberatungen           |     0.773  |     0.878\n2020-10-02 19:11:54,082 - allennlp.training.tensorboard_writer - INFO - _precision/Vereine                          |     0.944  |     1.000\n2020-10-02 19:11:54,084 - allennlp.training.tensorboard_writer - INFO - _precision/Vermittlungen                    |     0.893  |     0.957\n2020-10-02 19:11:54,086 - allennlp.training.tensorboard_writer - INFO - _precision/Versicherungsvermittler          |     0.859  |     0.990\n2020-10-02 19:11:54,088 - allennlp.training.tensorboard_writer - INFO - _precision/Werbeagenturen                   |     0.915  |     0.946\n2020-10-02 19:11:54,091 - allennlp.training.tensorboard_writer - INFO - _recall/Allgemeinärzte                      |     0.866  |     0.914\n2020-10-02 19:11:54,093 - allennlp.training.tensorboard_writer - INFO - _recall/Apotheken                           |     0.702  |     0.807\n2020-10-02 19:11:54,095 - allennlp.training.tensorboard_writer - INFO - _recall/Architekturbüros                    |     0.887  |     0.981\n2020-10-02 19:11:54,097 - allennlp.training.tensorboard_writer - INFO - _recall/Autowerkstätten                     |     0.658  |     0.681\n2020-10-02 19:11:54,099 - allennlp.training.tensorboard_writer - INFO - _recall/Dienstleistungen                    |     0.761  |     0.855\n2020-10-02 19:11:54,101 - allennlp.training.tensorboard_writer - INFO - _recall/Edv                                 |     0.638  |     0.684\n2020-10-02 19:11:54,103 - allennlp.training.tensorboard_writer - INFO - _recall/Elektriker                          |     0.816  |     0.976\n2020-10-02 19:11:54,105 - allennlp.training.tensorboard_writer - INFO - _recall/Elektrotechnik                      |     0.732  |     0.912\n2020-10-02 19:11:54,107 - allennlp.training.tensorboard_writer - INFO - _recall/Friseure                            |     0.851  |     0.986\n2020-10-02 19:11:54,109 - allennlp.training.tensorboard_writer - INFO - _recall/Gebrauchtwagen                      |     0.813  |     0.898\n2020-10-02 19:11:54,111 - allennlp.training.tensorboard_writer - INFO - _recall/Handelsvermittler_Und_-vertreter    |     0.455  |     0.783\n2020-10-02 19:11:54,113 - allennlp.training.tensorboard_writer - INFO - _recall/Hotels                              |     0.609  |     0.725\n2020-10-02 19:11:54,115 - allennlp.training.tensorboard_writer - INFO - _recall/Maler                               |     0.830  |     0.988\n2020-10-02 19:11:54,117 - allennlp.training.tensorboard_writer - INFO - _recall/Physiotherapie                      |     0.748  |     0.988\n2020-10-02 19:11:54,119 - allennlp.training.tensorboard_writer - INFO - _recall/Restaurants                         |     0.673  |     0.817\n2020-10-02 19:11:54,121 - allennlp.training.tensorboard_writer - INFO - _recall/Sanitärinstallationen               |     0.777  |     0.903\n2020-10-02 19:11:54,124 - allennlp.training.tensorboard_writer - INFO - _recall/Tiefbau                             |     0.902  |     0.941\n2020-10-02 19:11:54,128 - allennlp.training.tensorboard_writer - INFO - _recall/Unternehmensberatungen              |     0.818  |     0.902\n2020-10-02 19:11:54,130 - allennlp.training.tensorboard_writer - INFO - _recall/Vereine                             |     0.875  |     0.933\n2020-10-02 19:11:54,132 - allennlp.training.tensorboard_writer - INFO - _recall/Vermittlungen                       |     0.812  |     0.985\n2020-10-02 19:11:54,135 - allennlp.training.tensorboard_writer - INFO - _recall/Versicherungsvermittler             |     0.835  |     0.933\n2020-10-02 19:11:54,137 - allennlp.training.tensorboard_writer - INFO - _recall/Werbeagenturen                      |     0.728  |     0.779\n2020-10-02 19:11:54,140 - allennlp.training.tensorboard_writer - INFO - accuracy                                    |     0.780  |     0.889\n2020-10-02 19:11:54,142 - allennlp.training.tensorboard_writer - INFO - gpu_0_memory_MB                             |    10.000  |       N/A\n2020-10-02 19:11:54,144 - allennlp.training.tensorboard_writer - INFO - loss                                        |     0.782  |     0.417\n2020-10-02 19:11:54,146 - allennlp.training.tensorboard_writer - INFO - macro/fscore                                |     0.777  |     0.888\n2020-10-02 19:11:54,148 - allennlp.training.tensorboard_writer - INFO - macro/precision                             |     0.804  |     0.905\n2020-10-02 19:11:54,151 - allennlp.training.tensorboard_writer - INFO - macro/recall                                |     0.763  |     0.880\n2020-10-02 19:11:54,153 - allennlp.training.tensorboard_writer - INFO - micro/fscore                                |     0.780  |     0.890\n2020-10-02 19:11:54,155 - allennlp.training.tensorboard_writer - INFO - micro/precision                             |     0.780  |     0.890\n2020-10-02 19:11:54,157 - allennlp.training.tensorboard_writer - INFO - micro/recall                                |     0.780  |     0.890\n2020-10-02 19:11:54,159 - allennlp.training.tensorboard_writer - INFO - worker_0_memory_MB                          |  4177.364  |       N/A\n2020-10-02 19:11:54,168 - allennlp.training.checkpointer - INFO - Best validation performance so far. Copying weights to 'output/best.th'.\n2020-10-02 19:11:54,175 - allennlp.training.trainer - INFO - Epoch duration: 0:00:31.519246\n2020-10-02 19:11:54,178 - allennlp.training.checkpointer - INFO - loading best weights\n2020-10-02 19:11:54,183 - allennlp.models.archival - INFO - archiving weights and vocabulary to output/model.tar.gz\n\n\n\n\n\nTrainingResults(model_path='output/model.tar.gz', metrics={'best_epoch': 0, 'peak_worker_0_memory_MB': 4177.364, 'peak_gpu_0_memory_MB': 10, 'training_duration': '0:00:31.505137', 'training_start_epoch': 0, 'training_epochs': 0, 'epoch': 0, 'training_accuracy': 0.779625, 'training_micro/precision': 0.7796249985694885, 'training_micro/recall': 0.7796249985694885, 'training_micro/fscore': 0.7796249985694885, 'training_macro/precision': 0.8036126494407654, 'training_macro/recall': 0.7631202340126038, 'training_macro/fscore': 0.7772855162620544, 'training__precision/Unternehmensberatungen': 0.7727952003479004, 'training__precision/Friseure': 0.7631160616874695, 'training__precision/Tiefbau': 0.654285728931427, 'training__precision/Dienstleistungen': 0.7379575967788696, 'training__precision/Gebrauchtwagen': 0.6939163208007812, 'training__precision/Elektriker': 0.8200934529304504, 'training__precision/Restaurants': 0.5220588445663452, 'training__precision/Architekturbüros': 0.9226932525634766, 'training__precision/Vereine': 0.9438202381134033, 'training__precision/Versicherungsvermittler': 0.8591954112052917, 'training__precision/Maler': 0.7527472376823425, 'training__precision/Sanitärinstallationen': 0.853741466999054, 'training__precision/Edv': 0.8087649345397949, 'training__precision/Werbeagenturen': 0.9145299196243286, 'training__precision/Apotheken': 0.9269406199455261, 'training__precision/Physiotherapie': 0.7838827967643738, 'training__precision/Vermittlungen': 0.8928571343421936, 'training__precision/Hotels': 0.7455357313156128, 'training__precision/Autowerkstätten': 0.7863636612892151, 'training__precision/Elektrotechnik': 0.8565022349357605, 'training__precision/Allgemeinärzte': 0.9257425665855408, 'training__precision/Handelsvermittler_Und_-vertreter': 0.7419354915618896, 'training__recall/Unternehmensberatungen': 0.8180379867553711, 'training__recall/Friseure': 0.8510638475418091, 'training__recall/Tiefbau': 0.9015747904777527, 'training__recall/Dienstleistungen': 0.7614313960075378, 'training__recall/Gebrauchtwagen': 0.8129175901412964, 'training__recall/Elektriker': 0.8162790536880493, 'training__recall/Restaurants': 0.6729857921600342, 'training__recall/Architekturbüros': 0.8872901797294617, 'training__recall/Vereine': 0.875, 'training__recall/Versicherungsvermittler': 0.8351955413818359, 'training__recall/Maler': 0.8303030133247375, 'training__recall/Sanitärinstallationen': 0.7770897746086121, 'training__recall/Edv': 0.6383647918701172, 'training__recall/Werbeagenturen': 0.7278911471366882, 'training__recall/Apotheken': 0.7024221420288086, 'training__recall/Physiotherapie': 0.748251736164093, 'training__recall/Vermittlungen': 0.8122743964195251, 'training__recall/Hotels': 0.6094890236854553, 'training__recall/Autowerkstätten': 0.6577946543693542, 'training__recall/Elektrotechnik': 0.7318007946014404, 'training__recall/Allgemeinärzte': 0.8657407164573669, 'training__recall/Handelsvermittler_Und_-vertreter': 0.4554455578327179, 'training__fscore/Unternehmensberatungen': 0.7947732210159302, 'training__fscore/Friseure': 0.8046941161155701, 'training__fscore/Tiefbau': 0.7582781314849854, 'training__fscore/Dienstleistungen': 0.7495107650756836, 'training__fscore/Gebrauchtwagen': 0.7487179636955261, 'training__fscore/Elektriker': 0.8181818127632141, 'training__fscore/Restaurants': 0.5879917144775391, 'training__fscore/Architekturbüros': 0.9046454429626465, 'training__fscore/Vereine': 0.9081081748008728, 'training__fscore/Versicherungsvermittler': 0.847025454044342, 'training__fscore/Maler': 0.789625346660614, 'training__fscore/Sanitärinstallationen': 0.8136142492294312, 'training__fscore/Edv': 0.713532567024231, 'training__fscore/Werbeagenturen': 0.810606062412262, 'training__fscore/Apotheken': 0.7992125749588013, 'training__fscore/Physiotherapie': 0.7656529545783997, 'training__fscore/Vermittlungen': 0.8506616353988647, 'training__fscore/Hotels': 0.6706826686859131, 'training__fscore/Autowerkstätten': 0.716356098651886, 'training__fscore/Elektrotechnik': 0.78925621509552, 'training__fscore/Allgemeinärzte': 0.8947368264198303, 'training__fscore/Handelsvermittler_Und_-vertreter': 0.5644171833992004, 'training_loss': 0.7819655173746869, 'training_worker_0_memory_MB': 4177.364, 'training_gpu_0_memory_MB': 10, 'validation_accuracy': 0.8895, 'validation_micro/precision': 0.8895000219345093, 'validation_micro/recall': 0.8895000219345093, 'validation_micro/fscore': 0.8895000219345093, 'validation_macro/precision': 0.904606819152832, 'validation_macro/recall': 0.8804986476898193, 'validation_macro/fscore': 0.8875770568847656, 'validation__precision/Unternehmensberatungen': 0.8775510191917419, 'validation__precision/Friseure': 0.8176470398902893, 'validation__precision/Tiefbau': 0.9491525292396545, 'validation__precision/Dienstleistungen': 0.7704917788505554, 'validation__precision/Gebrauchtwagen': 0.8983050584793091, 'validation__precision/Elektriker': 0.8999999761581421, 'validation__precision/Restaurants': 0.6488549709320068, 'validation__precision/Architekturbüros': 0.9811320900917053, 'validation__precision/Vereine': 1.0, 'validation__precision/Versicherungsvermittler': 0.9897959232330322, 'validation__precision/Maler': 0.9425287246704102, 'validation__precision/Sanitärinstallationen': 0.9882352948188782, 'validation__precision/Edv': 0.9285714030265808, 'validation__precision/Werbeagenturen': 0.9464285969734192, 'validation__precision/Apotheken': 1.0, 'validation__precision/Physiotherapie': 0.9186046719551086, 'validation__precision/Vermittlungen': 0.9571428298950195, 'validation__precision/Hotels': 0.9090909361839294, 'validation__precision/Autowerkstätten': 0.9215686321258545, 'validation__precision/Elektrotechnik': 0.96875, 'validation__precision/Allgemeinärzte': 1.0, 'validation__precision/Handelsvermittler_Und_-vertreter': 0.5874999761581421, 'validation__recall/Unternehmensberatungen': 0.9020978808403015, 'validation__recall/Friseure': 0.9858155846595764, 'validation__recall/Tiefbau': 0.9411764740943909, 'validation__recall/Dienstleistungen': 0.8545454740524292, 'validation__recall/Gebrauchtwagen': 0.8983050584793091, 'validation__recall/Elektriker': 0.9759036302566528, 'validation__recall/Restaurants': 0.817307710647583, 'validation__recall/Architekturbüros': 0.9811320900917053, 'validation__recall/Vereine': 0.932692289352417, 'validation__recall/Versicherungsvermittler': 0.932692289352417, 'validation__recall/Maler': 0.9879518151283264, 'validation__recall/Sanitärinstallationen': 0.9032257795333862, 'validation__recall/Edv': 0.6842105388641357, 'validation__recall/Werbeagenturen': 0.779411792755127, 'validation__recall/Apotheken': 0.8070175647735596, 'validation__recall/Physiotherapie': 0.987500011920929, 'validation__recall/Vermittlungen': 0.9852941036224365, 'validation__recall/Hotels': 0.7246376872062683, 'validation__recall/Autowerkstätten': 0.6811594367027283, 'validation__recall/Elektrotechnik': 0.9117646813392639, 'validation__recall/Allgemeinärzte': 0.9137930870056152, 'validation__recall/Handelsvermittler_Und_-vertreter': 0.7833333611488342, 'validation__fscore/Unternehmensberatungen': 0.8896551728248596, 'validation__fscore/Friseure': 0.8938906192779541, 'validation__fscore/Tiefbau': 0.945147693157196, 'validation__fscore/Dienstleistungen': 0.8103448748588562, 'validation__fscore/Gebrauchtwagen': 0.8983050584793091, 'validation__fscore/Elektriker': 0.9364161491394043, 'validation__fscore/Restaurants': 0.7234042286872864, 'validation__fscore/Architekturbüros': 0.9811320900917053, 'validation__fscore/Vereine': 0.96517413854599, 'validation__fscore/Versicherungsvermittler': 0.9603960514068604, 'validation__fscore/Maler': 0.9647058844566345, 'validation__fscore/Sanitärinstallationen': 0.9438201785087585, 'validation__fscore/Edv': 0.7878788113594055, 'validation__fscore/Werbeagenturen': 0.8548387885093689, 'validation__fscore/Apotheken': 0.8932039141654968, 'validation__fscore/Physiotherapie': 0.9518072605133057, 'validation__fscore/Vermittlungen': 0.9710144996643066, 'validation__fscore/Hotels': 0.8064516186714172, 'validation__fscore/Autowerkstätten': 0.7833333611488342, 'validation__fscore/Elektrotechnik': 0.9393939971923828, 'validation__fscore/Allgemeinärzte': 0.9549549221992493, 'validation__fscore/Handelsvermittler_Und_-vertreter': 0.6714285016059875, 'validation_loss': 0.41664771926403044, 'best_validation_accuracy': 0.8895, 'best_validation_micro/precision': 0.8895000219345093, 'best_validation_micro/recall': 0.8895000219345093, 'best_validation_micro/fscore': 0.8895000219345093, 'best_validation_macro/precision': 0.904606819152832, 'best_validation_macro/recall': 0.8804986476898193, 'best_validation_macro/fscore': 0.8875770568847656, 'best_validation__precision/Unternehmensberatungen': 0.8775510191917419, 'best_validation__precision/Friseure': 0.8176470398902893, 'best_validation__precision/Tiefbau': 0.9491525292396545, 'best_validation__precision/Dienstleistungen': 0.7704917788505554, 'best_validation__precision/Gebrauchtwagen': 0.8983050584793091, 'best_validation__precision/Elektriker': 0.8999999761581421, 'best_validation__precision/Restaurants': 0.6488549709320068, 'best_validation__precision/Architekturbüros': 0.9811320900917053, 'best_validation__precision/Vereine': 1.0, 'best_validation__precision/Versicherungsvermittler': 0.9897959232330322, 'best_validation__precision/Maler': 0.9425287246704102, 'best_validation__precision/Sanitärinstallationen': 0.9882352948188782, 'best_validation__precision/Edv': 0.9285714030265808, 'best_validation__precision/Werbeagenturen': 0.9464285969734192, 'best_validation__precision/Apotheken': 1.0, 'best_validation__precision/Physiotherapie': 0.9186046719551086, 'best_validation__precision/Vermittlungen': 0.9571428298950195, 'best_validation__precision/Hotels': 0.9090909361839294, 'best_validation__precision/Autowerkstätten': 0.9215686321258545, 'best_validation__precision/Elektrotechnik': 0.96875, 'best_validation__precision/Allgemeinärzte': 1.0, 'best_validation__precision/Handelsvermittler_Und_-vertreter': 0.5874999761581421, 'best_validation__recall/Unternehmensberatungen': 0.9020978808403015, 'best_validation__recall/Friseure': 0.9858155846595764, 'best_validation__recall/Tiefbau': 0.9411764740943909, 'best_validation__recall/Dienstleistungen': 0.8545454740524292, 'best_validation__recall/Gebrauchtwagen': 0.8983050584793091, 'best_validation__recall/Elektriker': 0.9759036302566528, 'best_validation__recall/Restaurants': 0.817307710647583, 'best_validation__recall/Architekturbüros': 0.9811320900917053, 'best_validation__recall/Vereine': 0.932692289352417, 'best_validation__recall/Versicherungsvermittler': 0.932692289352417, 'best_validation__recall/Maler': 0.9879518151283264, 'best_validation__recall/Sanitärinstallationen': 0.9032257795333862, 'best_validation__recall/Edv': 0.6842105388641357, 'best_validation__recall/Werbeagenturen': 0.779411792755127, 'best_validation__recall/Apotheken': 0.8070175647735596, 'best_validation__recall/Physiotherapie': 0.987500011920929, 'best_validation__recall/Vermittlungen': 0.9852941036224365, 'best_validation__recall/Hotels': 0.7246376872062683, 'best_validation__recall/Autowerkstätten': 0.6811594367027283, 'best_validation__recall/Elektrotechnik': 0.9117646813392639, 'best_validation__recall/Allgemeinärzte': 0.9137930870056152, 'best_validation__recall/Handelsvermittler_Und_-vertreter': 0.7833333611488342, 'best_validation__fscore/Unternehmensberatungen': 0.8896551728248596, 'best_validation__fscore/Friseure': 0.8938906192779541, 'best_validation__fscore/Tiefbau': 0.945147693157196, 'best_validation__fscore/Dienstleistungen': 0.8103448748588562, 'best_validation__fscore/Gebrauchtwagen': 0.8983050584793091, 'best_validation__fscore/Elektriker': 0.9364161491394043, 'best_validation__fscore/Restaurants': 0.7234042286872864, 'best_validation__fscore/Architekturbüros': 0.9811320900917053, 'best_validation__fscore/Vereine': 0.96517413854599, 'best_validation__fscore/Versicherungsvermittler': 0.9603960514068604, 'best_validation__fscore/Maler': 0.9647058844566345, 'best_validation__fscore/Sanitärinstallationen': 0.9438201785087585, 'best_validation__fscore/Edv': 0.7878788113594055, 'best_validation__fscore/Werbeagenturen': 0.8548387885093689, 'best_validation__fscore/Apotheken': 0.8932039141654968, 'best_validation__fscore/Physiotherapie': 0.9518072605133057, 'best_validation__fscore/Vermittlungen': 0.9710144996643066, 'best_validation__fscore/Hotels': 0.8064516186714172, 'best_validation__fscore/Autowerkstätten': 0.7833333611488342, 'best_validation__fscore/Elektrotechnik': 0.9393939971923828, 'best_validation__fscore/Allgemeinärzte': 0.9549549221992493, 'best_validation__fscore/Handelsvermittler_Und_-vertreter': 0.6714285016059875, 'best_validation_loss': 0.41664771926403044})\n")])])]),a("p",[e._v("After 3 epochs we achieve a validation accuracy of about 0.91.\nThe validation loss seems to be decreasing further, though, so we could probably train the model for a few more epochs without the risk of overfitting.")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("Tip")]),e._v(" "),a("p",[e._v("If for some reason the training gets interrupted, you can continue where you left off by setting the "),a("code",[e._v("restore")]),e._v(" argument in the "),a("code",[e._v("Pipeline.train()")]),e._v(" method to "),a("code",[e._v("True")]),e._v(".\nIf you want to train your model for a few more epochs, you can also use the "),a("code",[e._v("restore")]),e._v(" argument, but you have to modify the "),a("code",[e._v("epochs")]),e._v(" argument in your "),a("code",[e._v("TrainerConfiguration")]),e._v(" to reflect the total amount of epochs you aim for.")])]),e._v(" "),a("h2",{attrs:{id:"make-your-first-predictions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#make-your-first-predictions"}},[e._v("#")]),e._v(" Make your first predictions")]),e._v(" "),a("p",[e._v("Now that we trained our model we can go on to make our first predictions.\nFirst we must load our trained model into a new "),a("code",[e._v("Pipeline")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" Pipeline\npl_trained "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Pipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("from_pretrained"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"output/model.tar.gz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("We then provide the input expected by our "),a("code",[e._v("TaskHead")]),e._v(" of the model to the "),a("code",[e._v("Pipeline.predict()")]),e._v(" method.\nIn our case it is a "),a("code",[e._v("TextClassification")]),e._v(" head that classifies a "),a("code",[e._v("text")]),e._v(" input:")]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("pl_trained"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("predict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Autohaus biome.text"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("{'logits': array([ -8.697124  ,  -2.0385478 , -12.08095   ,  -1.8943698 ,\n          6.70876   ,   4.430516  ,  -4.048667  , -12.542465  ,\n        -19.531273  , -11.525868  , -14.129992  ,  -1.4674935 ,\n         -7.2374005 ,  -9.69228   ,  -1.2065237 , -11.085176  ,\n        -13.620126  ,  -2.7656398 ,  -0.25925013,  -0.6939171 ,\n        -16.962463  ,  -4.30388   ], dtype=float32),\n 'probs': array([1.8445924e-07, 1.4377496e-04, 6.2563892e-09, 1.6607303e-04,\n        9.0487945e-01, 9.2717543e-02, 1.9261914e-05, 3.9435752e-09,\n        3.6365500e-12, 1.0899137e-08, 8.0618784e-10, 2.5450074e-04,\n        7.9405442e-07, 6.8188314e-08, 3.3039000e-04, 1.6934898e-08,\n        1.3423559e-09, 6.9488233e-05, 8.5196638e-04, 5.5163138e-04,\n        4.7457989e-11, 1.4923200e-05], dtype=float32),\n 'classes': {'Gebrauchtwagen': tensor(0.9049),\n  'Elektriker': tensor(0.0927),\n  'Autowerkstätten': tensor(0.0009),\n  'Elektrotechnik': tensor(0.0006),\n  'Apotheken': tensor(0.0003),\n  'Sanitärinstallationen': tensor(0.0003),\n  'Dienstleistungen': tensor(0.0002),\n  'Friseure': tensor(0.0001),\n  'Hotels': tensor(6.9488e-05),\n  'Restaurants': tensor(1.9262e-05),\n  'Handelsvermittler Und -vertreter': tensor(1.4923e-05),\n  'Edv': tensor(7.9405e-07),\n  'Unternehmensberatungen': tensor(1.8446e-07),\n  'Werbeagenturen': tensor(6.8188e-08),\n  'Physiotherapie': tensor(1.6935e-08),\n  'Versicherungsvermittler': tensor(1.0899e-08),\n  'Tiefbau': tensor(6.2564e-09),\n  'Architekturbüros': tensor(3.9436e-09),\n  'Vermittlungen': tensor(1.3424e-09),\n  'Maler': tensor(8.0619e-10),\n  'Allgemeinärzte': tensor(4.7458e-11),\n  'Vereine': tensor(3.6366e-12)},\n 'max_class': 'Gebrauchtwagen',\n 'max_class_prob': tensor(0.9049),\n 'label': 'Gebrauchtwagen',\n 'prob': tensor(0.9049)}\n")])])]),a("p",[e._v("The returned dictionary contains the logits and probabilities of all labels (classes).\nThe label with the highest probability is stored under the "),a("code",[e._v("label")]),e._v(" key, together with its probability under the "),a("code",[e._v("prob")]),e._v(" key.")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("Tip")]),e._v(" "),a("p",[e._v("When configuring the pipeline in the first place, we recommend to check that it is correctly setup by using the "),a("code",[e._v("predict")]),e._v(" method.\nSince the pipeline is still not trained at that moment, the predictions will be arbitrary.")])]),e._v(" "),a("h2",{attrs:{id:"explore-the-model-s-predictions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#explore-the-model-s-predictions"}},[e._v("#")]),e._v(" Explore the model's predictions")]),e._v(" "),a("p",[e._v("To check and understand the predictions of the model, we can use the "),a("strong",[e._v("biome.text explore UI")]),e._v(".\nJust calling the "),a("RouterLink",{attrs:{to:"/api/biome/text/pipeline.html#explore"}},[e._v("Pipeline.predict")]),e._v(" method will open the UI in the output of our cell.\nWe will set the "),a("code",[e._v("explain")]),e._v(" argument to true, which automatically visualizes the attribution of each token by means of "),a("a",{attrs:{href:"https://arxiv.org/abs/1703.01365",target:"_blank",rel:"noopener noreferrer"}},[e._v("integrated gradients"),a("OutboundLink")],1),e._v(".")],1),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("Warning")]),e._v(" "),a("p",[e._v("For the UI to work you need a running "),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/install-elasticsearch.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Elasticsearch"),a("OutboundLink")],1),e._v(" instance.\nWe recommend installing "),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.7/docker.html#docker-cli-run-dev-mode",target:"_blank",rel:"noopener noreferrer"}},[e._v("Elasticsearch with docker"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" DataSource\nvalid_ds "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" DataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://biome-tutorials-data.s3-eu-west-1.amazonaws.com/text_classifier/business.cat.valid.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" explore\nexplore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("create"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("pipeline"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("pl_trained"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" data_source"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("valid_ds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("INFO:biome.text.ui.ui:Running biome UI on http://0.0.0.0:8080 with elasticsearch backend http://localhost:9200\n")])])]),a("iframe",{attrs:{src:"http://localhost:8080/1297acd6-10a8-11eb-831a-8b399f594e1e",width:"100%",height:"840"}}),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('\'1297acd6-10a8-11eb-831a-8b399f594e1e\'\n\n\n\nWARNING:biome.text.ui.app:Path 1297acd6-10a8-11eb-831a-8b399f594e1e not found. Error: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\n127.0.0.1 - - [2020-10-17 20:39:42] "GET /1297acd6-10a8-11eb-831a-8b399f594e1e HTTP/1.1" 200 2004 0.003048\n127.0.0.1 - - [2020-10-17 20:39:43] "GET /css/app.78744b4e.css HTTP/1.1" 200 462326 0.002237\n127.0.0.1 - - [2020-10-17 20:39:43] "GET /js/chunk-vendors.98c10bc8.js HTTP/1.1" 200 1175313 0.002989\n127.0.0.1 - - [2020-10-17 20:39:43] "GET /js/app.04b4bbea.js HTTP/1.1" 200 169156 0.001564\n127.0.0.1 - - [2020-10-17 20:39:43] "GET /elastic/ HTTP/1.1" 200 557 0.004468\n127.0.0.1 - - [2020-10-17 20:39:43] "POST /elastic/1297acd6-10a8-11eb-831a-8b399f594e1e/_search HTTP/1.1" 200 339 0.005736\n127.0.0.1 - - [2020-10-17 20:39:43] "POST /elastic/.biome/_search HTTP/1.1" 200 2068 0.005950\n127.0.0.1 - - [2020-10-17 20:39:43] "GET /elastic/.biome/_doc/1297acd6-10a8-11eb-831a-8b399f594e1e HTTP/1.1" 200 1222 0.004074\n127.0.0.1 - - [2020-10-17 20:39:43] "GET /elastic/1297acd6-10a8-11eb-831a-8b399f594e1e/_mappings HTTP/1.1" 200 1861 0.004409\n127.0.0.1 - - [2020-10-17 20:39:43] "POST /elastic/1297acd6-10a8-11eb-831a-8b399f594e1e/_search HTTP/1.1" 200 51439 0.059999\n192.168.1.238 - - [2020-10-19 17:22:46] "GET / HTTP/1.1" 200 2004 0.003753\nWARNING:biome.text.ui.app:Path HNAP1/ not found. Error: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\n192.168.1.238 - - [2020-10-19 17:22:46] "GET /HNAP1/ HTTP/1.1" 200 2004 0.004823\n')])])]),a("p",[a("img",{attrs:{src:t(313),alt:"Screenshot of the biome.text explore UI"}}),e._v(" "),a("em",[e._v("Screenshot of the biome.text explore UI")])]),e._v(" "),a("p",[e._v('Exploring our model we could take advantage of the F1 scores of each label to figure out which labels to prioritize when gathering new training data.\nFor example, although "Allgemeinärzte" is the second rarest label in our training data, it still seems relatively easy to classify for our model due to the distinctive words "Dr." and "Allgemeinmedizin".')]),e._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" ui\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("ui"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("launch_ui"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('INFO:biome.text.ui.ui:Running biome UI on http://0.0.0.0:9000 with elasticsearch backend http://localhost:9200\n127.0.0.1 - - [2020-09-25 17:17:54] "GET /elastic/ HTTP/1.1" 200 590 0.005457\n127.0.0.1 - - [2020-09-25 17:18:01] "GET /elastic/ HTTP/1.1" 200 590 0.007005\n')])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[e._v("\n")])])])])}),[],!1,null,null,null);n.default=r.exports}}]);
