

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SimilarityClassifier &mdash; biome-text  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pipelines" href="../pipelines/index.html" />
    <link rel="prev" title="SequencePairClassifier" href="biome.text.models.SequencePairClassifier.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> biome-text
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html">commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset_readers/index.html">dataset_readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpreters/index.html">interpreters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../models/index.html">models</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../models/index.html#reference-api">Reference/API</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../models/index.html#module-biome.text.models">biome.text.models Package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../models/index.html#functions">Functions</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../models/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pipelines/index.html">pipelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">biome-text</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../models/index.html">models</a> &raquo;</li>
        
      <li>SimilarityClassifier</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/biome.text.models.SimilarityClassifier.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="similarityclassifier">
<h1>SimilarityClassifier<a class="headerlink" href="#similarityclassifier" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="biome.text.models.SimilarityClassifier">
<em class="property">class </em><code class="sig-prename descclassname">biome.text.models.</code><code class="sig-name descname">SimilarityClassifier</code><span class="sig-paren">(</span><em class="sig-param">vocab: allennlp.data.vocabulary.Vocabulary</em>, <em class="sig-param">text_field_embedder: allennlp.modules.text_field_embedders.text_field_embedder.TextFieldEmbedder</em>, <em class="sig-param">seq2vec_encoder: allennlp.modules.seq2vec_encoders.seq2vec_encoder.Seq2VecEncoder</em>, <em class="sig-param">seq2seq_encoder: Optional[allennlp.modules.seq2seq_encoders.seq2seq_encoder.Seq2SeqEncoder] = None</em>, <em class="sig-param">multifield_seq2seq_encoder: Optional[allennlp.modules.seq2seq_encoders.seq2seq_encoder.Seq2SeqEncoder] = None</em>, <em class="sig-param">multifield_seq2vec_encoder: Optional[allennlp.modules.seq2vec_encoders.seq2vec_encoder.Seq2VecEncoder] = None</em>, <em class="sig-param">feed_forward: Optional[allennlp.modules.feedforward.FeedForward] = None</em>, <em class="sig-param">dropout: Optional[float] = None</em>, <em class="sig-param">multifield_dropout: Optional[float] = None</em>, <em class="sig-param">initializer: Optional[allennlp.nn.initializers.InitializerApplicator] = None</em>, <em class="sig-param">regularizer: Optional[allennlp.nn.regularizers.regularizer_applicator.RegularizerApplicator] = None</em>, <em class="sig-param">margin: float = 0.5</em>, <em class="sig-param">verification_weight: float = 2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#biome.text.models.SimilarityClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biome.text.models.sequence_classifier_base.SequenceClassifierBase</span></code></p>
<p>This <code class="docutils literal notranslate"><span class="pre">SimilarityClassifier</span></code> uses a siamese network architecture to perform a binary classification task:
are two inputs similar or not?
The two input sequences are encoded with two single vectors, the resulting vectors are concatenated and fed to a
linear classification layer.</p>
<p>Apart from the CrossEntropy loss, this model includes a CosineEmbedding loss
(<a class="reference external" href="https://pytorch.org/docs/stable/nn.html#cosineembeddingloss">https://pytorch.org/docs/stable/nn.html#cosineembeddingloss</a>) that will drive the network to create
vector clusters for each “class” in the data.
Make sure that the label “same” is indexed as 0, and the label “different” as 1!!!
Make sure that the dropout of the last Seq2Vec or the last FeedForward layer is set to 0!!!
(Deep Learning Face Representation by Joint Identification-Verification, <a class="reference external" href="https://arxiv.org/pdf/1406.4773.pdf">https://arxiv.org/pdf/1406.4773.pdf</a>)</p>
<dl class="simple">
<dt>kwargs</dt><dd><p>See the <cite>BaseModelClassifier</cite> for a description of the parameters.</p>
</dd>
<dt>margin</dt><dd><p>This parameter is passed on to the CosineEmbedding loss. It provides a margin,
at which dissimilar vectors are not driven further apart.
Can be between -1 (always drive apart) and 1 (never drive apart).</p>
</dd>
<dt>verification_weight</dt><dd><p>Defines the weight of the verification loss in the final loss sum:
loss = CrossEntropy + w * CosineEmbedding</p>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#biome.text.models.SimilarityClassifier.n_inputs" title="biome.text.models.SimilarityClassifier.n_inputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_inputs</span></code></a></p></td>
<td><p>This value is used for calculate the output layer dimension.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#biome.text.models.SimilarityClassifier.forward" title="biome.text.models.SimilarityClassifier.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(record1, record2[, label])</p></td>
<td><p>The architecture is basically: Embedding -&gt; Seq2Seq -&gt; Seq2Vec -&gt; Dropout -&gt; (Optional: MultiField stuff) -&gt; FeedForward -&gt; Concatenation -&gt; Classification layer</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#biome.text.models.SimilarityClassifier.output_layer" title="biome.text.models.SimilarityClassifier.output_layer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_layer</span></code></a>(encoded_texts, label)</p></td>
<td><p>Returns</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="attribute">
<dt id="biome.text.models.SimilarityClassifier.n_inputs">
<code class="sig-name descname">n_inputs</code><a class="headerlink" href="#biome.text.models.SimilarityClassifier.n_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>This value is used for calculate the output layer dimension. Default value is 1</p>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="method">
<dt id="biome.text.models.SimilarityClassifier.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">record1: Dict[str, torch.Tensor], record2: Dict[str, torch.Tensor], label: torch.Tensor = None</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.Tensor]<a class="headerlink" href="#biome.text.models.SimilarityClassifier.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>The architecture is basically:
Embedding -&gt; Seq2Seq -&gt; Seq2Vec -&gt; Dropout -&gt; (Optional: MultiField stuff) -&gt; FeedForward
-&gt; Concatenation -&gt; Classification layer</p>
<dl class="simple">
<dt>record1</dt><dd><p>The first input tokens.
The dictionary is the output of a <code class="docutils literal notranslate"><span class="pre">TextField.as_array()</span></code>. It gives names to the tensors created by
the <code class="docutils literal notranslate"><span class="pre">TokenIndexer``s.</span>
<span class="pre">In</span> <span class="pre">its</span> <span class="pre">most</span> <span class="pre">basic</span> <span class="pre">form,</span> <span class="pre">using</span> <span class="pre">a</span> <span class="pre">``SingleIdTokenIndexer</span></code>, the dictionary is composed of:
<code class="docutils literal notranslate"><span class="pre">{&quot;tokens&quot;:</span> <span class="pre">Tensor(batch_size,</span> <span class="pre">num_tokens)}</span></code>.
The keys of the dictionary are defined in the <cite>model.yml</cite> input.
The dictionary is designed to be passed on directly to a <code class="docutils literal notranslate"><span class="pre">TextFieldEmbedder</span></code>, that has a
<code class="docutils literal notranslate"><span class="pre">TokenEmbedder</span></code> for each key in the dictionary (except you set <cite>allow_unmatched_keys</cite> in the
<code class="docutils literal notranslate"><span class="pre">TextFieldEmbedder</span></code> to False) and knows how to combine different word/character representations into a
single vector per token in your input.</p>
</dd>
<dt>record2</dt><dd><p>The second input tokens.</p>
</dd>
<dt>label<span class="classifier">torch.LongTensor, optional (default = None)</span></dt><dd><p>A torch tensor representing the sequence of integer gold class label of shape
<code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_classes)</span></code>.</p>
</dd>
</dl>
<p>An output dictionary consisting of:
logits : torch.FloatTensor</p>
<blockquote>
<div><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_tokens,</span> <span class="pre">tag_vocab_size)</span></code> representing
unnormalised log probabilities of the tag classes.</p>
</div></blockquote>
<dl class="simple">
<dt>class_probabilities<span class="classifier">torch.FloatTensor</span></dt><dd><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_tokens,</span> <span class="pre">tag_vocab_size)</span></code> representing
a distribution of the tag classes per word.</p>
</dd>
<dt>loss<span class="classifier">torch.FloatTensor, optional</span></dt><dd><p>A scalar loss to be optimised.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="biome.text.models.SimilarityClassifier.output_layer">
<code class="sig-name descname">output_layer</code><span class="sig-paren">(</span><em class="sig-param">encoded_texts: List[torch.Tensor], label</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.Tensor]<a class="headerlink" href="#biome.text.models.SimilarityClassifier.output_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>An output dictionary consisting of:
logits : <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
<blockquote>
<div><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_classes)</span></code> representing
the logits of the classifier model.</p>
</div></blockquote>
<dl>
<dt>class_probabilities<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span></dt><dd><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_classes)</span></code> representing
the softmax probabilities of the classes.</p>
</dd>
<dt>loss<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, optional</span></dt><dd><p>A scalar loss to be optimised.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pipelines/index.html" class="btn btn-neutral float-right" title="pipelines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="biome.text.models.SequencePairClassifier.html" class="btn btn-neutral float-left" title="SequencePairClassifier" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, recognai

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>