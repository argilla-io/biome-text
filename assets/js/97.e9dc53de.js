(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{359:function(t,e,a){"use strict";a.r(e);var n=a(18),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"training-a-short-text-classifier-of-german-business-names"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#training-a-short-text-classifier-of-german-business-names"}},[t._v("#")]),t._v(" Training a short text classifier of German business names")]),t._v(" "),a("p",[t._v("In this tutorial we will train a basic short-text classifier for predicting the sector of a business based only on its business name. For this we will use a training dataset with business names and business categories in German.")]),t._v(" "),a("p",[t._v("The tutorial will guide you through the following steps:")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#explore-and-prepare-training-and-evaluation-data"}},[t._v("Explore and prepare training and evaluation data")])]),a("li",[a("a",{attrs:{href:"#configure-your-biome-text-pipeline"}},[t._v("Configure your biome.text Pipeline")]),a("ul",[a("li",[a("a",{attrs:{href:"#pipeline-configuration-from-yaml"}},[t._v("Pipeline configuration from YAML")])]),a("li",[a("a",{attrs:{href:"#testing-our-pipeline-before-training"}},[t._v("Testing our pipeline before training")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"explore-and-prepare-training-and-evaluation-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#explore-and-prepare-training-and-evaluation-data"}},[t._v("#")]),t._v(" Explore and prepare training and evaluation data")]),t._v(" "),a("p",[t._v("Let's take a look at the data we will use for training.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pandas "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pd\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("df "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_csv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data/business.cat.10k.csv'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",[a("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),a("table",{staticClass:"dataframe",attrs:{border:"1"}},[a("thead",[a("tr",{staticStyle:{"text-align":"right"}},[a("th"),t._v(" "),a("th",[t._v("Unnamed: 0")]),t._v(" "),a("th",[t._v("label")]),t._v(" "),a("th",[t._v("text")])])]),t._v(" "),a("tbody",[a("tr",[a("th",[t._v("0")]),t._v(" "),a("td",[t._v("44310")]),t._v(" "),a("td",[t._v("Tiefbau")]),t._v(" "),a("td",[t._v("Baugeschäft Haßmann Gmbh Wörblitz")])]),t._v(" "),a("tr",[a("th",[t._v("1")]),t._v(" "),a("td",[t._v("39433")]),t._v(" "),a("td",[t._v("Restaurants")]),t._v(" "),a("td",[t._v("Gaststätten, Restaurants - Sucos Do Brasil Coc...")])]),t._v(" "),a("tr",[a("th",[t._v("2")]),t._v(" "),a("td",[t._v("8828")]),t._v(" "),a("td",[t._v("Autowerkstätten")]),t._v(" "),a("td",[t._v("Lankes Kfz-werkstatt")])]),t._v(" "),a("tr",[a("th",[t._v("3")]),t._v(" "),a("td",[t._v("61668")]),t._v(" "),a("td",[t._v("Werbeagenturen")]),t._v(" "),a("td",[t._v("Feine Reklame Gesellschaft Für Strategische Kr...")])]),t._v(" "),a("tr",[a("th",[t._v("4")]),t._v(" "),a("td",[t._v("34837")]),t._v(" "),a("td",[t._v("Maler")]),t._v(" "),a("td",[t._v("Müller Vladimir & Co. Malermeister")])]),t._v(" "),a("tr",[a("th",[t._v("5")]),t._v(" "),a("td",[t._v("1478")]),t._v(" "),a("td",[t._v("Allgemeinärzte")]),t._v(" "),a("td",[t._v("Renninger Arztpraxis Für Allgemeinmedizin Dr.")])]),t._v(" "),a("tr",[a("th",[t._v("6")]),t._v(" "),a("td",[t._v("21584")]),t._v(" "),a("td",[t._v("Friseure")]),t._v(" "),a("td",[t._v("Coiffeur La Vie")])]),t._v(" "),a("tr",[a("th",[t._v("7")]),t._v(" "),a("td",[t._v("34259")]),t._v(" "),a("td",[t._v("Maler")]),t._v(" "),a("td",[t._v("Kiesewalter Malermeister Thomas")])]),t._v(" "),a("tr",[a("th",[t._v("8")]),t._v(" "),a("td",[t._v("10951")]),t._v(" "),a("td",[t._v("Dienstleistungen")]),t._v(" "),a("td",[t._v("Gerhard Pflaum Minden-herforder-verkehrs-servi...")])]),t._v(" "),a("tr",[a("th",[t._v("9")]),t._v(" "),a("td",[t._v("36476")]),t._v(" "),a("td",[t._v("Physiotherapie")]),t._v(" "),a("td",[t._v("Hellriegel - Thoms - Feliksßen Rückenzentrum K...")])])])])]),t._v(" "),a("p",[t._v("As we can see we have two relevant columns "),a("code",[t._v("label")]),t._v(" and "),a("code",[t._v("text")]),t._v(".")]),t._v(" "),a("p",[t._v("Our classifier will be trained to predict the "),a("code",[t._v("label")]),t._v(" given a "),a("code",[t._v("text")]),t._v(".")]),t._v(" "),a("p",[t._v("Let's check the distribution of our "),a("code",[t._v("label")]),t._v(" columns")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DataFrame"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("label"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value_counts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",[a("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),a("table",{staticClass:"dataframe",attrs:{border:"1"}},[a("thead",[a("tr",{staticStyle:{"text-align":"right"}},[a("th"),t._v(" "),a("th",[t._v("label")])])]),t._v(" "),a("tbody",[a("tr",[a("th",[t._v("Unternehmensberatungen")]),t._v(" "),a("td",[t._v("775")])]),t._v(" "),a("tr",[a("th",[t._v("Friseure")]),t._v(" "),a("td",[t._v("705")])]),t._v(" "),a("tr",[a("th",[t._v("Tiefbau")]),t._v(" "),a("td",[t._v("627")])]),t._v(" "),a("tr",[a("th",[t._v("Dienstleistungen")]),t._v(" "),a("td",[t._v("613")])]),t._v(" "),a("tr",[a("th",[t._v("Gebrauchtwagen")]),t._v(" "),a("td",[t._v("567")])]),t._v(" "),a("tr",[a("th",[t._v("Restaurants")]),t._v(" "),a("td",[t._v("526")])]),t._v(" "),a("tr",[a("th",[t._v("Architekturbüros")]),t._v(" "),a("td",[t._v("523")])]),t._v(" "),a("tr",[a("th",[t._v("Elektriker")]),t._v(" "),a("td",[t._v("513")])]),t._v(" "),a("tr",[a("th",[t._v("Vereine")]),t._v(" "),a("td",[t._v("488")])]),t._v(" "),a("tr",[a("th",[t._v("Versicherungsvermittler")]),t._v(" "),a("td",[t._v("462")])]),t._v(" "),a("tr",[a("th",[t._v("Sanitärinstallationen")]),t._v(" "),a("td",[t._v("416")])]),t._v(" "),a("tr",[a("th",[t._v("Edv")]),t._v(" "),a("td",[t._v("413")])]),t._v(" "),a("tr",[a("th",[t._v("Maler")]),t._v(" "),a("td",[t._v("413")])]),t._v(" "),a("tr",[a("th",[t._v("Physiotherapie")]),t._v(" "),a("td",[t._v("366")])]),t._v(" "),a("tr",[a("th",[t._v("Werbeagenturen")]),t._v(" "),a("td",[t._v("362")])]),t._v(" "),a("tr",[a("th",[t._v("Apotheken")]),t._v(" "),a("td",[t._v("346")])]),t._v(" "),a("tr",[a("th",[t._v("Vermittlungen")]),t._v(" "),a("td",[t._v("345")])]),t._v(" "),a("tr",[a("th",[t._v("Hotels")]),t._v(" "),a("td",[t._v("343")])]),t._v(" "),a("tr",[a("th",[t._v("Autowerkstätten")]),t._v(" "),a("td",[t._v("332")])]),t._v(" "),a("tr",[a("th",[t._v("Elektrotechnik")]),t._v(" "),a("td",[t._v("329")])]),t._v(" "),a("tr",[a("th",[t._v("Allgemeinärzte")]),t._v(" "),a("td",[t._v("274")])]),t._v(" "),a("tr",[a("th",[t._v("Handelsvermittler Und -vertreter")]),t._v(" "),a("td",[t._v("262")])])])])]),t._v(" "),a("h2",{attrs:{id:"configure-your-biome-text-pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-biome-text-pipeline"}},[t._v("#")]),t._v(" Configure your "),a("code",[t._v("biome.text")]),t._v(" Pipeline")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api_new "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Pipeline\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api_new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("configuration "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" TrainerConfiguration\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" biome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api_new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("helpers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" yaml_to_dict\n")])])]),a("h3",{attrs:{id:"pipeline-configuration-from-yaml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pipeline-configuration-from-yaml"}},[t._v("#")]),t._v(" Pipeline configuration from YAML")]),t._v(" "),a("p",[t._v("A "),a("code",[t._v("biome.text")]),t._v(" pipeline has the following main components:")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the name")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tokenizer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# how to tokenize input text")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("features")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# this input features of the model")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("encoder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the backbone model encoder")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# your task configuration")]),t._v("\n\n\n")])])]),a("p",[t._v("Our complete configuration for this tutorial is:")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" german"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("business"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("categories\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("features")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("words")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("embedding_dim")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("lowercase_tokens")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chars")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("embedding_dim")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("encoder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cnn\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("num_filters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ngram_filter_sizes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dropout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("encoder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hidden_size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("num_layers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dropout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" lstm\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TextClassification\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pooler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" boe\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Allgemeinärzte'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Apotheken'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Architekturbüros'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Autowerkstätten'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Dienstleistungen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Edv'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Elektriker'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Elektrotechnik'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Friseure'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Gebrauchtwagen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Handelsvermittler Und -vertreter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hotels'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Maler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Physiotherapie'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Restaurants'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sanitärinstallationen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Tiefbau'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Unternehmensberatungen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Vereine'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Vermittlungen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Versicherungsvermittler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Werbeagenturen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("pl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Pipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"configs/text_classifier.yml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("{'name': 'business-categories',\n 'tokenizer': {'lang': 'en',\n  'skip_empty_tokens': False,\n  'max_sequence_length': None,\n  'max_nr_of_sentences': None,\n  'text_cleaning': None,\n  'segment_sentences': False},\n 'features': {'words': {'embedding_dim': 100, 'lowercase_tokens': True},\n  'chars': {'embedding_dim': 8,\n   'encoder': {'type': 'cnn', 'num_filters': 50, 'ngram_filter_sizes': [4]},\n   'dropout': 0.2}},\n 'encoder': {'hidden_size': 512,\n  'num_layers': 2,\n  'dropout': 0.5,\n  'type': 'lstm',\n  'input_size': 150},\n 'head': {'type': 'TextClassification',\n  'pooler': {'type': 'boe'},\n  'labels': ['Allgemeinärzte',\n   'Apotheken',\n   'Architekturbüros',\n   'Autowerkstätten',\n   'Dienstleistungen',\n   'Edv',\n   'Elektriker',\n   'Elektrotechnik',\n   'Friseure',\n   'Gebrauchtwagen',\n   'Handelsvermittler Und -vertreter',\n   'Hotels',\n   'Maler',\n   'Physiotherapie',\n   'Restaurants',\n   'Sanitärinstallationen',\n   'Tiefbau',\n   'Unternehmensberatungen',\n   'Vereine',\n   'Vermittlungen',\n   'Versicherungsvermittler',\n   'Werbeagenturen']}}\n")])])]),a("h3",{attrs:{id:"testing-our-pipeline-before-training"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing-our-pipeline-before-training"}},[t._v("#")]),t._v(" Testing our pipeline before training")]),t._v(" "),a("p",[t._v("It recommended to check that our pipeline is correctly setup using the "),a("code",[t._v("predict")]),t._v(" method.")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Our pipeline has not been trained before, so its weights are random. Do not expect its predictions to make sense for now.")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("pl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("predict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Some text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("{'logits': array([-0.0333772 , -0.01114595,  0.08185824,  0.00720856, -0.01808064,\n         0.0209163 , -0.04119281,  0.0234425 ,  0.00120479,  0.04529068,\n        -0.02560528,  0.03243363, -0.02825472,  0.01238234,  0.00707909,\n        -0.05999601,  0.05878261,  0.03128546, -0.01267068,  0.00673078,\n         0.01568662,  0.02453783], dtype=float32),\n 'probs': array([0.04366268, 0.04464422, 0.04899553, 0.04547121, 0.0443357 ,\n        0.04609881, 0.04332276, 0.04621541, 0.04519903, 0.04723625,\n        0.04400334, 0.04663282, 0.04388691, 0.04570708, 0.04546533,\n        0.04251576, 0.04787787, 0.04657931, 0.04457621, 0.04544949,\n        0.04585836, 0.04626606], dtype=float32),\n 'classes': {'Architekturbüros': 0.04899553209543228,\n  'Tiefbau': 0.047877874225378036,\n  'Gebrauchtwagen': 0.04723624885082245,\n  'Hotels': 0.04663281515240669,\n  'Unternehmensberatungen': 0.046579305082559586,\n  'Werbeagenturen': 0.046266064047813416,\n  'Elektrotechnik': 0.04621541127562523,\n  'Edv': 0.04609880968928337,\n  'Versicherungsvermittler': 0.04585836082696915,\n  'Physiotherapie': 0.04570708051323891,\n  'Autowerkstätten': 0.04547121003270149,\n  'Restaurants': 0.04546532779932022,\n  'Vermittlungen': 0.04544949159026146,\n  'Friseure': 0.04519902914762497,\n  'Apotheken': 0.04464422166347504,\n  'Vereine': 0.04457620531320572,\n  'Dienstleistungen': 0.04433570057153702,\n  'Handelsvermittler Und -vertreter': 0.04400334134697914,\n  'Maler': 0.04388691112399101,\n  'Allgemeinärzte': 0.04366267845034599,\n  'Elektriker': 0.04332275688648224,\n  'Sanitärinstallationen': 0.04251576215028763},\n 'max_class': 'Architekturbüros',\n 'max_class_prob': 0.04899553209543228,\n 'label': 'Architekturbüros',\n 'prob': 0.04899553209543228}\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("yaml_to_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"configs/trainer.yml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("{'batch_size': 64,\n 'num_epochs': 100,\n 'optimizer': {'type': 'adam', 'lr': 0.01},\n 'validation_metric': '-loss',\n 'patience': 2}\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("trainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TrainerConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("yaml_to_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"configs/trainer.yml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("\n")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);