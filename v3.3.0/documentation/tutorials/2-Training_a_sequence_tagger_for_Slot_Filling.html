<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Training a sequence tagger for Slot Filling | biome.text</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" href="/biome-text/v3.3.0/favicon.ico">
    <meta name="description" content="biome.text practical NLP open source library.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:image" content="https://www.recogn.ai/images/biome_og.png">
    
    <link rel="preload" href="/biome-text/v3.3.0/assets/css/0.styles.4f15032c.css" as="style"><link rel="preload" href="/biome-text/v3.3.0/assets/js/app.c4900251.js" as="script"><link rel="preload" href="/biome-text/v3.3.0/assets/js/4.37405f59.js" as="script"><link rel="preload" href="/biome-text/v3.3.0/assets/js/3.8415d3f4.js" as="script"><link rel="preload" href="/biome-text/v3.3.0/assets/js/59.f168e45d.js" as="script"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/10.ce2c43b7.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/11.a47b3e70.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/12.eb9ca10f.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/13.c6b3ae1a.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/14.eea510c5.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/15.5f6177de.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/16.03b15158.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/17.f30bbbfd.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/18.31e437d5.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/19.4b33f0c3.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/20.ecf7e7b5.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/21.cb935e67.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/22.3c777f0d.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/23.f651acfe.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/24.12af41ba.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/25.df61b851.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/26.dd81ef35.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/27.81772a70.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/28.4e5f2b2e.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/29.86fc6e0a.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/30.29cd49f1.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/31.bc44fa2d.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/32.cec05be3.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/33.53250c44.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/34.3975c08b.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/35.1de4022a.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/36.3c4d2ef8.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/37.58f65de9.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/38.9d48721c.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/39.5046ca65.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/40.71f0bd1f.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/41.1b7824f1.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/42.483fd924.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/43.049b2250.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/44.448ea611.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/45.39cc4484.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/46.f246e88b.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/47.75d886e9.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/48.cf3f5863.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/49.9443133d.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/5.ba936525.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/50.ae91171e.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/51.734fe440.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/52.5fbda0b6.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/53.2cca5f61.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/54.c410b6a2.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/55.2f139171.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/56.73af4d3b.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/57.c83641f1.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/58.e9bb45cc.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/6.a77aaf15.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/60.b7675110.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/61.c9a67d55.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/62.3885c606.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/63.c8ad49be.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/7.d07a7b2f.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/8.d8ec50bc.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/9.89ed85b5.js"><link rel="prefetch" href="/biome-text/v3.3.0/assets/js/vendors~docsearch.ceb48f17.js">
    <link rel="stylesheet" href="/biome-text/v3.3.0/assets/css/0.styles.4f15032c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-348088ed><header class="navbar" data-v-348088ed><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/biome-text/v3.3.0/" class="home-link router-link-active"><!----> <span class="site-name">biome<span>.text</span></span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/biome-text/v3.3.0/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/biome-text/v3.3.0/documentation/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="https://github.com/recognai/biome-text" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div><div class="nav-item"><a href="https://recogn.ai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Recognai
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-348088ed></div> <aside class="sidebar" data-v-348088ed><div class="sidebar__link"><a href="/biome-text/v3.3.0/"><img src="/biome-text/v3.3.0/assets/img/biome.svg" class="sidebar__img"></a></div> <!----> <nav class="nav-links"><div class="nav-item"><a href="/biome-text/v3.3.0/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/biome-text/v3.3.0/documentation/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="https://github.com/recognai/biome-text" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div><div class="nav-item"><a href="https://recogn.ai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Recognai
  <span class="external__icon"><vp-icon color="#4A4A4A" name="blank" size="12px"></vp-icon></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Get started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/v3.3.0/documentation/" aria-current="page" class="sidebar-link">Installation</a></li><li><a href="/biome-text/v3.3.0/documentation/basics.html" class="sidebar-link">The basics</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/v3.3.0/documentation/tutorials/1-Training_a_text_classifier.html" class="sidebar-link">Training a short text classifier of German business names</a></li><li><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html" aria-current="page" class="active sidebar-link">Training a sequence tagger for Slot Filling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html#explore-the-data" class="sidebar-link">Explore the data</a></li><li class="sidebar-sub-header"><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html#configure-your-biome-text-pipeline" class="sidebar-link">Configure your biome.text Pipeline</a></li><li class="sidebar-sub-header"><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html#configure-the-vocabulary" class="sidebar-link">Configure the vocabulary</a></li><li class="sidebar-sub-header"><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html#train-your-model" class="sidebar-link">Train your model</a></li><li class="sidebar-sub-header"><a href="/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html#make-your-first-predictions" class="sidebar-link">Make your first predictions</a></li></ul></li><li><a href="/biome-text/v3.3.0/documentation/tutorials/3-Hyperparameter_optimization_with_Ray_Tune.html" class="sidebar-link">Hyperparameter optimization with Ray Tune</a></li><li><a href="/biome-text/v3.3.0/documentation/tutorials/4-Using_Transformers_in_biome_text.html" class="sidebar-link">Using Transformers in biome.text</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>User Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/v3.3.0/documentation/user-guides/1-nlp-tasks.html" class="sidebar-link">NLP Tasks</a></li><li><a href="/biome-text/v3.3.0/documentation/user-guides/2-configuration.html" class="sidebar-link">Configurations</a></li><li><a href="/biome-text/v3.3.0/documentation/user-guides/3-deployment.html" class="sidebar-link">Deployment</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Community</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/biome-text/v3.3.0/documentation/community/1-contributing.html" class="sidebar-link">Contributing</a></li><li><a href="/biome-text/v3.3.0/documentation/community/2-get_help.html" class="sidebar-link">Getting help</a></li><li><a href="/biome-text/v3.3.0/documentation/community/3-developer_guides.html" class="sidebar-link">Developer guides</a></li></ul></section></li></ul> </aside> <main class="page" data-v-348088ed> <div class="theme-default-content content__default"><h1 id="training-a-sequence-tagger-for-slot-filling"><a href="#training-a-sequence-tagger-for-slot-filling" class="header-anchor">#</a> Training a sequence tagger for Slot Filling</h1> <p><a target="_blank" href="https://recognai.github.io/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html"><img src="https://recognai.github.io/biome-text/v3.3.0/assets/img/biome-isotype.svg" width="24" class="icon"></a> <a href="https://recognai.github.io/biome-text/v3.3.0/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.html" target="_blank" rel="noopener noreferrer">View on recogn.ai<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a target="_blank" href="https://colab.research.google.com/github/recognai/biome-text/blob/v3.3.0/docs/docs/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.ipynb"><img src="https://www.tensorflow.org/images/colab_logo_32px.png" width="24" class="icon"></a> <a href="https://colab.research.google.com/github/recognai/biome-text/blob/v3.3.0/docs/docs/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.ipynb" target="_blank" rel="noopener noreferrer">Run in Google Colab<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a target="_blank" href="https://github.com/recognai/biome-text/blob/v3.3.0/docs/docs/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.ipynb"><img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" width="24" class="icon"></a> <a href="https://github.com/recognai/biome-text/blob/v3.3.0/docs/docs/documentation/tutorials/2-Training_a_sequence_tagger_for_Slot_Filling.ipynb" target="_blank" rel="noopener noreferrer">View source on GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>When running this tutorial in Google Colab, make sure to install <em>biome.text</em> first:</p> <div class="language-python extra-class"><pre class="language-python"><code>!pip install <span class="token operator">-</span>U pip
!pip install <span class="token operator">-</span>U biome<span class="token operator">-</span>text
exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># Force restart of the runtime</span>
</code></pre></div><p><em>If</em> you want to log your runs with <a href="https://wandb.ai/home" target="_blank" rel="noopener noreferrer">WandB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, don't forget to install its client and log in.</p> <div class="language-python extra-class"><pre class="language-python"><code>!pip install wandb
!wandb login
</code></pre></div><h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>In this tutorial we will train a sequence tagger for filling slots in spoken requests.
The goal is to look for specific pieces of information in the request and tag the corresponding tokens accordingly.
The requests will include several intents, from getting weather information to adding a song to a playlist, each requiring its own set of slots.
Therefore, slot filling often goes hand in hand with intent classification.
In this tutorial, however, we will only focus on the slot filling task.</p> <p>Slot filling is closely related to <a href="https://en.wikipedia.org/wiki/Named-entity_recognition" target="_blank" rel="noopener noreferrer">Named-entity recognition (NER)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and the model of this tutorial can also be used to train a NER system.</p> <p>In this tutorial we will use the <a href="https://github.com/snipsco/nlu-benchmark/tree/master/2017-06-custom-intent-engines" target="_blank" rel="noopener noreferrer">SNIPS data set<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> adapted by <a href="https://github.com/sz128/slot_filling_and_intent_detection_of_SLU/tree/master/data/snips" target="_blank" rel="noopener noreferrer">Su Zhu<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and our simple <a href="https://biome-tutorials-data.s3-eu-west-1.amazonaws.com/token_classifier/data_prep.ipynb" target="_blank" rel="noopener noreferrer">data preparation notebook<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="imports"><a href="#imports" class="header-anchor">#</a> Imports</h3> <p>Let us first import all the stuff we need for this tutorial.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> biome<span class="token punctuation">.</span>text <span class="token keyword">import</span> Pipeline<span class="token punctuation">,</span> Dataset<span class="token punctuation">,</span> PipelineConfiguration<span class="token punctuation">,</span> VocabularyConfiguration<span class="token punctuation">,</span> Trainer
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>configuration <span class="token keyword">import</span> FeaturesConfiguration<span class="token punctuation">,</span> WordFeatures<span class="token punctuation">,</span> CharFeatures
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>configuration <span class="token keyword">import</span> Seq2SeqEncoderConfiguration
<span class="token keyword">from</span> biome<span class="token punctuation">.</span>text<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>heads <span class="token keyword">import</span> TokenClassificationConfiguration
</code></pre></div><h2 id="explore-the-data"><a href="#explore-the-data" class="header-anchor">#</a> Explore the data</h2> <p>Let's take a look at the data before starting with the configuration of our pipeline.
For this we create a <code>Dataset</code> instance providing a path to our downloaded data.</p> <div class="language-python extra-class"><pre class="language-python"><code>!curl <span class="token operator">-</span>O https<span class="token punctuation">:</span><span class="token operator">//</span>biome<span class="token operator">-</span>tutorials<span class="token operator">-</span>data<span class="token punctuation">.</span>s3<span class="token operator">-</span>eu<span class="token operator">-</span>west<span class="token operator">-</span><span class="token number">1.</span>amazonaws<span class="token punctuation">.</span>com<span class="token operator">/</span>token_classifier<span class="token operator">/</span>train<span class="token punctuation">.</span>json
!curl <span class="token operator">-</span>O https<span class="token punctuation">:</span><span class="token operator">//</span>biome<span class="token operator">-</span>tutorials<span class="token operator">-</span>data<span class="token punctuation">.</span>s3<span class="token operator">-</span>eu<span class="token operator">-</span>west<span class="token operator">-</span><span class="token number">1.</span>amazonaws<span class="token punctuation">.</span>com<span class="token operator">/</span>token_classifier<span class="token operator">/</span>valid<span class="token punctuation">.</span>json
!curl <span class="token operator">-</span>O https<span class="token punctuation">:</span><span class="token operator">//</span>biome<span class="token operator">-</span>tutorials<span class="token operator">-</span>data<span class="token punctuation">.</span>s3<span class="token operator">-</span>eu<span class="token operator">-</span>west<span class="token operator">-</span><span class="token number">1.</span>amazonaws<span class="token punctuation">.</span>com<span class="token operator">/</span>token_classifier<span class="token operator">/</span>test<span class="token punctuation">.</span>json
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>train_ds <span class="token operator">=</span> Dataset<span class="token punctuation">.</span>from_json<span class="token punctuation">(</span><span class="token string">&quot;train.json&quot;</span><span class="token punctuation">)</span>
valid_ds <span class="token operator">=</span> Dataset<span class="token punctuation">.</span>from_json<span class="token punctuation">(</span><span class="token string">&quot;valid.json&quot;</span><span class="token punctuation">)</span>
test_ds <span class="token operator">=</span> Dataset<span class="token punctuation">.</span>from_json<span class="token punctuation">(</span><span class="token string">&quot;test.json&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>The <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/dataset.html#dataset" target="_blank" rel="noopener noreferrer">Dataset<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> class is a very thin wrapper around HuggingFace's awesome <a href="https://huggingface.co/docs/datasets/master/package_reference/main_classes.html#datasets.Dataset" target="_blank" rel="noopener noreferrer">datasets.Dataset<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
Most of HuggingFace's <code>Dataset</code> API is exposed and you can checkout their nice <a href="https://huggingface.co/docs/datasets/master/processing.html" target="_blank" rel="noopener noreferrer">documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on how to work with data in a <code>Dataset</code>. For example, let's quickly check the size of our training data and print the first 10 examples as a pandas DataFrame:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Training data size:&quot;</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_ds<span class="token punctuation">)</span><span class="token punctuation">)</span>

train_ds<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>As we can see we have two relevant columns for our task: <em>text</em> and <em>labels</em>.
The <em>intent</em> column will be ignored in this tutorial.</p> <p>The text input already comes pre-tokenized as a list of strings and each token in the <em>text</em> column has a label/tag in the <em>labels</em> column, this means that both list always have the same length.
The labels are given in the <a href="https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging)" target="_blank" rel="noopener noreferrer">BIO tagging scheme<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which is widely used in Slot Filling/NER systems.</p> <p>We can quickly check how many different labels there are in our dataset:</p> <div class="language-python extra-class"><pre class="language-python"><code>labels <span class="token operator">=</span> <span class="token punctuation">{</span>tag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> tags <span class="token keyword">in</span> train_ds<span class="token punctuation">[</span><span class="token string">&quot;labels&quot;</span><span class="token punctuation">]</span> <span class="token keyword">for</span> tag <span class="token keyword">in</span> tags <span class="token keyword">if</span> tag <span class="token operator">!=</span> <span class="token string">&quot;O&quot;</span><span class="token punctuation">}</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;number of lables:&quot;</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span>
labels
</code></pre></div><p>Since the the <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/modules/heads/task_head.html#taskhead" target="_blank" rel="noopener noreferrer">TaskHead<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of our model (the <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/modules/heads/token_classification.html#tokenclassification" target="_blank" rel="noopener noreferrer">TokenClassification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> head) expects a <em>text</em> and a <em>tags</em> column to be present in the Dataset, we need to rename the <em>labels</em> column:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> ds <span class="token keyword">in</span> <span class="token punctuation">[</span>train_ds<span class="token punctuation">,</span> valid_ds<span class="token punctuation">,</span> test_ds<span class="token punctuation">]</span><span class="token punctuation">:</span>
     ds<span class="token punctuation">.</span>rename_column_<span class="token punctuation">(</span><span class="token string">&quot;labels&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tags&quot;</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>The <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/modules/heads/token_classification.html#tokenclassification" target="_blank" rel="noopener noreferrer">TokenClassification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> head also supports a <em>entities</em> column instead of a <em>tags</em> column, in which case the entities have to be a list of python dictionaries with a <code>start</code>, <code>end</code> and <code>label</code> key that correspond to the char indexes and the label of the entity, respectively.</p></div> <h2 id="configure-your-biome-text-pipeline"><a href="#configure-your-biome-text-pipeline" class="header-anchor">#</a> Configure your <em>biome.text</em> Pipeline</h2> <p>A typical <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/pipeline.html#pipeline" target="_blank" rel="noopener noreferrer">Pipeline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> consists of tokenizing the input, extracting features, applying a language encoding (optionally) and executing a task-specific head in the end.
After training a pipeline, you can use it to make predictions</p> <p>A <em>biome.text</em> pipeline has the following main components:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token comment"># a descriptive name of your pipeline</span>

<span class="token key atrule">tokenizer</span><span class="token punctuation">:</span> <span class="token comment"># how to tokenize the input</span>

<span class="token key atrule">features</span><span class="token punctuation">:</span> <span class="token comment"># input features of the model</span>

<span class="token key atrule">encoder</span><span class="token punctuation">:</span> <span class="token comment"># the language encoder</span>

<span class="token key atrule">head</span><span class="token punctuation">:</span> <span class="token comment"># your task configuration</span>

</code></pre></div><p>See the <a href="https://recognai.github.io/biome-text/v3.3.0/documentation/user-guides/2-configuration.html" target="_blank" rel="noopener noreferrer">Configuration section<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for a detailed description of how these main components can be configured.</p> <p>In this tutorial we will create a <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/configuration.html#pipelineconfiguration" target="_blank" rel="noopener noreferrer">PipelineConfiguration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> programmatically, and use it to initialize the <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/pipeline.html#pipeline" target="_blank" rel="noopener noreferrer">Pipeline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
You can also create your pipelines by providing a <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/pipeline.html#from-config" target="_blank" rel="noopener noreferrer">python dictionary<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (see the text classification <a href="https://recognai.github.io/biome-text/v3.3.0/documentation/tutorials/1-Training_a_text_classifier.html" target="_blank" rel="noopener noreferrer">tutorial<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), a YAML <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/pipeline.html#from-yaml" target="_blank" rel="noopener noreferrer">configuration file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or a <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/pipeline.html#from-pretrained" target="_blank" rel="noopener noreferrer">pretrained model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>A pipeline configuration is composed of several other <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/configuration.html#biome-text-configuration" target="_blank" rel="noopener noreferrer">configuration classes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, each one corresponding to one of the main components.</p> <h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <p>Let us first configure the features of our pipeline.
For our <code>word</code> feature we will use pretrained embeddings from <a href="https://fasttext.cc/docs/en/english-vectors.html" target="_blank" rel="noopener noreferrer">fasttext<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and our <code>char</code> feature will use the last hidden state of a <a href="https://en.wikipedia.org/wiki/Gated_recurrent_unit" target="_blank" rel="noopener noreferrer">GRU<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> encoder to represent a word based on its characters.
Keep in mind that the <code>embedding_dim</code> parameter for the <code>word</code> feature must be equal to the dimensions of the pretrained embeddings!</p> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>If you do not provide any feature configurations, we will choose a very basic <code>word</code> feature by default.</p></div> <div class="language-python extra-class"><pre class="language-python"><code>word_feature <span class="token operator">=</span> WordFeatures<span class="token punctuation">(</span>
    embedding_dim<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>
    weights_file<span class="token operator">=</span><span class="token string">&quot;https://dl.fbaipublicfiles.com/fasttext/vectors-english/wiki-news-300d-1M.vec.zip&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

char_feature <span class="token operator">=</span> CharFeatures<span class="token punctuation">(</span>
    embedding_dim<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>
    encoder<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;gru&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;bidirectional&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
        <span class="token string">&quot;num_layers&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;hidden_size&quot;</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    dropout<span class="token operator">=</span><span class="token number">0.1</span>
<span class="token punctuation">)</span>

features_config <span class="token operator">=</span> FeaturesConfiguration<span class="token punctuation">(</span>
    word<span class="token operator">=</span>word_feature<span class="token punctuation">,</span> 
    char<span class="token operator">=</span>char_feature
<span class="token punctuation">)</span>
</code></pre></div><h3 id="encoder"><a href="#encoder" class="header-anchor">#</a> Encoder</h3> <p>Next we will configure our encoder that takes as input a sequence of embedded word vectors and returns a sequence of encoded word vectors.
For this encoding we will use another larger GRU:</p> <div class="language-python extra-class"><pre class="language-python"><code>encoder_config <span class="token operator">=</span> Seq2SeqEncoderConfiguration<span class="token punctuation">(</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;gru&quot;</span><span class="token punctuation">,</span>
    bidirectional<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    num_layers<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    hidden_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="head"><a href="#head" class="header-anchor">#</a> Head</h3> <p>The final configuration belongs to our <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/modules/heads/task_head.html#taskhead" target="_blank" rel="noopener noreferrer">TaskHead<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
It reflects the task our problem belongs to and can be easily exchanged with other types of heads keeping the same features and encoder.</p> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>Exchanging the heads you can easily pretrain a model on a certain task, such as <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/modules/heads/language_modelling.html#languagemodelling" target="_blank" rel="noopener noreferrer">language modelling<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and use its pretrained features and encoder for training the model on another task.</p></div> <p>For our task we will use a <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/modules/heads/token_classification.html#tokenclassification" target="_blank" rel="noopener noreferrer">TokenClassification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> head that allows us to tag each token individually:</p> <div class="language-python extra-class"><pre class="language-python"><code>head_config <span class="token operator">=</span> TokenClassificationConfiguration<span class="token punctuation">(</span>
    labels<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">,</span>
    label_encoding<span class="token operator">=</span><span class="token string">&quot;BIO&quot;</span><span class="token punctuation">,</span>
    top_k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    feedforward<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">&quot;num_layers&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;hidden_dims&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;activations&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;relu&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;dropout&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="pipeline"><a href="#pipeline" class="header-anchor">#</a> Pipeline</h3> <p>Now we can create a <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/configuration.html#pipelineconfiguration" target="_blank" rel="noopener noreferrer">PipelineConfiguration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and finally initialize our <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/pipeline.html#pipeline" target="_blank" rel="noopener noreferrer">Pipeline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-python extra-class"><pre class="language-python"><code>pipeline_config <span class="token operator">=</span> PipelineConfiguration<span class="token punctuation">(</span>
    name<span class="token operator">=</span><span class="token string">&quot;slot_filling_tutorial&quot;</span><span class="token punctuation">,</span>
    features<span class="token operator">=</span>features_config<span class="token punctuation">,</span>
    encoder<span class="token operator">=</span>encoder_config<span class="token punctuation">,</span>
    head<span class="token operator">=</span>head_config<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>pl <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_config<span class="token punctuation">(</span>pipeline_config<span class="token punctuation">)</span>
</code></pre></div><h2 id="configure-the-vocabulary"><a href="#configure-the-vocabulary" class="header-anchor">#</a> Configure the vocabulary</h2> <p>The default behavior of <em>biome.text</em> is to add all tokens from the training data set to the pipeline's vocabulary.
This is done automatically when training the pipeline for the first time.</p> <p>For this tutorial we get rid of the rarest words by adding the <code>min_count</code> argument and set it to 2 for the word feature vocabulary.
Since we use pretrained word embeddings we will not only consider the training data, but also the validation data when creating the vocabulary by setting <code>include_valid_data=True</code>.
For a complete list of available arguments see the <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/configuration.html#vocabularyconfiguration" target="_blank" rel="noopener noreferrer">VocabularyConfiguration API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-python extra-class"><pre class="language-python"><code>vocab_config <span class="token operator">=</span> VocabularyConfiguration<span class="token punctuation">(</span>min_count<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;word&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> include_valid_data<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="train-your-model"><a href="#train-your-model" class="header-anchor">#</a> Train your model</h2> <p>Now we have everything ready to start the training of our model:</p> <ul><li>training data set</li> <li>pipeline</li></ul> <p>We will use the default configuration for our <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/trainer.html" target="_blank" rel="noopener noreferrer"><code>Trainer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that has sensible values and works alright for our experiment.
<a href="https://recognai.github.io/biome-text/v3.3.0/documentation/tutorials/1-Training_a_text_classifier.html" target="_blank" rel="noopener noreferrer">This tutorial<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> provides more information about the <code>Trainer</code> and gives you an example how to configure it.</p> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>If you want to configure the trainer you can pass on a <code>TrainerConfiguration</code> instance to the <code>Trainer</code>s init.
See the <a href="https://recognai.github.io/biome-text/v3.3.0/api/biome/text/configuration.html#trainerconfiguration" target="_blank" rel="noopener noreferrer">TrainerConfiguration API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for a complete list of available configurations.</p></div> <div class="language-python extra-class"><pre class="language-python"><code>trainer <span class="token operator">=</span> Trainer<span class="token punctuation">(</span>
    pipeline<span class="token operator">=</span>pl<span class="token punctuation">,</span>
    train_dataset<span class="token operator">=</span>train_ds<span class="token punctuation">,</span>
    valid_dataset<span class="token operator">=</span>valid_ds<span class="token punctuation">,</span>
    vocab_config<span class="token operator">=</span>vocab_config<span class="token punctuation">,</span>
    trainer_config<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><p>To start the training we simply call the <code>Trainer.fit()</code> method.</p> <div class="language-python extra-class"><pre class="language-python"><code>trainer<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Apart from estimating the generalization error with a validation data set, you might want to evaluate your model against a test data set to compare several models after optimizing their hyperparameters.
For this you can use the <code>Pipeline.evaluate()</code> method.</p> <div class="language-python extra-class"><pre class="language-python"><code>pl<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_ds<span class="token punctuation">)</span>
</code></pre></div><p>The model above achieves an overall F1 score of around <strong>0.95</strong>, which is not bad when compared to <a href="https://nlpprogress.com/english/intent_detection_slot_filling.html" target="_blank" rel="noopener noreferrer">published results<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of the same data set.
You could continue the experiment changing the encoder to an LSTM network, try out a transformer architecture or fine tune the trainer.
But for now we will go on and make our first predictions with this trained model.</p> <h2 id="make-your-first-predictions"><a href="#make-your-first-predictions" class="header-anchor">#</a> Make your first predictions</h2> <p>Now that we trained our model we can go on to make our first predictions.</p> <p>We provide the input expected by our <code>TaskHead</code> to the <code>Pipeline.predict()</code> method.
In our case it is a <code>TokenClassification</code> head that classifies a <code>text</code> input.</p> <p>You can either provide pretokenized tokens (list of strings) <strong>or</strong> a raw string to the <code>predict</code> method. In the first case, you should make sure that those tokens were tokenized the same way the training data was tokenized, in the latter case you should make sure that the pipeline uses the same tokenizer as was used for the training data.</p> <p>The prediction of the <code>TokenClassification</code> head will always consist of a <code>tags</code> and <code>entities</code> key. Both keys will include the <code>top_k</code> most likely tag/entity sequences for the input, where <code>top_k</code> is a parameter specified in the <code>TokenClassificationConfiguration</code> before the training.</p> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>We can also load the trained pipeline from the training output. This is useful in case you trained the pipeline in some earlier session, and want to continue your work with the inference steps:</p> <div class="language-python extra-class"><pre class="language-python"><code>pl <span class="token operator">=</span> Pipeline<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span><span class="token string">&quot;output/model.tar.gz&quot;</span><span class="token punctuation">)</span>`
</code></pre></div></div> <h3 id="pretokenized-input"><a href="#pretokenized-input" class="header-anchor">#</a> pretokenized input</h3> <p>For pretokenized input, the <code>entities</code> key of the output holds dictionaries with the <code>start_token</code> id, <code>end_token</code> id and the label of the entity:</p> <div class="language-python extra-class"><pre class="language-python"><code>text <span class="token operator">=</span> <span class="token string">&quot;Can you play biome text by backstreet recognais on Spotify ?&quot;</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
prediction <span class="token operator">=</span> pl<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>text<span class="token operator">=</span>text<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Predicted tags:\n&quot;</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> prediction<span class="token punctuation">[</span><span class="token string">&quot;tags&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Predicted entities:\n&quot;</span><span class="token punctuation">,</span> prediction<span class="token punctuation">[</span><span class="token string">&quot;entities&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="string-input"><a href="#string-input" class="header-anchor">#</a> string input</h3> <p>For a raw string input, the <code>entities</code> key of the output holds dictionaries with the <code>start_token</code> id, <code>end_token</code> id, <code>start</code> char id, <code>end</code> char id and the label of the entity:</p> <div class="language-python extra-class"><pre class="language-python"><code>text <span class="token operator">=</span> <span class="token string">&quot;Can you play biome text by backstreet recognais on Spotify ?&quot;</span>
prediction <span class="token operator">=</span> pl<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>text<span class="token operator">=</span>text<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Predicted tags:\n&quot;</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prediction<span class="token punctuation">[</span><span class="token string">&quot;tags&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Predicted entities:\n&quot;</span><span class="token punctuation">,</span> prediction<span class="token punctuation">[</span><span class="token string">&quot;entities&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="page-nav__button prev"><a href="/biome-text/v3.3.0/documentation/tutorials/1-Training_a_text_classifier.html" class="prev"><span class="page-nav__button__icon"><vp-icon color="#4A4A4A" name="chev-left" size="18px"></vp-icon></span> <span class="page-nav__button__text">
          Training a short text classifier of German business names
        </span></a></span> <span class="page-nav__button next"><a href="/biome-text/v3.3.0/documentation/tutorials/3-Hyperparameter_optimization_with_Ray_Tune.html"><span class="page-nav__button__text">
          Hyperparameter optimization with Ray Tune
        </span> <span class="page-nav__button__icon"><vp-icon color="#4A4A4A" name="chev-right" size="18px"></vp-icon></span></a></span></p></div> <footer class="footer" data-v-348088ed><div data-v-348088ed>
          Maintained by
          <a href="https://www.recogn.ai/" target="_blank" data-v-348088ed><img width="70px" src="/biome-text/v3.3.0/assets/img/recognai.png" class="footer__img" data-v-348088ed></a></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/biome-text/v3.3.0/assets/js/app.c4900251.js" defer></script><script src="/biome-text/v3.3.0/assets/js/4.37405f59.js" defer></script><script src="/biome-text/v3.3.0/assets/js/3.8415d3f4.js" defer></script><script src="/biome-text/v3.3.0/assets/js/59.f168e45d.js" defer></script>
  </body>
</html>
